<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ€ç»´ååŒå¤„ç†å™¨ - æ™ºèƒ½è§£æå¢å¼ºç‰ˆ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- æ·»åŠ åœ¨v16.htmlçš„headéƒ¨åˆ†ï¼Œå¤§çº¦åœ¨ç¬¬10-20è¡Œä¹‹é—´ -->
    <script src="data-manager.js"></script>
    <!-- ç§»åŠ¨ç«¯æ£€æµ‹å’Œé‡å®šå‘ -->
    <script>
        // ç§»åŠ¨ç«¯æ£€æµ‹å’Œé‡å®šå‘
        (function() {
            const isMobile = /iPhone|iPad|iPod|Android|webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const screenWidth = window.innerWidth;
            
            // å¦‚æœæ˜¯ç§»åŠ¨è®¾å¤‡ä¸”å±å¹•å®½åº¦å°äº768pxï¼Œé‡å®šå‘åˆ°ç§»åŠ¨ç«¯
            if ((isMobile || screenWidth < 768) && 
                !window.location.href.includes('mobile') && 
                !window.location.href.includes('v16.html?force=desktop')) {
                
                // è¯¢é—®ç”¨æˆ·æ˜¯å¦åˆ‡æ¢åˆ°ç§»åŠ¨ç«¯
                if (confirm('æ£€æµ‹åˆ°æ‚¨åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šè®¿é—®ï¼Œæ˜¯å¦åˆ‡æ¢åˆ°ç§»åŠ¨ç«¯ä¼˜åŒ–ç•Œé¢ï¼Ÿ\n\né€‰æ‹©"å–æ¶ˆ"ç»§ç»­ä½¿ç”¨ç”µè„‘ç«¯ç•Œé¢ã€‚')) {
                    window.location.href = 'v16-mobile.html';
                }
            }
        })();
    </script>
    <style>
        :root {
            --primary-color: #1a237e;
            --secondary-color: #283593;
            --accent-color: #5c6bc0;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --danger-color: #f44336;
            --light-bg: #f8f9fa;
            --dark-bg: #1a237e;
            --border-color: #e1e5eb;
            --text-color: #333;
            --text-light: #666;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f9fc;
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }
        
        /* é¡¶éƒ¨çŠ¶æ€æ  */
        .top-bar {
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
            flex-shrink: 0;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo-icon {
            font-size: 24px;
        }
        
        .logo-text {
            font-size: 20px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .system-info {
            font-size: 14px;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .current-view {
            font-weight: 500;
            background: rgba(255, 255, 255, 0.15);
            padding: 5px 15px;
            border-radius: 20px;
        }
        
        /* ä¸»å†…å®¹åŒº */
        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        /* å·¦ä¾§å¯¼èˆªæ  */
        .sidebar {
            width: 280px;
            background-color: #fff;
            border-right: 1px solid #e1e5eb;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.03);
            flex-shrink: 0;
        }
        
        .nav-section {
            padding: 20px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .nav-section h3 {
            color: var(--primary-color);
            font-size: 16px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .nav-section h3 i {
            font-size: 14px;
        }
        
        .nav-links {
            list-style: none;
        }
        
        .nav-links li {
            margin-bottom: 10px;
        }
        
        .nav-links a {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            color: #555;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s;
            font-size: 14.5px;
            cursor: pointer;
        }
        
        .nav-links a:hover {
            background-color: #f0f4f9;
            color: var(--primary-color);
        }
        
        .nav-links a.active {
            background-color: #e8edff;
            color: var(--primary-color);
            font-weight: 500;
        }
        
        .nav-links a i {
            margin-right: 10px;
            width: 18px;
            text-align: center;
        }
        
        /* ç‰ˆæœ¬é€‰æ‹©å™¨ */
        .version-selector {
            padding: 15px 20px;
            background-color: #f9fbfd;
            border-top: 1px solid #e1e5eb;
        }
        
        .version-selector select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d9e6;
            border-radius: 4px;
            background-color: white;
            font-size: 14px;
            color: #333;
        }
        
        /* ä¸­é—´ä¸»å†…å®¹åŒº */
        .content-area {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            background-color: #fff;
        }
        
        .content-header {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eaeef5;
        }
        
        .content-header h2 {
            color: var(--primary-color);
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .content-header p {
            color: #666;
            font-size: 15px;
        }
        
        /* æ ¸å¿ƒèµ„äº§æ€»è§ˆæ ·å¼ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            border-top: 4px solid var(--primary-color);
        }
        
        .stat-card h3 {
            font-size: 16px;
            color: #555;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .stat-desc {
            font-size: 14px;
            color: #777;
            margin-top: 5px;
        }
        
        /* æ€è€ƒè®°å½•åˆ—è¡¨æ ·å¼ */
        .records-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .record-card {
            background-color: white;
            border-radius: 8px;
            padding: 18px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            border-left: 4px solid #4caf50;
            transition: transform 0.2s;
            cursor: pointer;
            position: relative;
        }
        
        .record-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        .record-id {
            font-weight: 600;
            color: var(--primary-color);
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .record-title {
            font-size: 17px;
            font-weight: 500;
            margin-bottom: 10px;
            color: #333;
        }
        
        .record-desc {
            font-size: 14px;
            color: #666;
            line-height: 1.5;
            margin-bottom: 10px;
        }
        
        .record-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px;
        }
        
        /* æ¨¡å‹åˆ—è¡¨æ ·å¼ */
        .models-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
        }
        
        .model-card {
            background-color: white;
            border-radius: 8px;
            padding: 18px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            border-left: 4px solid #ff9800;
            transition: transform 0.2s;
            cursor: pointer;
            position: relative;
        }
        
        .model-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        .model-id {
            font-weight: 600;
            color: #ff9800;
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .model-name {
            font-size: 17px;
            font-weight: 500;
            margin-bottom: 10px;
            color: #333;
        }
        
        .model-desc {
            font-size: 14px;
            color: #666;
            line-height: 1.5;
            margin-bottom: 10px;
        }
        
        .model-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px;
        }
        
        /* å¡ç‰‡æ“ä½œæŒ‰é’® */
        .card-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .record-card:hover .card-actions,
        .model-card:hover .card-actions {
            opacity: 1;
        }
        
        .action-icon {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .action-icon.edit {
            background-color: rgba(255, 152, 0, 0.1);
            color: var(--warning-color);
        }
        
        .action-icon.delete {
            background-color: rgba(244, 67, 54, 0.1);
            color: var(--danger-color);
        }
        
        .action-icon:hover {
            transform: scale(1.1);
        }
        
        /* è¯¦ç»†å†…å®¹æ ·å¼ */
        .detail-view {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }
        
        .detail-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eaeef5;
        }
        
        .detail-title {
            font-size: 22px;
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .detail-id {
            font-size: 16px;
            color: #666;
            background-color: #f0f4f9;
            padding: 5px 10px;
            border-radius: 4px;
        }
        
        .detail-content {
            line-height: 1.6;
            font-size: 15.5px;
            color: #444;
        }
        
        .detail-content p {
            margin-bottom: 15px;
        }
        
        /* è¾“å…¥åŒºåŸŸæ ·å¼ */
        .input-section {
            background-color: var(--light-bg);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .input-section h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        textarea, input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
            resize: vertical;
            min-height: 300px;
            margin-bottom: 15px;
            font-family: monospace;
            line-height: 1.5;
        }
        
        input[type="text"] {
            min-height: auto;
            margin-bottom: 15px;
            font-family: inherit;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: var(--accent-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #4959c1;
        }
        
        .btn-secondary {
            background-color: var(--light-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }
        
        .btn-secondary:hover {
            background-color: #e9ecef;
        }
        
        .btn-success {
            background-color: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #43a047;
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }
        
        .btn-warning:hover {
            background-color: #fb8c00;
        }
        
        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #e53935;
        }
        
        /* æ ‡ç­¾æ ·å¼ */
        .tag {
            display: inline-block;
            padding: 4px 10px;
            background-color: rgba(92, 107, 192, 0.1);
            color: var(--accent-color);
            border-radius: 4px;
            font-size: 0.85rem;
            margin-right: 5px;
            margin-bottom: 5px;
        }
        
        .tag-cloud {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        /* è§£æé¢„è§ˆ */
        .parse-preview {
            background-color: white;
            border: 1px solid #e3f2fd;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }
        
        .parse-preview h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        /* å³ä¾§åŠŸèƒ½é¢æ¿ */
        .right-panel {
            width: 320px;
            background-color: #fff;
            border-left: 1px solid #e1e5eb;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            box-shadow: -2px 0 5px rgba(0, 0, 0, 0.03);
            flex-shrink: 0;
        }
        
        .search-section {
            padding: 20px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .search-box {
            position: relative;
            margin-bottom: 15px;
        }
        
        .search-box input {
            width: 100%;
            padding: 12px 15px 12px 40px;
            border: 1px solid #d1d9e6;
            border-radius: 6px;
            font-size: 14px;
            background-color: #f9fbfd;
        }
        
        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #888;
        }
        
        .filter-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .filter-options select {
            padding: 8px 12px;
            border: 1px solid #d1d9e6;
            border-radius: 4px;
            font-size: 14px;
            background-color: white;
        }
        
        .status-section {
            padding: 20px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .status-section h3 {
            color: var(--primary-color);
            font-size: 16px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 14px;
        }
        
        .status-label {
            color: #666;
        }
        
        .status-value {
            color: var(--primary-color);
            font-weight: 500;
        }
        
        /* æ–°å¢ï¼šæ¨¡å‹å…³è”ç½‘ç»œæ ·å¼ */
        .network-section {
            padding: 20px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .network-section h3 {
            color: var(--primary-color);
            font-size: 16px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .network-graph {
            height: 200px;
            background-color: #f8f9fa;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            margin-top: 10px;
            border: 1px dashed #e1e5eb;
        }
        
        /* æ–°å¢ï¼šæ•°æ®æ“ä½œæ ·å¼ */
        .data-section {
            padding: 20px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .data-section h3 {
            color: var(--primary-color);
            font-size: 16px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .data-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .data-btn {
            padding: 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .data-btn.export {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .data-btn.backup {
            background-color: var(--light-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }
        
        .data-btn.import {
            background-color: var(--light-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }
        
        .data-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .how-to-use {
            padding: 20px;
            flex: 1;
        }
        
        .how-to-use h3 {
            color: var(--primary-color);
            font-size: 16px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .steps-list {
            list-style-type: none;
            counter-reset: step-counter;
        }
        
        .steps-list li {
            margin-bottom: 15px;
            padding-left: 30px;
            position: relative;
            font-size: 14px;
            color: #555;
            line-height: 1.5;
        }
        
        .steps-list li:before {
            counter-increment: step-counter;
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            background-color: var(--primary-color);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }
        
        /* æ ¼å¼æç¤ºæ ·å¼ */
        .format-hint {
            background-color: #f0f8ff;
            border-left: 4px solid #4dabf7;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 0 6px 6px 0;
        }
        
        .format-examples {
            background-color: #f9f9f9;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .format-example {
            background-color: white;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            font-family: monospace;
            font-size: 0.9rem;
            line-height: 1.4;
            white-space: pre-wrap;
            position: relative;
        }
        
        .format-example-title {
            position: absolute;
            top: -10px;
            left: 15px;
            background-color: var(--accent-color);
            color: white;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .right-panel {
                width: 280px;
            }
        }
        
        @media (max-width: 992px) {
            .right-panel {
                display: none;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                width: 240px;
            }
            
            .stats-grid,
            .records-list,
            .models-list {
                grid-template-columns: 1fr;
            }
            
            .top-bar {
                flex-direction: column;
                gap: 10px;
                padding: 15px 20px;
            }
            
            .system-info {
                flex-wrap: wrap;
                justify-content: center;
                gap: 10px;
            }
        }
        
        /* ç©ºçŠ¶æ€æç¤º */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #888;
        }
        
        .empty-state i {
            font-size: 48px;
            margin-bottom: 15px;
            color: #ccc;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(26, 35, 126, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 20px;
        }
        
        .modal {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .modal h3 {
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .modal-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: flex-end;
        }
        
        /* è¯¦æƒ…é¡µåˆ†æ®µæ ·å¼ */
        .detail-section {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eaeef5;
        }
        
        .detail-section h4 {
            color: var(--primary-color);
            margin-bottom: 12px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .detail-section-content {
            padding-left: 10px;
        }
        
        /* æ ‡ç­¾å¤æ ¸å®¹å™¨ */
        .tag-review-container {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 25px;
            border: 1px solid var(--border-color);
        }
        
        .tag-review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .tag-review-actions {
            display: flex;
            gap: 10px;
        }
        
        /* è¡ŒåŠ¨æŒ‰é’®ç»„ */
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        /* ç´¢å¼•åˆ—è¡¨æ ·å¼ */
        .index-panel {
            background-color: var(--light-bg);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .index-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .index-item {
            padding: 8px 12px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        
        .index-item:last-child {
            border-bottom: none;
        }
        
        .index-item-id {
            font-weight: bold;
            color: var(--accent-color);
            min-width: 60px;
        }
        
        .index-item-title {
            flex: 1;
            font-size: 0.95rem;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            margin: 0 10px;
        }
        
        .index-item-actions {
            display: flex;
            gap: 5px;
        }
        
        .index-item-action {
            cursor: pointer;
            padding: 3px 5px;
            border-radius: 3px;
            transition: background-color 0.2s;
        }
        
        .index-item-action:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }
        
        /* ç³»ç»ŸçŠ¶æ€å¡ç‰‡ */
        .system-status-card {
            background-color: #e8f4fc;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .alert {
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        /* æ–°å¢ï¼šæ—¶é—´çº¿æ ·å¼ */
        .timeline-container {
            position: relative;
            margin: 40px 0;
            padding-left: 30px;
        }
        
        .timeline-line {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--secondary-color);
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 40px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .timeline-item:hover {
            transform: translateX(5px);
        }
        
        .timeline-dot {
            position: absolute;
            left: -36px;
            top: 0;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--secondary-color);
            border: 3px solid white;
            z-index: 2;
            transition: var(--transition);
        }
        
        .timeline-item:hover .timeline-dot {
            background: var(--primary-color);
            transform: scale(1.2);
        }
        
        .timeline-content {
            background: white;
            padding: 15px;
            border-radius: 6px;
            box-shadow: var(--shadow);
        }
        
        .timeline-version {
            color: var(--primary-color);
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .timeline-date {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        
        /* æ–°å¢ï¼šå…³è”ç½‘ç»œå¯è§†åŒ– */
        .network-visualization {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .network-node {
            padding: 8px 12px;
            background-color: rgba(92, 107, 192, 0.1);
            border-radius: 4px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid rgba(92, 107, 192, 0.2);
        }
        
        .network-node:hover {
            background-color: rgba(92, 107, 192, 0.2);
            transform: translateY(-2px);
        }
        
        .network-node.center {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
        }
        
        .network-connection {
            height: 2px;
            background: var(--border-color);
            flex: 1;
            max-width: 30px;
        }
        
        /* ==================== æ–°å¢ï¼šåˆ†æ®µç¼–è¾‘æ ·å¼ ==================== */
        .section-editor-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
        }
        
        .section-tab {
            padding: 8px 16px;
            background-color: var(--light-bg);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
        }
        
        .section-tab:hover {
            background-color: #e9ecef;
        }
        
        .section-tab.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .section-editor {
            display: none;
        }
        
        .section-editor.active {
            display: block;
        }
        
        .section-editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .section-editor-header h4 {
            color: var(--primary-color);
            margin: 0;
        }
        
        .section-editor textarea {
            min-height: 200px;
        }
        
        .section-preview {
            background-color: #f8f9fa;
            border-radius: 6px;
            padding: 15px;
            margin-top: 10px;
            border: 1px solid var(--border-color);
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        /* å¯ç¼–è¾‘IDæ ·å¼ */
        .editable-id {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .editable-id-label {
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .editable-id-input {
            flex: 1;
            max-width: 200px;
        }
        
        /* æ–°å¢ï¼šå…³è”æ¨¡å‹ç¼–è¾‘æ ·å¼ */
        .related-models-section {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 6px;
            border: 1px solid var(--border-color);
        }
        
        .related-models-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .related-models-input {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .related-models-input input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
        }
        
        .related-models-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
            max-height: 120px;
            overflow-y: auto;
            padding: 5px;
        }
        
        .related-model-tag {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            background-color: white;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        .related-model-tag .remove {
            cursor: pointer;
            color: var(--danger-color);
            font-size: 0.8rem;
        }
        
        .related-model-tag .remove:hover {
            color: #d32f2f;
        }
        
        .auto-extract-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
        }
        
        .auto-extract-btn:hover {
            background-color: var(--secondary-color);
        }
        
        /* ==================== æ–°å¢ï¼šæ¨¡å‹æè¿°æå–æŒ‰é’®æ ·å¼ ==================== */
        .model-description-extract-btn {
            background-color: var(--warning-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .model-description-extract-btn:hover {
            background-color: #e68900;
        }
        
        .model-description-extract-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        
        .model-description-extract-info {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-bottom: 10px;
            padding: 8px 12px;
            background-color: #f0f7ff;
            border-radius: 4px;
            border-left: 3px solid var(--accent-color);
        }
        
        /* ==================== æ–°å¢ï¼šæ—¶é—´çº¿ç¼–è¾‘æ ·å¼ ==================== */
        .timeline-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .timeline-edit-actions {
            position: absolute;
            top: 5px;
            right: 5px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .timeline-item:hover .timeline-edit-actions {
            opacity: 1;
        }
        
        .timeline-edit-btn {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
        }
        
        .timeline-edit-btn.edit {
            background-color: rgba(255, 152, 0, 0.1);
            color: var(--warning-color);
        }
        
        .timeline-edit-btn.delete {
            background-color: rgba(244, 67, 54, 0.1);
            color: var(--danger-color);
        }
        
        .timeline-edit-btn:hover {
            transform: scale(1.1);
        }
        
        /* æ—¶é—´çº¿è¯¦æƒ…æ ·å¼ */
        .timeline-detail-view {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            margin-top: 20px;
        }
        
        .timeline-detail-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eaeef5;
        }
        
        .timeline-detail-title {
            font-size: 22px;
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .timeline-detail-date {
            font-size: 16px;
            color: #666;
            background-color: #f0f4f9;
            padding: 5px 10px;
            border-radius: 4px;
        }
        
        .timeline-detail-content {
            line-height: 1.6;
            font-size: 15.5px;
            color: #444;
            margin-top: 15px;
        }
        
        /* æ—¶é—´çº¿ç¼–è¾‘è¡¨å• */
        .timeline-edit-form {
            background-color: var(--light-bg);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .timeline-form-group {
            margin-bottom: 15px;
        }
        
        .timeline-form-group label {
            display: block;
            margin-bottom: 5px;
            color: var(--primary-color);
            font-weight: 500;
        }
        
        .timeline-form-group input,
        .timeline-form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
        }
        
        .timeline-form-group textarea {
            min-height: 120px;
            resize: vertical;
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
    <div class="top-bar">
        <div class="logo">
            <div class="logo-icon">ğŸ§ </div>
            <div class="logo-text">æ€ç»´ååŒå¤„ç†å™¨</div>
        </div>
        <div class="system-info">
            <span>å½“å‰ç‰ˆæœ¬: <strong id="current-version">v22.48</strong></span>
            <span style="margin: 0 5px;">|</span>
            <span>æ¨¡å‹æ€»æ•°: <strong id="total-models">0</strong></span>
            <span style="margin: 0 5px;">|</span>
            <span>æ€è€ƒè®°å½•: <strong id="total-thoughts">0</strong></span>
            <span style="margin: 0 5px;">|</span>
            <span>æ ‡ç­¾æ•°: <strong id="total-tags">0</strong></span>
        </div>
        <div class="current-view" id="current-view">æ ¸å¿ƒèµ„äº§æ€»è§ˆ</div>
    </div>
    
    <!-- ä¸»å†…å®¹åŒº -->
    <div class="main-container">
        <!-- å·¦ä¾§å¯¼èˆªæ  -->
        <div class="sidebar">
            <div class="nav-section">
                <h3><i class="fas fa-compass"></i> æ ¸å¿ƒå¯¼èˆª</h3>
                <ul class="nav-links">
                    <li><a href="#" class="active" data-view="overview"><i class="fas fa-chart-pie"></i> æ ¸å¿ƒèµ„äº§æ€»è§ˆ</a></li>
                    <li><a href="#" data-view="add-structured"><i class="fas fa-plus-circle"></i> ç»“æ„åŒ–è¾“å…¥æ€è€ƒ</a></li>
                    <li><a href="#" data-view="thoughts"><i class="fas fa-list-ul"></i> æ€è€ƒç›®å½•å®Œæ•´æ¸…å•</a></li>
                    <li><a href="#" data-view="models"><i class="fas fa-cube"></i> æ ¸å¿ƒæ€ç»´æ¨¡å‹ç´¢å¼•</a></li>
                    <li><a href="#" data-view="add-model"><i class="fas fa-plus-square"></i> åˆ›å»ºæ€ç»´æ¨¡å‹</a></li>
                    <li><a href="#" data-view="keywords"><i class="fas fa-search"></i> æ ‡ç­¾åˆ†ç±»æ£€ç´¢</a></li>
                    <!-- æ–°å¢å¯¼èˆªé¡¹ -->
                    <li><a href="#" data-view="network-analysis"><i class="fas fa-project-diagram"></i> æ¨¡å‹å…³è”ç½‘ç»œåˆ†æ</a></li>
                    <li><a href="#" data-view="timeline"><i class="fas fa-road"></i> ç³»ç»Ÿæ¼”è¿›å†ç¨‹</a></li>
                </ul>
            </div>
            
            <div class="nav-section">
                <h3><i class="fas fa-tools"></i> ç³»ç»Ÿå·¥å…·</h3>
                <ul class="nav-links">
                    <li><a href="#" data-view="how-to-use"><i class="fas fa-question-circle"></i> å¦‚ä½•ä½¿ç”¨æœ¬ç³»ç»Ÿ</a></li>
                    <li><a href="#" data-view="milestones"><i class="fas fa-road"></i> ç³»ç»Ÿæ¼”è¿›é‡Œç¨‹ç¢‘</a></li>
                    <li><a href="#" data-view="architecture"><i class="fas fa-sitemap"></i> ç³»ç»Ÿæ¶æ„ç‰¹æ€§</a></li>
                    <li><a href="#" data-view="tag-review"><i class="fas fa-tags"></i> æ ‡ç­¾å¤æ ¸ä¸­å¿ƒ</a></li>
                    <!-- æ–°å¢å¯¼èˆªé¡¹ -->
                    <li><a href="#" data-view="data-management"><i class="fas fa-database"></i> æ•°æ®ç®¡ç†ä¸å¤‡ä»½</a></li>
                </ul>
            </div>
            
            <div class="version-selector">
                <label for="version-select">æ•°æ®ç‰ˆæœ¬:</label>
                <select id="version-select">
                    <option value="initial">åˆå§‹ç‰ˆæœ¬</option>
                    <option value="current" selected>å½“å‰ç‰ˆæœ¬ (æœ¬åœ°å­˜å‚¨)</option>
                </select>
            </div>
        </div>
        
        <!-- ä¸­é—´ä¸»å†…å®¹åŒº -->
        <div class="content-area" id="content-area">
            <!-- å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
            <div id="loading" class="loading" style="margin: 100px auto;"></div>
        </div>
        
        <!-- å³ä¾§åŠŸèƒ½é¢æ¿ -->
        <div class="right-panel">
            <div class="search-section">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-input" placeholder="æœç´¢æ€è€ƒè®°å½•æˆ–æ¨¡å‹...">
                </div>
                <div class="filter-options">
                    <select id="category-filter">
                        <option value="all">æ‰€æœ‰ç±»åˆ«</option>
                        <option value="thought">æ€è€ƒè®°å½•</option>
                        <option value="model">æ€ç»´æ¨¡å‹</option>
                        <option value="tag">æ ‡ç­¾</option>
                    </select>
                    <select id="theme-filter">
                        <option value="all">æ‰€æœ‰ä¸»é¢˜</option>
                        <option value="emotion">æƒ…æ„Ÿ/å…³ç³»</option>
                        <option value="philosophy">å“²å­¦/å­˜åœ¨</option>
                        <option value="growth">æˆé•¿/å†ç¨‹</option>
                        <option value="society">ç¤¾ä¼š/ç³»ç»Ÿ</option>
                        <option value="aesthetics">è‰ºæœ¯/è¡¨è¾¾</option>
                    </select>
                </div>
            </div>
            
            <div class="status-section">
                <h3><i class="fas fa-heartbeat"></i> ç³»ç»Ÿå¥åº·çŠ¶æ€</h3>
                <div class="status-item">
                    <span class="status-label">æ•°æ®å®Œæ•´æ€§</span>
                    <span class="status-value" id="data-integrity">100%</span>
                </div>
                <div class="status-item">
                    <span class="status-label">å…³è”ç½‘ç»œ</span>
                    <span class="status-value" id="network-health">å®Œå¥½</span>
                </div>
                <div class="status-item">
                    <span class="status-label">æ¨¡å‹å¯æ‹“å±•æ€§</span>
                    <span class="status-value" id="extensibility">å¼€æ”¾</span>
                </div>
                <div class="status-item">
                    <span class="status-label">å­˜å‚¨çŠ¶æ€</span>
                    <span class="status-value" id="storage-status">æ­£å¸¸</span>
                </div>
                <div class="status-item">
                    <span class="status-label">æœ€åä¿å­˜</span>
                    <span class="status-value" id="last-saved">åˆšåˆš</span>
                </div>
            </div>
            
            <!-- æ–°å¢ï¼šæ¨¡å‹å…³è”ç½‘ç»œ -->
            <div class="network-section">
                <h3><i class="fas fa-project-diagram"></i> æ¨¡å‹å…³è”ç½‘ç»œ</h3>
                <p style="font-size: 0.9rem; color: var(--text-light); margin-bottom: 10px;">
                    å½“å‰é€‰ä¸­æ¨¡å‹çš„å…³è”ç½‘ç»œ
                </p>
                <div class="network-graph" id="network-graph">
                    <div>
                        <i class="fas fa-project-diagram" style="font-size: 3rem; margin-bottom: 10px; color: #ccc;"></i>
                        <p>é€‰æ‹©æ¨¡å‹æŸ¥çœ‹å…³è”ç½‘ç»œ</p>
                    </div>
                </div>
            </div>
            
            <!-- æ–°å¢ï¼šæ•°æ®æ“ä½œ -->
            <div class="data-section">
                <h3><i class="fas fa-database"></i> æ•°æ®æ“ä½œ</h3>
                <div class="data-actions">
                    <button class="data-btn export" id="export-current-btn">
                        <i class="fas fa-file-export"></i> å¯¼å‡ºå½“å‰é¡¹ç›®
                    </button>
                    <button class="data-btn backup" id="backup-data-btn">
                        <i class="fas fa-sync-alt"></i> å¤‡ä»½å…¨éƒ¨æ•°æ®
                    </button>
                    <button class="data-btn import" id="import-data-btn">
                        <i class="fas fa-file-import"></i> å¯¼å…¥æ•°æ®
                    </button>
                    <button class="data-btn backup" id="export-all-btn">
                        <i class="fas fa-download"></i> å¯¼å‡ºå…¨éƒ¨æ•°æ®
                    </button>
                </div>
            </div>
            
            <div class="how-to-use">
                <h3><i class="fas fa-lightbulb"></i> å¿«é€Ÿä½¿ç”¨æŒ‡å—</h3>
                <ol class="steps-list">
                    <li>æ ¹æ®æƒ…ç»ª/é—®é¢˜å®šä½æƒ…å¢ƒ</li>
                    <li>å¿«é€Ÿæµè§ˆç›¸å…³æ ¸å¿ƒæ¨¡å‹</li>
                    <li>è°ƒç”¨å…·ä½“çš„æ€ç»´/è¡ŒåŠ¨è¦ç‚¹</li>
                    <li>åœ¨è„‘æµ·ä¸­æ¼”ç»ƒæˆ–å†™åœ¨çº¸ä¸Š</li>
                    <li>å°†çŸ¥è¯†è½¬åŒ–ä¸ºè‡ªæˆ‘æ™ºæ…§</li>
                </ol>
            </div>
        </div>
    </div>

    <!-- ç¡®è®¤åˆ é™¤æ¨¡æ€æ¡† -->
    <div id="delete-modal" class="modal-overlay" style="display: none;">
        <div class="modal">
            <h3>ç¡®è®¤åˆ é™¤</h3>
            <p id="delete-message">ç¡®å®šè¦åˆ é™¤æ­¤é¡¹å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeDeleteModal()">å–æ¶ˆ</button>
                <button class="btn btn-danger" onclick="confirmDelete()">åˆ é™¤</button>
            </div>
        </div>
    </div>

    <!-- æ ‡ç­¾å¤æ ¸æ¨¡æ€æ¡† -->
    <div id="tag-review-modal" class="modal-overlay" style="display: none;">
        <div class="modal" style="max-width: 600px;">
            <h3><i class="fas fa-tags"></i> æ ‡ç­¾å¤æ ¸ä¸ç®¡ç†</h3>
            <p style="margin-bottom: 20px; color: var(--text-light);">æ£€æŸ¥å¹¶ç®¡ç†å½“å‰é¡¹ç›®çš„æ ‡ç­¾ï¼Œç¡®ä¿åˆ†ç±»å‡†ç¡®</p>
            
            <div class="tag-review-container">
                <div class="tag-review-header">
                    <h4 id="tag-review-title">å½“å‰æ ‡ç­¾</h4>
                    <div class="tag-review-actions">
                        <button class="btn btn-secondary btn-sm" onclick="addNewTag()" style="padding: 5px 10px; font-size: 0.9rem;">
                            <i class="fas fa-plus"></i> æ–°å¢
                        </button>
                        <button class="btn btn-primary btn-sm" onclick="saveTagReview()" style="padding: 5px 10px; font-size: 0.9rem;">
                            <i class="fas fa-save"></i> ä¿å­˜
                        </button>
                    </div>
                </div>
                
                <div id="current-tags-container">
                    <!-- å½“å‰æ ‡ç­¾å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
                
                <div class="tag-input-container" style="display: flex; margin-top: 15px;">
                    <input type="text" id="new-tag-input" placeholder="è¾“å…¥æ–°æ ‡ç­¾..." style="flex: 1; padding: 10px; border: 1px solid var(--border-color); border-radius: 4px 0 0 4px;" onkeypress="if(event.key === 'Enter') addTagFromInput()">
                    <button onclick="addTagFromInput()" style="padding: 10px 15px; background-color: var(--accent-color); color: white; border: none; border-radius: 0 4px 4px 0; cursor: pointer;">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                
                <div style="margin-top: 25px;">
                    <h5 style="margin-bottom: 15px; color: var(--primary-color);">æ ‡ç­¾åˆ†ç±»å»ºè®®</h5>
                    
                    <div class="tag-category" style="margin-bottom: 20px;">
                        <div class="tag-category-title" style="font-weight: 600; color: var(--primary-color); margin-bottom: 10px; padding-bottom: 5px; border-bottom: 1px dashed var(--border-color);">æ ¸å¿ƒæ¨¡å‹æ ‡ç­¾</div>
                        <div class="category-tags" style="display: flex; flex-wrap: wrap; gap: 8px;">
                            <span class="category-tag" onclick="addSuggestedTag('ğŸ§  æ ¸å¿ƒæ¨¡å‹')" style="padding: 5px 10px; background-color: white; border: 1px solid var(--border-color); border-radius: 4px; font-size: 0.85rem; cursor: pointer; transition: var(--transition);">ğŸ§  æ ¸å¿ƒæ¨¡å‹</span>
                            <span class="category-tag" onclick="addSuggestedTag('ğŸŒŒ å“²å­¦/å­˜åœ¨æ™ºæ…§')" style="padding: 5px 10px; background-color: white; border: 1px solid var(--border-color); border-radius: 4px; font-size: 0.85rem; cursor: pointer; transition: var(--transition);">ğŸŒŒ å“²å­¦/å­˜åœ¨æ™ºæ…§</span>
                            <span class="category-tag" onclick="addSuggestedTag('ğŸ”„ ç³»ç»Ÿ/æ¨¡å‹æ•´åˆ')" style="padding: 5px 10px; background-color: white; border: 1px solid var(--border-color); border-radius: 4px; font-size: 0.85rem; cursor: pointer; transition: var(--transition);">ğŸ”„ ç³»ç»Ÿ/æ¨¡å‹æ•´åˆ</span>
                        </div>
                    </div>
                    
                    <div class="tag-category" style="margin-bottom: 20px;">
                        <div class="tag-category-title" style="font-weight: 600; color: var(--primary-color); margin-bottom: 10px; padding-bottom: 5px; border-bottom: 1px dashed var(--border-color);">å…³ç³»ä¸æƒ…æ„Ÿæ ‡ç­¾</div>
                        <div class="category-tags" style="display: flex; flex-wrap: wrap; gap: 8px;">
                            <span class="category-tag" onclick="addSuggestedTag('ğŸ’ äº²å¯†å…³ç³»/æƒ…æ„Ÿ')" style="padding: 5px 10px; background-color: white; border: 1px solid var(--border-color); border-radius: 4px; font-size: 0.85rem; cursor: pointer; transition: var(--transition);">ğŸ’ äº²å¯†å…³ç³»/æƒ…æ„Ÿ</span>
                            <span class="category-tag" onclick="addSuggestedTag('ğŸ’” å¤±å»/å‘Šåˆ«')" style="padding: 5px 10px; background-color: white; border: 1px solid var(--border-color); border-radius: 4px; font-size: 0.85rem; cursor: pointer; transition: var(--transition);">ğŸ’” å¤±å»/å‘Šåˆ«</span>
                            <span class="category-tag" onclick="addSuggestedTag('âš–ï¸ æœŸæœ›/é”™ä½')" style="padding: 5px 10px; background-color: white; border: 1px solid var(--border-color); border-radius: 4px; font-size: 0.85rem; cursor: pointer; transition: var(--transition);">âš–ï¸ æœŸæœ›/é”™ä½</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeTagReviewModal()">å–æ¶ˆ</button>
                <button class="btn btn-success" onclick="applyTagReview()">åº”ç”¨æ›´æ”¹</button>
            </div>
        </div>
    </div>

    <!-- åˆ†æ®µç¼–è¾‘æ¨¡æ€æ¡† -->
    <div id="section-edit-modal" class="modal-overlay" style="display: none;">
        <div class="modal" style="max-width: 800px;">
            <h3><i class="fas fa-edit"></i> åˆ†æ®µç¼–è¾‘æ€è€ƒå†…å®¹</h3>
            <p style="margin-bottom: 20px; color: var(--text-light);">å¯å•ç‹¬ç¼–è¾‘å„ä¸ªæ¿å—å†…å®¹</p>
            
            <div class="editable-id" id="id-editor">
                <span class="editable-id-label">æ€è€ƒID:</span>
                <input type="text" id="edit-thought-id" class="editable-id-input" placeholder="#123">
                <button class="btn btn-secondary btn-sm" onclick="validateThoughtId()" style="padding: 5px 10px; font-size: 0.9rem;">
                    <i class="fas fa-check"></i> éªŒè¯ID
                </button>
            </div>
            
            <div class="section-editor-tabs" id="section-tabs">
                <!-- æ ‡ç­¾å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <div id="section-editors-container">
                <!-- ç¼–è¾‘å™¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeSectionEditModal()">å–æ¶ˆ</button>
                <button class="btn btn-success" onclick="saveSectionEdits()">
                    <i class="fas fa-save"></i> ä¿å­˜æ‰€æœ‰æ›´æ”¹
                </button>
            </div>
        </div>
    </div>

    <!-- æ—¶é—´çº¿ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div id="timeline-edit-modal" class="modal-overlay" style="display: none;">
        <div class="modal" style="max-width: 600px;">
            <h3><i class="fas fa-edit"></i> ç¼–è¾‘ç³»ç»Ÿæ¼”è¿›è®°å½•</h3>
            <p style="margin-bottom: 20px; color: var(--text-light);">ä¿®æ”¹ç³»ç»Ÿæ¼”è¿›å†ç¨‹çš„è¯¦ç»†ä¿¡æ¯</p>
            
            <div class="timeline-edit-form">
                <div class="timeline-form-group">
                    <label for="timeline-edit-version">ç‰ˆæœ¬å·</label>
                    <input type="text" id="timeline-edit-version" placeholder="ä¾‹å¦‚: v22.48">
                </div>
                
                <div class="timeline-form-group">
                    <label for="timeline-edit-date">æ—¥æœŸ</label>
                    <input type="text" id="timeline-edit-date" placeholder="ä¾‹å¦‚: 2024-07">
                </div>
                
                <div class="timeline-form-group">
                    <label for="timeline-edit-event">äº‹ä»¶æè¿°</label>
                    <textarea id="timeline-edit-event" placeholder="è¯¦ç»†æè¿°æ­¤ç‰ˆæœ¬çš„äº‹ä»¶..."></textarea>
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeTimelineEditModal()">å–æ¶ˆ</button>
                <button class="btn btn-success" onclick="saveTimelineEdit()">
                    <i class="fas fa-save"></i> ä¿å­˜æ›´æ”¹
                </button>
            </div>
        </div>
    </div>

    <script>
        // ==================== æ•°æ®ç»“æ„ä¸å­˜å‚¨ ====================
        const DataStore = {
            thoughts: [],
            models: [],
            tags: {},
            nextThoughtId: 124,
            nextModelId: 81,
            currentVersion: "v22.48",
            lastSaved: null,
            // æ ‡ç­¾åˆ†ç±»ç³»ç»Ÿ
            tagCategories: {
                "æ ¸å¿ƒæ¨¡å‹": ["ğŸ§  æ ¸å¿ƒæ¨¡å‹", "ğŸŒŒ å“²å­¦/å­˜åœ¨æ™ºæ…§", "ğŸ”„ ç³»ç»Ÿ/æ¨¡å‹æ•´åˆ", "âš™ï¸ å†³ç­–/è¡ŒåŠ¨", "ğŸ­ è’è¯/å¹½é»˜"],
                "å…³ç³»ä¸æƒ…æ„Ÿ": ["ğŸ’ äº²å¯†å…³ç³»/æƒ…æ„Ÿ", "ğŸ’” å¤±å»/å‘Šåˆ«", "âš–ï¸ æœŸæœ›/é”™ä½", "ğŸŒ± æˆé•¿/å†ç¨‹", "ğŸ˜¶ é“å¾·/ä¼¦ç†"],
                "æ—¶é—´ä¸å­˜åœ¨": ["â³ æ—¶é—´/å®¿å‘½", "â° è®°å¿†/é—å¿˜", "ğŸŒ å­˜åœ¨/æ„ŸçŸ¥", "ğŸŒ€ å¾ªç¯/é‡å¤", "ğŸš¶ å†ç¨‹/è·¯å¾„"],
                "è‰ºæœ¯ä¸è¡¨è¾¾": ["ğŸµ æ­Œæ›²åˆ†æ", "ğŸ­ æ–‡è‰ºæ‰¹è¯„", "ğŸ¨ è‰ºæœ¯/è±¡å¾", "ğŸ—£ï¸ è¯­è¨€/å™äº‹", "ğŸ“š æ–‡æœ¬åˆ†æ"],
                "ç¤¾ä¼šä¸ç³»ç»Ÿ": ["âš”ï¸ åæŠ—/è¾¹ç¼˜", "ğŸ”„ ç³»ç»Ÿ/ç»“æ„", "ğŸ›ï¸ åˆ¶åº¦/æƒåŠ›", "ğŸŒ ç½‘ç»œ/è¿æ¥", "âš–ï¸ ä¼¦ç†/è´£ä»»"],
                "ç‰¹æ®ŠçŠ¶æ€": ["ğŸ”¥ æç«¯ä½“éªŒ", "ğŸŒ€ è§£æ„/é‡æ„", "ğŸ¯ èšç„¦/ä¸“æ³¨", "ğŸ’¡ çµæ„Ÿ/æ´è§", "ğŸ›¡ï¸ é˜²å¾¡/ä¿æŠ¤"]
            },
            
            // æ¨¡å‹å…³è”ç½‘ç»œ
            modelConnections: {
                "M-80": ["M-74", "M-78", "M-69", "M-77", "M-67"],
                "M-79": ["M-77", "M-71", "M-67"],
                "M-78": ["M-74", "M-73", "M-77", "M-76"],
                "M-77": ["M-69", "M-71", "M-67", "M-76"],
                "M-76": ["M-60", "M-71", "M-62", "M-66", "M-74"],
                "M-75": ["M-73", "M-72", "M-94"],
                "M-74": ["M-69", "M-30", "M-66", "M-67"],
                "M-73": ["M-94", "M-70", "M-72", "M-68"]
            },
            
            // å®šä¹‰å…³é”®æ ‡é¢˜çš„å¤šç§å¯èƒ½å½¢å¼
            sectionTitles: {
                "çŠ¶æ€çœ‹æ¿": [
                    "ğŸ’ **çŠ¶æ€çœ‹æ¿**", "ğŸ’ çŠ¶æ€çœ‹æ¿", "çŠ¶æ€çœ‹æ¿:", "çŠ¶æ€çœ‹æ¿", "çŠ¶æ€", "çœ‹æ¿",
                    "ğŸ’¡ **çŠ¶æ€çœ‹æ¿**", "ğŸ“Š **çŠ¶æ€çœ‹æ¿**", "ğŸ“‹ **çŠ¶æ€çœ‹æ¿**", "ç³»ç»ŸçŠ¶æ€", "æ€è€ƒçŠ¶æ€"
                ],
                "æ ¸å¿ƒç»“è®º": [
                    "ğŸŒŒ **æ ¸å¿ƒç»“è®º**", "ğŸŒŒ æ ¸å¿ƒç»“è®º", "æ ¸å¿ƒç»“è®º:", "æ ¸å¿ƒç»“è®º", "ç»“è®º", "æ ¸å¿ƒè§‚ç‚¹",
                    "ğŸ¯ **æ ¸å¿ƒç»“è®º**", "âœ¨ **æ ¸å¿ƒç»“è®º**", "ğŸ’¡ **æ ¸å¿ƒç»“è®º**", "ä¸»è¦ç»“è®º", "æ ¸å¿ƒå‘ç°"
                ],
                "æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ": [
                    "ğŸ§© **æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ**", "ğŸ§© æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ", "æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ:", "æ¨¡å‹å»¶ä¼¸", "æ¨¡å‹æ•´åˆ",
                    "æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ", "æ¨¡å‹æ‰©å±•", "æ•´åˆæ¨¡å‹", "ğŸ”— **æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ**", "æ¨¡å‹å…³è”"
                ],
                "è¡ŒåŠ¨/æ€ç»´è¦ç‚¹": [
                    "ğŸ“š **è¡ŒåŠ¨/æ€ç»´è¦ç‚¹**", "ğŸ“š è¡ŒåŠ¨/æ€ç»´è¦ç‚¹", "è¡ŒåŠ¨/æ€ç»´è¦ç‚¹:", "è¡ŒåŠ¨æ€ç»´è¦ç‚¹",
                    "è¡ŒåŠ¨è¦ç‚¹", "æ€ç»´è¦ç‚¹", "è¦ç‚¹", "è¡ŒåŠ¨å»ºè®®", "æ€ç»´å»ºè®®", "ğŸ¯ **è¡ŒåŠ¨/æ€ç»´è¦ç‚¹**"
                ],
                "æ¶æ„æ›´æ–°": [
                    "ğŸ“‚ **æ¶æ„æ›´æ–°**", "ğŸ“‚ æ¶æ„æ›´æ–°", "æ¶æ„æ›´æ–°:", "æ¶æ„æ›´æ–°", "ç³»ç»Ÿæ›´æ–°",
                    "æ›´æ–°æ—¥å¿—", "ç‰ˆæœ¬æ›´æ–°", "ğŸ“ˆ **æ¶æ„æ›´æ–°**", "ğŸ”„ **æ¶æ„æ›´æ–°**"
                ]
            },
            
            // ç³»ç»Ÿæ¼”è¿›é‡Œç¨‹ç¢‘æ•°æ®
            timeline: [
                {id: "t1", version: "v1.0-v5.0", date: "2023-01", event: "åŸºç¡€æƒ…æ„Ÿæ¨¡å‹å»ºç«‹ï¼ˆå·¥å…·åŒ–ã€é”™ä½ã€é—æ†¾ï¼‰"},
                {id: "t2", version: "v6.0-v10.0", date: "2023-03", event: "å…³ç³»æ¨¡å‹æ·±åŒ–ï¼ˆæˆç†Ÿé¦ˆèµ ã€æ— é™åšå¼ˆï¼‰"},
                {id: "t3", version: "v11.0-v15.0", date: "2023-05", event: "å­˜åœ¨å“²å­¦æ‹“å±•ï¼ˆå­˜åœ¨å‹˜æ¢ã€æ°´æ€§æ™ºæ…§ï¼‰"},
                {id: "t4", version: "v16.0-v18.0", date: "2023-07", event: "é˜²å¾¡æœºåˆ¶ä¸ç—…ç†å­¦å®Œå–„ï¼ˆæ¢¦å¢ƒå¯„ç”Ÿã€æƒ…æ„Ÿéº»ç—¹ï¼‰"},
                {id: "t5", version: "v18.0-v20.2", date: "2023-09", event: "å…³ç³»åŠ¨åŠ›å­¦ã€å¥åº·å…±å»ºã€æ„ä¹‰æ•´åˆ"},
                {id: "t6", version: "v20.3-v21.3", date: "2023-11", event: "å®è§‚ç¤¾ä¼šæ‰¹åˆ¤ã€ä¸ªä½“ç”Ÿå­˜ç­–ç•¥ã€å“²å­¦æ¡†æ¶æ™®é€‚åŒ–"},
                {id: "t7", version: "v21.4-v22.0", date: "2024-01", event: "äº²å¯†å…³ç³»å…‰è°±ã€å­˜åœ¨æ€§å¯„ç”Ÿã€ç†µå¢æŸè€—ã€ç¥›é­…æ‚¬ç½®ã€å¶åƒå¹»ç­ã€åˆ›ä¼¤åé‡å»ºã€è™šæ— ç¾å­¦æ•´åˆ"},
                {id: "t8", version: "v22.1-v22.2", date: "2024-03", event: "åŒè½¨åˆ¶æ¶æ„å»ºç«‹ï¼Œæ–°å¢ M-45 è‡³ M-53 æ¨¡å‹"},
                {id: "t9", version: "v22.33", date: "2024-05", event: "ã€Šæˆ‘ä»¬å¾ˆå¥½ã€‹Ã—ã€Šå¿«ä¹æ˜ŸçŒ«ã€‹å…³ç³»è¯Šç–—æ•´åˆç‰ˆ"},
                {id: "t10", version: "v22.48", date: "2024-07", event: "ã€Šå¯„å±…ã€‹Ã—ã€ŠèŠ±ã€‹æ•´åˆç‰ˆï¼Œæ¨¡å‹æ€»æ•°è¾¾80ä¸ª"}
            ],
            
            // å½“å‰æ­£åœ¨ç¼–è¾‘çš„æ—¶é—´çº¿é¡¹ç›®ID
            editingTimelineId: null,
            
            // åˆå§‹ç‰ˆæœ¬æ•°æ®å­˜å‚¨
            initialData: null,
            
            init: function() {
                // æ£€æŸ¥æ˜¯å¦å¯ä»¥ä½¿ç”¨ç»Ÿä¸€æ•°æ®ç®¡ç†å™¨
                if (typeof UnifiedDataManager !== 'undefined') {
                    try {
                        // ä½¿ç”¨ç»Ÿä¸€æ•°æ®ç®¡ç†å™¨è·å–æ•°æ®
                        const fullData = UnifiedDataManager.getFullData();
                        
                        // åŠ è½½æ•°æ®åˆ°DataStore
                        this.thoughts = fullData.thoughts || [];
                        this.models = fullData.models || [];
                        this.tags = fullData.tags || {};
                        this.nextThoughtId = fullData.nextThoughtId || 124;
                        this.nextModelId = fullData.nextModelId || 81;
                        this.currentVersion = fullData.currentVersion || "v22.48";
                        this.lastSaved = fullData.lastSaved || new Date().toISOString();
                        this.timeline = fullData.timeline || this.timeline;
                        this.modelConnections = fullData.modelConnections || this.modelConnections;
                        
                        // æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ›å»ºç¤ºä¾‹æ•°æ®ï¼ˆé¦–æ¬¡ä½¿ç”¨ï¼‰
                        if (this.thoughts.length === 0 && this.models.length === 0) {
                            console.log('é¦–æ¬¡ä½¿ç”¨ï¼Œåˆ›å»ºç¤ºä¾‹æ•°æ®...');
                            this.addExampleData();
                            
                            // ä¿å­˜ç¤ºä¾‹æ•°æ®åˆ°ç»Ÿä¸€ç®¡ç†å™¨
                            this.saveToUnifiedManager();
                        } else {
                            // ä¿å­˜åˆå§‹ç‰ˆæœ¬æ•°æ®
                            this.saveInitialData();
                            console.log('æ•°æ®åŠ è½½æˆåŠŸ');
                        }
                        
                        // è®¾ç½®è·¨é¡µé¢æ•°æ®åŒæ­¥ç›‘å¬
                        this.setupDataSyncListener();
                        
                    } catch (e) {
                        console.log('ä½¿ç”¨ç»Ÿä¸€æ•°æ®ç®¡ç†å™¨å¤±è´¥ï¼Œå›é€€åˆ°æœ¬åœ°å­˜å‚¨', e);
                        this.loadFromLocalStorage();
                    }
                } else {
                    // å¦‚æœæ²¡æœ‰ç»Ÿä¸€æ•°æ®ç®¡ç†å™¨ï¼Œä½¿ç”¨åŸæ¥çš„æœ¬åœ°å­˜å‚¨æ–¹å¼
                    this.loadFromLocalStorage();
                }
                
                // åˆå§‹åŒ–UIç»Ÿè®¡
                this.updateUIStats();
            },
            
            // æ–°å¢ï¼šä»æœ¬åœ°å­˜å‚¨åŠ è½½æ•°æ®ï¼ˆåŸæ¥çš„é€»è¾‘ï¼‰
            loadFromLocalStorage: function() {
                const saved = localStorage.getItem('structuredThoughtAssistant');
                if (saved) {
                    try {
                        const data = JSON.parse(saved);
                        this.thoughts = data.thoughts || [];
                        this.models = data.models || [];
                        this.tags = data.tags || {};
                        this.nextThoughtId = data.nextThoughtId || 124;
                        this.nextModelId = data.nextModelId || 81;
                        this.currentVersion = data.currentVersion || "v22.48";
                        this.lastSaved = data.lastSaved || new Date().toISOString();
                        this.timeline = data.timeline || this.timeline;
                        this.modelConnections = data.modelConnections || this.modelConnections;
                        
                        // ä¿å­˜åˆå§‹ç‰ˆæœ¬æ•°æ®
                        this.saveInitialData();
                        console.log('ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ•°æ®æˆåŠŸ');
                    } catch (e) {
                        console.log('è§£æå¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æ•°æ®', e);
                        this.addExampleData();
                    }
                } else {
                    this.addExampleData();
                }
            },
            
            // æ–°å¢ï¼šä¿å­˜æ•°æ®åˆ°ç»Ÿä¸€ç®¡ç†å™¨
            saveToUnifiedManager: function() {
                if (typeof UnifiedDataManager !== 'undefined') {
                    try {
                        const data = {
                            thoughts: this.thoughts,
                            models: this.models,
                            tags: this.tags,
                            timeline: this.timeline,
                            modelConnections: this.modelConnections,
                            currentVersion: this.currentVersion,
                            lastSaved: new Date().toISOString(),
                            nextThoughtId: this.nextThoughtId,
                            nextModelId: this.nextModelId
                        };
                        
                        UnifiedDataManager.saveData(data);
                        console.log('æ•°æ®å·²ä¿å­˜åˆ°ç»Ÿä¸€ç®¡ç†å™¨');
                    } catch (e) {
                        console.error('ä¿å­˜åˆ°ç»Ÿä¸€ç®¡ç†å™¨å¤±è´¥:', e);
                        // å›é€€åˆ°åŸæ¥çš„ä¿å­˜æ–¹å¼
                        this.saveToLocalStorage();
                    }
                } else {
                    this.saveToLocalStorage();
                }
            },
            
            // æ–°å¢ï¼šä¿å­˜æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨ï¼ˆåŸæ¥çš„é€»è¾‘ï¼‰
            saveToLocalStorage: function() {
                const data = {
                    thoughts: this.thoughts,
                    models: this.models,
                    tags: this.tags,
                    nextThoughtId: this.nextThoughtId,
                    nextModelId: this.nextModelId,
                    currentVersion: this.currentVersion,
                    lastSaved: new Date().toISOString(),
                    timeline: this.timeline,
                    modelConnections: this.modelConnections
                };
                
                try {
                    localStorage.setItem('structuredThoughtAssistant', JSON.stringify(data));
                    this.lastSaved = data.lastSaved;
                    console.log('æ•°æ®ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨æˆåŠŸ');
                    return true;
                } catch (e) {
                    console.error('ä¿å­˜æ•°æ®å¤±è´¥:', e);
                    return false;
                }
            },
            
            // æ–°å¢ï¼šè®¾ç½®æ•°æ®åŒæ­¥ç›‘å¬
            setupDataSyncListener: function() {
                // ç›‘å¬storageäº‹ä»¶ï¼ˆåŒä¸€æµè§ˆå™¨ä¸åŒæ ‡ç­¾é¡µï¼‰
                window.addEventListener('storage', (e) => {
                    if (e.key === 'structuredThoughtAssistant' && e.newValue) {
                        console.log('æ£€æµ‹åˆ°å…¶ä»–æ ‡ç­¾é¡µçš„æ•°æ®å˜åŒ–');
                        // é‡æ–°åŠ è½½æ•°æ®
                        setTimeout(() => {
                            location.reload();
                        }, 500);
                    }
                });
                
                // ç›‘å¬è‡ªå®šä¹‰æ•°æ®æ›´æ–°äº‹ä»¶
                window.addEventListener('data-updated', () => {
                    console.log('æ•°æ®å·²æ›´æ–°ï¼Œé‡æ–°åŠ è½½æ•°æ®...');
                    // é‡æ–°åŠ è½½æ•°æ®
                    setTimeout(() => {
                        location.reload();
                    }, 500);
                });
            },
            
            // ä¿å­˜åˆå§‹ç‰ˆæœ¬æ•°æ®
            saveInitialData: function() {
                if (!this.initialData) {
                    this.initialData = {
                        thoughts: JSON.parse(JSON.stringify(this.thoughts)),
                        models: JSON.parse(JSON.stringify(this.models)),
                        tags: JSON.parse(JSON.stringify(this.tags)),
                        nextThoughtId: this.nextThoughtId,
                        nextModelId: this.nextModelId,
                        currentVersion: this.currentVersion,
                        lastSaved: this.lastSaved,
                        timeline: JSON.parse(JSON.stringify(this.timeline))
                    };
                }
            },
            
            // åŠ è½½åˆå§‹ç‰ˆæœ¬
            loadInitialVersion: function() {
                if (this.initialData) {
                    this.thoughts = JSON.parse(JSON.stringify(this.initialData.thoughts));
                    this.models = JSON.parse(JSON.stringify(this.initialData.models));
                    this.tags = JSON.parse(JSON.stringify(this.initialData.tags));
                    this.nextThoughtId = this.initialData.nextThoughtId;
                    this.nextModelId = this.initialData.nextModelId;
                    this.currentVersion = this.initialData.currentVersion;
                    this.lastSaved = this.initialData.lastSaved;
                    this.timeline = JSON.parse(JSON.stringify(this.initialData.timeline));
                    
                    console.log('å·²åŠ è½½åˆå§‹ç‰ˆæœ¬æ•°æ®');
                    return true;
                } else {
                    console.log('æœªæ‰¾åˆ°åˆå§‹ç‰ˆæœ¬æ•°æ®');
                    return false;
                }
            },
            
            addExampleData: function() {
                // æ·»åŠ ç¤ºä¾‹ç»“æ„åŒ–æ€è€ƒ
                const exampleThought = this.parseStructuredContent(`ğŸ’ **çŠ¶æ€çœ‹æ¿**  
**ç³»ç»Ÿç‰ˆæœ¬**ï¼šv22.48ï¼ˆã€Šå¯„å±…ã€‹Ã—ã€ŠèŠ±ã€‹æ•´åˆç‰ˆï¼‰  
**å½“å‰æ€è€ƒID**ï¼š#123  
**æ€è€ƒä¸»é¢˜**ï¼šã€Šå¯„å±…ã€‹ä¸ã€ŠèŠ±ã€‹â€”â€”ä¸¤ç§å…³ç³»å­˜åœ¨è®ºï¼š"äººé—´çƒŸç«"çš„ç°ä¸–å®ˆæŠ¤ vs "è¶…ç„¶å®¿å‘½"çš„å¾ªç¯å› æœ  
**æ€è€ƒç±»å‹**ï¼šğŸµ æ­Œæ›²åˆ†æï¼ˆå…³ç³»å“²å­¦ / æ—¶é—´æ€§æ¯”è¾ƒï¼‰  
**å…³é”®æ ‡è®°**ï¼šğŸ§  æ ¸å¿ƒæ¨¡å‹ã€ğŸ’ äº²å¯†å…³ç³»/æƒ…æ„Ÿã€â³ æ—¶é—´/å®¿å‘½ã€ğŸŒŒ å“²å­¦/å­˜åœ¨æ™ºæ…§  
**å…³è”ç½‘ç»œ**ï¼šå¼ºå…³è”äº #116 M-74ï¼ˆçˆ±ä½œä¸ºå®‰å…¨åŸºåœ°çš„æˆé•¿ï¼‰ã€#121 M-78ï¼ˆäº²å¯†é¢„æœŸé”™ä½ï¼‰ã€#111 M-69ï¼ˆçˆ±çš„åœ¨åœºæ€§é‡æ„ï¼‰ã€#120 M-77ï¼ˆç»ˆå±€å¯¹è¯ï¼‰ã€#109 M-67ï¼ˆç†æƒ³é™è§£ä¸æ„ä¹‰é”šå®šï¼‰ã€‚æœ¬æ€è€ƒæ˜¯å¯¹ä¸¤ç§æ ¹æœ¬æ€§çš„å…³ç³»ä¸–ç•Œå›¾æ™¯ä¸æ—¶é—´æ€§ä½“éªŒçš„å¯¹æ¯”åˆ†æã€‚  

ğŸŒŒ **æ ¸å¿ƒç»“è®ºï¼šä¸¤ç§å…³ç³»å­˜åœ¨è®ºçš„å¯¹å³™â€”â€”ä»¥"è´£ä»»"ä¸ºè½´å¿ƒçš„çº¿æ€§å»ºé€  vs ä»¥"ç¼˜åŠ«"ä¸ºæ³•åˆ™çš„å¾ªç¯è®¤å‘½**  
ã€Šå¯„å±…ã€‹ä¸ã€ŠèŠ±ã€‹å‘ˆç°äº†çˆ±æƒ…ï¼ˆä¹ƒè‡³æ·±å±‚å…³ç³»ï¼‰ä¸­ä¸¤ç§å‡ ä¹æ— æ³•é€šçº¦çš„"å­˜åœ¨è®º"ï¼šä¸€ç§å°†å…³ç³»è§†ä¸ºåœ¨**çº¿æ€§æ—¶é—´**ä¸­é€šè¿‡**ä¸»åŠ¨æ‹…è´£ä¸å…±åŒè¡ŒåŠ¨**æ¥å»ºé€ çš„"äººé—´å ¡å’"ï¼›å¦ä¸€ç§å°†å…³ç³»è§†ä¸ºåœ¨**å¾ªç¯æ—¶é—´**ä¸­è¢«**å®¿å‘½æ³•åˆ™ï¼ˆç¼˜/åŠ«ï¼‰** æ‰€è§„å®šçš„"çµé­‚ç”Ÿæ€"ã€‚  
1.  **ã€Šå¯„å±…ã€‹ï¼šå…³ç³»ä½œä¸º"ç°ä¸–çš„å»ºé€ "**  
    *   **æ—¶é—´æ€§**ï¼š**çº¿æ€§ã€å‰è¿›çš„**ã€‚å…³ç³»æœ‰æ˜ç¡®çš„èµ·ç‚¹ï¼ˆ"è¢«ä½ ä¿®è¡¥"ï¼‰ã€æŒç»­çš„ç°åœ¨ï¼ˆ"ä¸€å¤©å¤©ç»ƒä¹ "ï¼‰ã€ä»¥åŠæœ‰å¾…å…±åŒåˆ›é€ çš„æœªæ¥ï¼ˆ"åˆ¶é€ å£®ä¸¾"ï¼‰ã€‚è¿‡å»çš„ä¸å¿«å¯ä»¥"åŒ–å…¥é£é‡Œ"ï¼Œæœªæ¥å¯ä»¥"æœªæ€•å…´è¡°"ã€‚  
    *   **æ ¸å¿ƒåŠ¨ä½œ**ï¼š**"åº‡æŠ¤"ä¸"ç»ƒä¹ "**ã€‚"è¯·è¿›å…¥æˆ‘åŒçœ¼é‡Œå¯„å±…"æ˜¯å°†è‡ªæˆ‘è½¬åŒ–ä¸ºä»–è€…çš„å®‰å…¨å®¹å™¨ï¼›"è¶Šçˆ±è¶Šå¤©çœŸ"æ˜¯é€šè¿‡æ—¥å¤ä¸€æ—¥çš„ç»ƒä¹ æ¥ç»´ç³»å…³ç³»çŠ¶æ€ã€‚çˆ±æ˜¯**ä¸»åŠ¨é€‰æ‹©çš„æ‹…å­**ï¼ˆ"æˆ‘çš„å¹¸è¿äº‹å«è´£ä»»"ï¼‰ã€‚  
    *   **ä¸–ç•Œå›¾æ™¯**ï¼šä¸–ç•Œæ˜¯å¯èƒ½å¸¦æ¥"æ•™è®­"çš„å´å²–ä¹‹åœ°ï¼Œä½†**äºŒäººç»„æˆçš„"æˆ‘ä»¬"å¯ä»¥åœ¨æ­¤å»ºé€ ä¸€ä¸ªå±€éƒ¨ç¨³å®šçš„"ä¹å›­"**ï¼ˆ"é’æ˜¥çš„ä¹å›­"ï¼‰ï¼Œä»¥å¯¹æŠ—å¤–éƒ¨çš„"æœ«æ—¥"ä¸"ç–²å€¦"ã€‚å…³ç³»æ˜¯**å¯¹æŠ—ä¸–ç•Œç†µå¢çš„å±€éƒ¨é€†æµ**ã€‚  
2.  **ã€ŠèŠ±ã€‹ï¼šå…³ç³»ä½œä¸º"å®¿å‘½çš„æ˜¾ç°"**  
    *   **æ—¶é—´æ€§**ï¼š**å¾ªç¯ã€è½®å›çš„**ã€‚æ—¶é—´å¦‚èŠ±å¼€èŠ±è½ã€çµé­‚åˆ†åˆï¼Œæ˜¯"ç¿çƒ‚â€”æ•£è½â€”æ¯èâ€”å†ç”Ÿ"çš„æ— å°½å¾ªç¯ã€‚ä»Šç”Ÿåªæ˜¯å…¶ä¸­ä¸€ç¯ï¼ˆ"ä»Šä¸–å­½å€ºè½¬ç”Ÿå†ç»­ç¼˜"ï¼‰ã€‚å…³ç³»æ˜¯**æ—¶é—´å¾ªç¯ä¸­çš„ä¸€ä¸ªç›¸ä½**ã€‚  
    *   **æ ¸å¿ƒåŠ¨ä½œ**ï¼š**"è®¤"ä¸"æ¸¡"**ã€‚è®¤å‡ºå…³ç³»æ˜¯"å‘½é‡Œçº·çº·æ‰°æ‰°çš„æŒ‡å¼•"ï¼Œæ¥å—"ç¼˜èšæ•£"çš„å®šæ•°ã€‚ä¸ªä½“åŠ¨ä½œæ˜¯"çµé­‚æ¸¡è¿‡æ—¶åœ°æ•£èšææµ…"ï¼Œæ˜¯æ¼‚æµ®è€Œéå»ºé€ ã€‚çˆ±æ˜¯**è¢«åŠ¨æ‰¿æ¥çš„"å€º"æˆ–"ç¼˜"**ã€‚  
    *   **ä¸–ç•Œå›¾æ™¯**ï¼šä¸–ç•Œæ˜¯ä¸€ä¸ªå·¨å¤§çš„ã€æ— æ³•é€ƒè„±çš„**ç”Ÿæ€æ³•åˆ™ç³»ç»Ÿ**ï¼ˆ"æµ®åä¸–ç•Œä»é€ƒä¸å‡ºé‚£ç”Ÿæ€"ï¼‰ã€‚å…³ç³»ï¼ˆèŠ±ï¼‰çš„ç»½æ”¾ä¸æ¯ç«­ï¼Œæ˜¯è¿™å¥—è‡ªç„¶æ³•åˆ™çš„ä½“ç°ã€‚ä¸ªäººæ„å¿—æ¸ºå°ï¼Œ**å…³ç³»æ˜¯æ³•åˆ™çš„ä¾‹è¯ï¼Œè€Œéå¯¹æŠ—æ³•åˆ™çš„ä¾‹å¤–**ã€‚  
3.  **æ ¹æœ¬å¯¹å³™**ï¼šè¿™æ˜¯ **"äººä¹‰è®º"å…³ç³»è§‚** ä¸ **"ç¥ä¹‰è®º"ï¼ˆæˆ–"è‡ªç„¶æ³•åˆ™è®º"ï¼‰å…³ç³»è§‚** çš„è¯—æ„è¡¨è¾¾ã€‚å‰è€…ç›¸ä¿¡äººçš„è´£ä»»ä¸è¡ŒåŠ¨èƒ½èµ‹äºˆå…³ç³»ä»¥æ„ä¹‰å’ŒæŒä¹…ï¼›åè€…ç›¸ä¿¡å…³ç³»çš„æ„ä¹‰ä¸æœŸé™æ—©å·²è¢«æ›´å¤§çš„å®‡å®™æ³•åˆ™æ‰€è§„å®šï¼Œäººçš„è§’è‰²æ˜¯ä½“è®¤ä¸æ¥å—ã€‚  

ğŸ§© **æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ**  
**1. "å…³ç³»å­˜åœ¨è®º"äºŒå…ƒæ¨¡å‹ (M-80 æ–°å»º)**  
*   **å®šä¹‰**ï¼šæè¿°ä¸ªä½“åœ¨æ·±åº¦å…³ç³»ä¸­æ‰€ç§‰æŒçš„ã€å…³äºå…³ç³»ä¹‹æœ¬è´¨ã€æ—¶é—´æ€§ä¸èƒ½åŠ¨æ€§çš„æ ¹æœ¬é¢„è®¾æ¡†æ¶ã€‚ä¸»è¦åˆ†ä¸ºä¸¤ç§ç†æƒ³ç±»å‹ï¼š  
    1.  **å»ºé€ è€…æ¨¡å¼**ï¼šè®¤ä¸ºå…³ç³»æœ¬è´¨ä¸Šæ˜¯**åœ¨æ—¶é—´ä¸­é€šè¿‡åŒæ–¹æŒç»­åŠªåŠ›æ„å»ºçš„å®ä½“**ã€‚æ—¶é—´çº¿æ€§ï¼Œæœªæ¥å¼€æ”¾ï¼Œæ ¸å¿ƒèƒ½åŠ¨æ€§æ˜¯**è´£ä»»ã€åº‡æŠ¤ä¸å…±åŒåˆ›é€ **ã€‚æ„ä¹‰æºäºå»ºé€ è¿‡ç¨‹æœ¬èº«ã€‚  
    2.  **ä½“è®¤è€…æ¨¡å¼**ï¼šè®¤ä¸ºå…³ç³»æœ¬è´¨ä¸Šæ˜¯**åœ¨æ›´å¤§çš„å®‡å®™æˆ–å‘½è¿æ³•åˆ™ä¸‹æ˜¾ç°çš„é˜¶æ®µæ€§çŠ¶æ€**ã€‚æ—¶é—´å¾ªç¯ï¼Œå‰§æœ¬æ—¢å®šï¼Œæ ¸å¿ƒèƒ½åŠ¨æ€§æ˜¯**æ¥å—ã€ä½“è®¤ä¸æ¸¡è¿‡**ã€‚æ„ä¹‰æºäºå¯¹æ³•åˆ™çš„é¢†æ‚Ÿä¸è‡£æœã€‚  

ğŸ“š **è¡ŒåŠ¨/æ€ç»´è¦ç‚¹ï¼ˆå®¡è§†ä½ çš„å…³ç³»å­˜åœ¨è®ºï¼‰**  
1.  ã€**å­˜åœ¨è®ºè‡ªæ£€**ã€‘ä½ ç›¸ä¿¡å…³ç³»æ˜¯"å»ºé€ "çš„è¿˜æ˜¯"è®¤å‘½"çš„ï¼Ÿ  

ğŸ“‚ **æ¶æ„æ›´æ–°**  
*   **æ–°å¢æ ¸å¿ƒæ¨¡å‹**ï¼š**M-80 "å…³ç³»å­˜åœ¨è®º"äºŒå…ƒæ¨¡å‹** (äº #123 å»ºç«‹)ã€‚  
*   **ç³»ç»Ÿç‰ˆæœ¬**ï¼šv22.47 â†’ **v22.48**ã€‚`);
                
                exampleThought.id = "#123";
                exampleThought.date = new Date().toISOString().split('T')[0];
                this.thoughts.push(exampleThought);
                
                // æ·»åŠ ç¤ºä¾‹æ¨¡å‹
                this.addModel({
                    id: "M-80",
                    name: "å…³ç³»å­˜åœ¨è®ºæ¨¡å‹",
                    description: "æè¿°ä¸ªä½“åœ¨æ·±åº¦å…³ç³»ä¸­æ‰€ç§‰æŒçš„ã€å…³äºå…³ç³»ä¹‹æœ¬è´¨ã€æ—¶é—´æ€§ä¸èƒ½åŠ¨æ€§çš„æ ¹æœ¬é¢„è®¾æ¡†æ¶ã€‚ä¸»è¦åˆ†ä¸ºä¸¤ç§ç†æƒ³ç±»å‹ï¼šå»ºé€ è€…æ¨¡å¼ä¸ä½“è®¤è€…æ¨¡å¼ã€‚",
                    date: new Date().toISOString().split('T')[0],
                    tags: ["ğŸ§  æ ¸å¿ƒæ¨¡å‹", "ğŸ’ äº²å¯†å…³ç³»/æƒ…æ„Ÿ", "ğŸŒŒ å“²å­¦/å­˜åœ¨æ™ºæ…§", "â³ æ—¶é—´/å®¿å‘½"],
                    fromThought: "#123",
                    relatedModels: ["M-74", "M-78", "M-69", "M-77", "M-67"],
                    usageCount: 12,
                    lastUsed: "2025-07-20"
                });
                
                // æ·»åŠ æ›´å¤šç¤ºä¾‹æ¨¡å‹
                this.addModel({
                    id: "M-79",
                    name: "è¯ é‡Šä¼¦ç†æ¨¡å‹",
                    description: "è‡ªæˆ‘ä¸­å¿ƒæŠ•å°„ vs ä»–è€…å¯¼å‘å…±æƒ…ï¼Œæè¿°åœ¨è§£è¯»ä»–äººè¡Œä¸ºæ—¶çš„ä¼¦ç†ç«‹åœºå·®å¼‚",
                    date: "2025-07-19",
                    tags: ["ğŸ§  æ ¸å¿ƒæ¨¡å‹", "âš–ï¸ ä¼¦ç†/è´£ä»»", "ğŸ¨ è‰ºæœ¯/è±¡å¾", "ğŸŒŒ å“²å­¦/å­˜åœ¨æ™ºæ…§"],
                    fromThought: "#122",
                    relatedModels: ["M-77", "M-71", "M-67"],
                    usageCount: 8,
                    lastUsed: "2025-07-19"
                });
                
                this.addModel({
                    id: "M-78",
                    name: "äº²å¯†é¢„æœŸé”™ä½æ¨¡å‹",
                    description: "èåˆæ¸´æœ› vs è·ç¦»ä¿å…¨ï¼Œæè¿°äº²å¯†å…³ç³»ä¸­åŒæ–¹å¯¹è·ç¦»å’Œèåˆåº¦æœŸå¾…çš„å·®å¼‚",
                    date: "2025-07-18",
                    tags: ["ğŸ§  æ ¸å¿ƒæ¨¡å‹", "ğŸ’ äº²å¯†å…³ç³»/æƒ…æ„Ÿ", "âš–ï¸ æœŸæœ›/é”™ä½", "ğŸŒ± æˆé•¿/å†ç¨‹"],
                    fromThought: "#121",
                    relatedModels: ["M-74", "M-73", "M-77", "M-76"],
                    usageCount: 15,
                    lastUsed: "2025-07-18"
                });
                
                // æ·»åŠ æ›´å¤šç¤ºä¾‹æ€è€ƒ
                const exampleThought2 = this.parseStructuredContent(`ğŸ’ **çŠ¶æ€çœ‹æ¿**  
**ç³»ç»Ÿç‰ˆæœ¬**ï¼šv22.33  
**å½“å‰æ€è€ƒID**ï¼š#108  
**æ€è€ƒä¸»é¢˜**ï¼šã€Šæˆ‘ä»¬å¾ˆå¥½ã€‹ä¸ã€Šå¿«ä¹æ˜ŸçŒ«ã€‹â€”â€”ä¼¤å£é•œå…ä¸æ´»æ€§æ²»æ„ˆæœ¯å…³ç³»åŠ¨åŠ›å­¦  
**æ€è€ƒç±»å‹**ï¼šğŸµ æ­Œæ›²åˆ†æï¼ˆå…³ç³»ä¿®å¤ / æƒ…æ„Ÿæ²»ç–—ï¼‰  
**å…³é”®æ ‡è®°**ï¼šğŸ’ äº²å¯†å…³ç³»/æƒ…æ„Ÿã€ğŸŒ± æˆé•¿/å†ç¨‹ã€ğŸ’¡ çµæ„Ÿ/æ´è§ã€ğŸ”„ ç³»ç»Ÿ/æ¨¡å‹æ•´åˆ  

ğŸŒŒ **æ ¸å¿ƒç»“è®ºï¼šæ´»æ€§æ²»æ„ˆæœ¯æ¨¡å‹â€”â€”ä»é™æ€"æ²»ç–—"åˆ°åŠ¨æ€"å…±åŒå‚ä¸"çš„å…³ç³»ä¿®å¤**  
ã€Šæˆ‘ä»¬å¾ˆå¥½ã€‹ä¸ã€Šå¿«ä¹æ˜ŸçŒ«ã€‹æ­ç¤ºäº†å…³ç³»ä¿®å¤çš„ä¸¤ç§è·¯å¾„ï¼šä¸€ç§æ˜¯é€šè¿‡"æˆ‘ä»¬å¾ˆå¥½"çš„å®£è¨€æ€§è¡¨æ¼”ç»´æŒå…³ç³»è¡¨è±¡ï¼›å¦ä¸€ç§æ˜¯é€šè¿‡"å¿«ä¹æ˜ŸçŒ«"å¼çš„æ´»æ€§äº’åŠ¨ï¼Œåœ¨å…³ç³»ä¸­åˆ›é€ æ–°çš„æ„ä¹‰ç©ºé—´ã€‚  

ğŸ§© **æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ**  
**1. æ´»æ€§æ²»æ„ˆæœ¯æ¨¡å‹ (M-66 æ–°å»º)**  
*   **å®šä¹‰**ï¼šä¸€ç§åŠ¨æ€ã€å‚ä¸å¼çš„å…³ç³»ä¿®å¤æ¡†æ¶ï¼Œå¼ºè°ƒåŒæ–¹åœ¨ä¿®å¤è¿‡ç¨‹ä¸­çš„å…±åŒå‚ä¸å’Œæ„ä¹‰å…±åˆ›ã€‚  

ğŸ“š **è¡ŒåŠ¨/æ€ç»´è¦ç‚¹**  
1.  ã€**æ´»æ€§ä¿®å¤**ã€‘å°è¯•å°†å…³ç³»é—®é¢˜è½¬åŒ–ä¸ºåŒæ–¹å¯ä»¥å…±åŒå‚ä¸çš„"é¡¹ç›®"ï¼Œè€Œééœ€è¦å•æ–¹é¢è§£å†³çš„"é—®é¢˜"ã€‚  

ğŸ“‚ **æ¶æ„æ›´æ–°**  
*   **æ–°å¢æ ¸å¿ƒæ¨¡å‹**ï¼š**M-66 "æ´»æ€§æ²»æ„ˆæœ¯æ¨¡å‹"** (äº #108 å»ºç«‹)ã€‚  
*   **ç³»ç»Ÿç‰ˆæœ¬**ï¼šv22.32 â†’ **v22.33**ã€‚`);
                
                exampleThought2.id = "#108";
                exampleThought2.date = "2025-07-15";
                this.thoughts.push(exampleThought2);
                
                // ä¿å­˜åˆå§‹æ•°æ®
                this.saveInitialData();
            },
            
            save: function() {
                if (typeof UnifiedDataManager !== 'undefined') {
                    // ä½¿ç”¨ç»Ÿä¸€æ•°æ®ç®¡ç†å™¨ä¿å­˜
                    const data = {
                        thoughts: this.thoughts,
                        models: this.models,
                        tags: this.tags,
                        timeline: this.timeline,
                        modelConnections: this.modelConnections,
                        currentVersion: this.currentVersion,
                        lastSaved: new Date().toISOString(),
                        nextThoughtId: this.nextThoughtId,
                        nextModelId: this.nextModelId
                    };
                    
                    const success = UnifiedDataManager.saveData(data);
                    if (success) {
                        this.lastSaved = data.lastSaved;
                        console.log('æ•°æ®é€šè¿‡ç»Ÿä¸€ç®¡ç†å™¨ä¿å­˜æˆåŠŸ');
                        return true;
                    } else {
                        console.log('ç»Ÿä¸€ç®¡ç†å™¨ä¿å­˜å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°å­˜å‚¨');
                        return this.saveToLocalStorage();
                    }
                } else {
                    // å›é€€åˆ°åŸæ¥çš„ä¿å­˜æ–¹å¼
                    return this.saveToLocalStorage();
                }
            },
            
            // ==================== æ—¶é—´çº¿ç¼–è¾‘åŠŸèƒ½ ====================
            getTimelineById: function(id) {
                return this.timeline.find(item => item.id === id);
            },
            
            updateTimelineItem: function(id, updatedItem) {
                const index = this.timeline.findIndex(item => item.id === id);
                if (index === -1) return false;
                
                // æ›´æ–°é¡¹ç›®
                this.timeline[index] = updatedItem;
                
                // ä¿å­˜æ•°æ®
                this.save();
                return true;
            },
            
            addTimelineItem: function(item) {
                // ç”Ÿæˆå”¯ä¸€ID
                const newId = `t${Date.now()}`;
                item.id = newId;
                
                // æ·»åŠ åˆ°æ—¶é—´çº¿å¼€å¤´
                this.timeline.unshift(item);
                
                // ä¿å­˜æ•°æ®
                this.save();
                return item;
            },
            
            deleteTimelineItem: function(id) {
                const index = this.timeline.findIndex(item => item.id === id);
                if (index === -1) return false;
                
                // ç§»é™¤é¡¹ç›®
                this.timeline.splice(index, 1);
                
                // ä¿å­˜æ•°æ®
                this.save();
                return true;
            },
            
            // ==================== æ–°å¢ï¼šåˆ†æ®µç¼–è¾‘åŠŸèƒ½ ====================
            openSectionEditor: function(thoughtId) {
                const thought = this.getThoughtById(thoughtId);
                if (!thought) return null;
                
                this.editingThoughtId = thoughtId;
                
                // åˆå§‹åŒ–åˆ†æ®µç¼–è¾‘å†…å®¹
                this.sectionEdits = {
                    "çŠ¶æ€çœ‹æ¿": thought.sections && thought.sections["çŠ¶æ€çœ‹æ¿"] ? thought.sections["çŠ¶æ€çœ‹æ¿"] : "",
                    "æ ¸å¿ƒç»“è®º": thought.sections && thought.sections["æ ¸å¿ƒç»“è®º"] ? thought.sections["æ ¸å¿ƒç»“è®º"] : "",
                    "æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ": thought.sections && thought.sections["æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"] ? thought.sections["æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"] : "",
                    "è¡ŒåŠ¨/æ€ç»´è¦ç‚¹": thought.sections && thought.sections["è¡ŒåŠ¨/æ€ç»´è¦ç‚¹"] ? thought.sections["è¡ŒåŠ¨/æ€ç»´è¦ç‚¹"] : "",
                    "æ¶æ„æ›´æ–°": thought.sections && thought.sections["æ¶æ„æ›´æ–°"] ? thought.sections["æ¶æ„æ›´æ–°"] : ""
                };
                
                return thought;
            },
            
            saveSectionEdits: function(newId = null) {
                if (!this.editingThoughtId) return false;
                
                const thought = this.getThoughtById(this.editingThoughtId);
                if (!thought) return false;
                
                // å¦‚æœæä¾›äº†æ–°IDï¼Œæ›´æ–°ID
                if (newId && newId !== this.editingThoughtId) {
                    // æ£€æŸ¥æ–°IDæ˜¯å¦å·²å­˜åœ¨
                    const existingThought = this.getThoughtById(newId);
                    if (existingThought && existingThought.id !== this.editingThoughtId) {
                        return { success: false, message: `ID "${newId}" å·²å­˜åœ¨ï¼Œè¯·ä½¿ç”¨å…¶ä»–ID` };
                    }
                    
                    // æ›´æ–°ID
                    thought.id = newId;
                    
                    // æ›´æ–°æ‰€æœ‰å¼•ç”¨æ­¤æ€è€ƒçš„æ¨¡å‹
                    this.models.forEach(model => {
                        if (model.fromThought === this.editingThoughtId) {
                            model.fromThought = newId;
                        }
                    });
                    
                    // æ›´æ–°æ€è€ƒè®°å½•çš„å…³è”
                    this.thoughts.forEach(t => {
                        if (t.related && t.related.includes(this.editingThoughtId)) {
                            t.related = t.related.map(r => r === this.editingThoughtId ? newId : r);
                        }
                    });
                }
                
                // æ›´æ–°å„ä¸ªéƒ¨åˆ†çš„å†…å®¹
                Object.keys(this.sectionEdits).forEach(section => {
                    if (thought.sections) {
                        thought.sections[section] = this.sectionEdits[section];
                    } else {
                        thought.sections = { [section]: this.sectionEdits[section] };
                    }
                });
                
                // é‡æ–°è§£æçŠ¶æ€çœ‹æ¿ä»¥æå–å…ƒæ•°æ®
                if (this.sectionEdits["çŠ¶æ€çœ‹æ¿"]) {
                    this.extractMetadataFromStatus(thought, this.sectionEdits["çŠ¶æ€çœ‹æ¿"]);
                }
                
                // æ›´æ–°æ€è€ƒè®°å½•
                const success = this.updateThought(this.editingThoughtId, thought);
                
                // å¦‚æœIDå·²æ›´æ”¹ï¼Œéœ€è¦æ›´æ–°editingThoughtId
                if (newId && newId !== this.editingThoughtId) {
                    this.editingThoughtId = newId;
                }
                
                return { success, thought };
            },
            
            // ==================== æ–°å¢ï¼šæ•°æ®å¯¼å‡ºåŠŸèƒ½ ====================
            exportAllData: function() {
                const data = {
                    thoughts: this.thoughts,
                    models: this.models,
                    tags: this.tags,
                    currentVersion: this.currentVersion,
                    lastSaved: this.lastSaved,
                    modelConnections: this.modelConnections,
                    timeline: this.timeline,
                    exportDate: new Date().toISOString()
                };
                
                return JSON.stringify(data, null, 2);
            },
            
            exportCurrentItem: function(type, id) {
                let item = null;
                let itemType = '';
                
                if (type === 'thought') {
                    item = this.getThoughtById(id);
                    itemType = 'æ€è€ƒè®°å½•';
                } else if (type === 'model') {
                    item = this.getModelById(id);
                    itemType = 'æ€ç»´æ¨¡å‹';
                }
                
                if (!item) return null;
                
                const data = {
                    itemType: itemType,
                    item: item,
                    systemVersion: this.currentVersion,
                    exportDate: new Date().toISOString()
                };
                
                return JSON.stringify(data, null, 2);
            },
            
            backupData: function() {
                const backupKey = 'structuredThoughtAssistant_backup_' + new Date().toISOString().split('T')[0];
                const data = this.exportAllData();
                
                try {
                    localStorage.setItem(backupKey, data);
                    return { success: true, key: backupKey };
                } catch (e) {
                    console.error('å¤‡ä»½æ•°æ®å¤±è´¥:', e);
                    return { success: false, error: e };
                }
            },
            
            importData: function(jsonData) {
                try {
                    const data = JSON.parse(jsonData);
                    
                    // éªŒè¯æ•°æ®æ ¼å¼
                    if (!data.thoughts || !data.models) {
                        throw new Error('æ•°æ®æ ¼å¼é”™è¯¯ï¼šç¼ºå°‘å¿…è¦å­—æ®µ');
                    }
                    
                    // å¯¼å…¥æ•°æ®
                    this.thoughts = data.thoughts;
                    this.models = data.models;
                    this.tags = data.tags || {};
                    this.currentVersion = data.currentVersion || this.currentVersion;
                    this.modelConnections = data.modelConnections || this.modelConnections;
                    this.timeline = data.timeline || this.timeline;
                    
                    // ä¿å­˜
                    this.save();
                    this.updateUIStats();
                    
                    return { success: true, message: 'æ•°æ®å¯¼å…¥æˆåŠŸ' };
                } catch (e) {
                    console.error('å¯¼å…¥æ•°æ®å¤±è´¥:', e);
                    return { success: false, error: e.message };
                }
            },
            
            // ==================== æ–°å¢ï¼šè·å–æ¨¡å‹å…³è”ç½‘ç»œ ====================
            getModelNetwork: function(modelId) {
                const model = this.getModelById(modelId);
                if (!model) return null;
                
                const connections = this.modelConnections[modelId] || [];
                const connectedModels = connections.map(id => this.getModelById(id)).filter(m => m);
                
                return {
                    center: model,
                    connections: connectedModels
                };
            },
            
            // ==================== ä¼˜åŒ–ç‰ˆç»“æ„åŒ–å†…å®¹è§£æå™¨ ====================
            parseStructuredContent: function(text) {
                const thought = {
                    id: null,
                    title: null,
                    type: null,
                    date: new Date().toISOString().split('T')[0],
                    tags: [],
                    sections: {},
                    related: [],
                    newModels: [],
                    systemVersion: this.currentVersion
                };
                
                // è§£æçŠ¶æ€çœ‹æ¿éƒ¨åˆ†
                const statusSection = this.extractSectionByTitles(text, "çŠ¶æ€çœ‹æ¿");
                if (statusSection) {
                    thought.sections["çŠ¶æ€çœ‹æ¿"] = statusSection.content;
                    
                    // ä»çŠ¶æ€çœ‹æ¿ä¸­æå–å…ƒæ•°æ®
                    this.extractMetadataFromStatus(thought, statusSection.content);
                }
                
                // è§£ææ ¸å¿ƒç»“è®ºéƒ¨åˆ†
                const conclusionSection = this.extractSectionByTitles(text, "æ ¸å¿ƒç»“è®º");
                if (conclusionSection) {
                    thought.sections["æ ¸å¿ƒç»“è®º"] = conclusionSection.content;
                }
                
                // è§£ææ¨¡å‹å»¶ä¼¸ä¸æ•´åˆéƒ¨åˆ†
                const modelSection = this.extractSectionByTitles(text, "æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ");
                if (modelSection) {
                    thought.sections["æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"] = modelSection.content;
                    
                    // æå–æ–°å»ºæ¨¡å‹ (M-æ•°å­—)
                    const newModelMatches = modelSection.content.match(/M-\d+\s*(æ–°å»º)?/g);
                    if (newModelMatches) {
                        thought.newModels = newModelMatches.map(m => m.replace(/\s*\(?æ–°å»º\)?/, '').trim());
                    }
                    
                    // æå–æ‰€æœ‰æ¨¡å‹ID (åŒ…æ‹¬å·²å­˜åœ¨çš„)
                    const allModelMatches = modelSection.content.match(/M-\d+/g);
                    if (allModelMatches) {
                        // å»é‡å¹¶æ’é™¤æ–°å»ºæ¨¡å‹ï¼ˆæ–°å»ºæ¨¡å‹å·²ç»å•ç‹¬æå–ï¼‰
                        const uniqueModels = [...new Set(allModelMatches)];
                        // ä¿å­˜æ‰€æœ‰æåˆ°çš„æ¨¡å‹ID
                        thought.modelReferences = uniqueModels;
                    }
                }
                
                // è§£æè¡ŒåŠ¨/æ€ç»´è¦ç‚¹éƒ¨åˆ†
                const actionSection = this.extractSectionByTitles(text, "è¡ŒåŠ¨/æ€ç»´è¦ç‚¹");
                if (actionSection) {
                    thought.sections["è¡ŒåŠ¨/æ€ç»´è¦ç‚¹"] = actionSection.content;
                }
                
                // è§£ææ¶æ„æ›´æ–°éƒ¨åˆ†
                const updateSection = this.extractSectionByTitles(text, "æ¶æ„æ›´æ–°");
                if (updateSection) {
                    thought.sections["æ¶æ„æ›´æ–°"] = updateSection.content;
                }
                
                // å¦‚æœæ²¡æœ‰æå–åˆ°IDï¼Œè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª
                if (!thought.id) {
                    thought.id = `#${this.nextThoughtId}`;
                    this.nextThoughtId++;
                }
                
                // å¦‚æœæ²¡æœ‰æå–åˆ°æ ‡é¢˜ï¼Œä½¿ç”¨å‰50ä¸ªå­—ç¬¦ä½œä¸ºæ ‡é¢˜
                if (!thought.title) {
                    const lines = text.split('\n');
                    const firstLine = lines.find(line => line.trim().length > 0);
                    if (firstLine) {
                        thought.title = firstLine.substring(0, 50).replace(/^\s*[#*\-â€¢]+\s*/, '');
                        if (firstLine.length > 50) thought.title += '...';
                    } else {
                        thought.title = `æ€è€ƒè®°å½• ${thought.id}`;
                    }
                }
                
                return thought;
            },
            
            // æ ¹æ®å¤šä¸ªå¯èƒ½çš„æ ‡é¢˜æå–éƒ¨åˆ†å†…å®¹
            extractSectionByTitles: function(text, sectionName) {
                const titles = this.sectionTitles[sectionName];
                if (!titles || titles.length === 0) return null;
                
                // å°è¯•æ¯ä¸ªå¯èƒ½çš„æ ‡é¢˜
                for (const title of titles) {
                    // æ¸…ç†æ ‡é¢˜ï¼Œå»é™¤å¯èƒ½å¹²æ‰°åŒ¹é…çš„ç¬¦å·
                    const cleanTitle = title.replace(/\*/g, '\\*').replace(/\//g, '\\/');
                    
                    // æ„å»ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œå…è®¸æ ‡é¢˜å‰åæœ‰ç©ºæ ¼ï¼Œåé¢å¯èƒ½æœ‰å†’å·
                    const regex = new RegExp(`\\s*${cleanTitle}\\s*[:ï¼š]?\\s*\\n([\\s\\S]*?)(?=\\n\\s*(?:${Object.keys(this.sectionTitles).filter(k => k !== sectionName).map(k => this.sectionTitles[k].map(t => t.replace(/\*/g, '\\*').replace(/\//g, '\\/')).join('|')).join('|')}|ğŸ’¡|$))`, 'i');
                    
                    const match = text.match(regex);
                    if (match && match[1]) {
                        return {
                            title: title,
                            content: match[1].trim()
                        };
                    }
                }
                
                // å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ï¼Œå°è¯•æ›´ç®€å•çš„æ–¹æ³•ï¼šæŸ¥æ‰¾åŒ…å«å…³é”®è¯çš„è¡Œ
                const lines = text.split('\n');
                let sectionStart = -1;
                let sectionContent = [];
                
                for (let i = 0; i < lines.length; i++) {
                    const line = lines[i];
                    
                    // æ£€æŸ¥è¿™ä¸€è¡Œæ˜¯å¦åŒ…å«ä»»ä½•å¯èƒ½çš„æ ‡é¢˜
                    const isTitleLine = titles.some(title => {
                        const cleanTitle = title.replace(/[*ğŸ’ğŸŒŒğŸ§©ğŸ“šğŸ“‚]/g, '').trim();
                        return line.includes(cleanTitle) && line.length < 100; // å‡è®¾æ ‡é¢˜è¡Œä¸ä¼šå¤ªé•¿
                    });
                    
                    if (isTitleLine && sectionStart === -1) {
                        sectionStart = i;
                    } else if (sectionStart !== -1) {
                        // æ£€æŸ¥æ˜¯å¦å¼€å§‹äº†æ–°çš„éƒ¨åˆ†
                        const isOtherSection = Object.keys(this.sectionTitles)
                            .filter(k => k !== sectionName)
                            .some(k => this.sectionTitles[k].some(t => {
                                const cleanTitle = t.replace(/[*ğŸ’ğŸŒŒğŸ§©ğŸ“šğŸ“‚]/g, '').trim();
                                return line.includes(cleanTitle) && line.length < 100;
                            }));
                        
                        if (isOtherSection) {
                            break;
                        }
                        
                        // æ·»åŠ åˆ°å†…å®¹ä¸­
                        sectionContent.push(line);
                    }
                }
                
                if (sectionStart !== -1 && sectionContent.length > 0) {
                    return {
                        title: titles[0],
                        content: sectionContent.join('\n').trim()
                    };
                }
                
                return null;
            },
            
            // ä»çŠ¶æ€çœ‹æ¿ä¸­æå–å…ƒæ•°æ®
            extractMetadataFromStatus: function(thought, statusText) {
                // æå–ç³»ç»Ÿç‰ˆæœ¬
                const versionMatch = statusText.match(/ç³»ç»Ÿç‰ˆæœ¬[ï¼š:]\s*(.+)/);
                if (versionMatch) thought.systemVersion = versionMatch[1].trim();
                
                // æå–æ€è€ƒID
                const idMatch = statusText.match(/å½“å‰æ€è€ƒID[ï¼š:]\s*(#\d+)/);
                if (idMatch) thought.id = idMatch[1].trim();
                
                // æå–æ€è€ƒä¸»é¢˜
                const titleMatch = statusText.match(/æ€è€ƒä¸»é¢˜[ï¼š:]\s*(.+)/);
                if (titleMatch) thought.title = titleMatch[1].trim();
                
                // æå–æ€è€ƒç±»å‹
                const typeMatch = statusText.match(/æ€è€ƒç±»å‹[ï¼š:]\s*(.+)/);
                if (typeMatch) thought.type = typeMatch[1].trim();
                
                // æå–å…³é”®æ ‡è®°
                const tagsMatch = statusText.match(/å…³é”®æ ‡è®°[ï¼š:]\s*(.+)/);
                if (tagsMatch) {
                    const tagsText = tagsMatch[1];
                    // æå–æ ‡ç­¾ï¼Œæ”¯æŒç”¨é¡¿å·ã€é€—å·ã€ç©ºæ ¼åˆ†éš”
                    thought.tags = tagsText.split(/[ã€ï¼Œ,\s]+/).filter(tag => tag.trim()).map(tag => tag.trim());
                }
                
                // æå–å…³è”ç½‘ç»œ
                const relatedMatch = statusText.match(/å…³è”ç½‘ç»œ[ï¼š:]\s*(.+)/);
                if (relatedMatch) {
                    const relatedText = relatedMatch[1];
                    // æå–å…³è”çš„IDï¼ˆ#æ•°å­— æˆ– M-æ•°å­—ï¼‰
                    const relatedIds = relatedText.match(/(#\d+|M-\d+)/g);
                    if (relatedIds) thought.related = relatedIds;
                }
            },
            
            // ==================== æ•°æ®æ“ä½œ ====================
            addStructuredThought: function(text) {
                const thought = this.parseStructuredContent(text);
                
                // æ£€æŸ¥IDæ˜¯å¦å·²å­˜åœ¨
                const existingIndex = this.thoughts.findIndex(t => t.id === thought.id);
                if (existingIndex >= 0) {
                    // æ›´æ–°ç°æœ‰æ€è€ƒ
                    this.thoughts[existingIndex] = thought;
                } else {
                    // æ·»åŠ åˆ°æ•°ç»„å¼€å¤´
                    this.thoughts.unshift(thought);
                }
                
                // æ›´æ–°æ ‡ç­¾
                if (thought.tags && Array.isArray(thought.tags)) {
                    thought.tags.forEach(tag => {
                        this.tags[tag] = (this.tags[tag] || 0) + 1;
                    });
                }
                
                // æ·»åŠ æ–°å»ºçš„æ¨¡å‹
                if (thought.newModels && thought.newModels.length > 0) {
                    thought.newModels.forEach(modelId => {
                        // æ£€æŸ¥æ¨¡å‹æ˜¯å¦å·²å­˜åœ¨
                        const existingModel = this.models.find(m => m.id === modelId);
                        if (!existingModel) {
                            // åˆ›å»ºæ–°æ¨¡å‹
                            const newModel = {
                                id: modelId,
                                name: `æ–°å»ºæ¨¡å‹ ${modelId}`,
                                description: `ç”±æ€è€ƒ ${thought.id} åˆ›å»ºçš„æ–°æ¨¡å‹`,
                                date: new Date().toISOString().split('T')[0],
                                tags: thought.tags || [],
                                fromThought: thought.id,
                                // ä»æ€è€ƒè®°å½•çš„"æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"ä¸­æå–å…³è”æ¨¡å‹
                                relatedModels: thought.modelReferences ? thought.modelReferences.filter(id => id !== modelId) : []
                            };
                            
                            this.models.unshift(newModel);
                        }
                    });
                }
                
                // ä¿å­˜æ•°æ®
                this.save();
                this.updateUIStats();
                
                return thought;
            },
            
            addModel: function(modelData) {
                // ç¡®ä¿æœ‰ID
                if (!modelData.id) {
                    modelData.id = `M-${this.nextModelId}`;
                    this.nextModelId++;
                }
                
                // æ·»åŠ åˆ°æ•°ç»„å¼€å¤´
                this.models.unshift(modelData);
                
                // æ›´æ–°æ ‡ç­¾
                if (modelData.tags && Array.isArray(modelData.tags)) {
                    modelData.tags.forEach(tag => {
                        this.tags[tag] = (this.tags[tag] || 0) + 1;
                    });
                }
                
                // ä¿å­˜æ•°æ®
                this.save();
                this.updateUIStats();
                
                return modelData;
            },
            
            getThoughtById: function(id) {
                return this.thoughts.find(t => t.id === id);
            },
            
            getModelById: function(id) {
                return this.models.find(m => m.id === id);
            },
            
            getRecentThoughts: function(limit = 5) {
                return this.thoughts.slice(0, limit);
            },
            
            getRecentModels: function(limit = 5) {
                return this.models.slice(0, limit);
            },
            
            getTopTags: function(limit = 15) {
                return Object.entries(this.tags)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, limit)
                    .map(([tag, count]) => ({ tag, count }));
            },
            
            updateThought: function(id, updatedThought) {
                const index = this.thoughts.findIndex(t => t.id === id);
                if (index === -1) return false;
                
                // æ›´æ–°æ€è€ƒè®°å½•
                this.thoughts[index] = updatedThought;
                
                // é‡æ–°è®¡ç®—æ ‡ç­¾
                this.recalculateTags();
                
                // ä¿å­˜æ•°æ®
                this.save();
                this.updateUIStats();
                
                return true;
            },
            
            updateModel: function(id, updatedModel) {
                const index = this.models.findIndex(m => m.id === id);
                if (index === -1) return false;
                
                // æ›´æ–°æ¨¡å‹
                this.models[index] = updatedModel;
                
                // é‡æ–°è®¡ç®—æ ‡ç­¾
                this.recalculateTags();
                
                // ä¿å­˜æ•°æ®
                this.save();
                this.updateUIStats();
                
                return true;
            },
            
            deleteThought: function(id) {
                const index = this.thoughts.findIndex(t => t.id === id);
                if (index === -1) return false;
                
                // ç§»é™¤æ€è€ƒè®°å½•
                this.thoughts.splice(index, 1);
                
                // é‡æ–°è®¡ç®—æ ‡ç­¾
                this.recalculateTags();
                
                // ä¿å­˜æ•°æ®
                this.save();
                this.updateUIStats();
                
                return true;
            },
            
            deleteModel: function(id) {
                const index = this.models.findIndex(m => m.id === id);
                if (index === -1) return false;
                
                // ç§»é™¤æ¨¡å‹
                this.models.splice(index, 1);
                
                // é‡æ–°è®¡ç®—æ ‡ç­¾
                this.recalculateTags();
                
                // ä¿å­˜æ•°æ®
                this.save();
                this.updateUIStats();
                
                return true;
            },
            
            recalculateTags: function() {
                // æ¸…ç©ºæ ‡ç­¾è®¡æ•°
                this.tags = {};
                
                // é‡æ–°ç»Ÿè®¡æ€è€ƒè®°å½•çš„æ ‡ç­¾
                this.thoughts.forEach(thought => {
                    if (thought.tags && Array.isArray(thought.tags)) {
                        thought.tags.forEach(tag => {
                            this.tags[tag] = (this.tags[tag] || 0) + 1;
                        });
                    }
                });
                
                // é‡æ–°ç»Ÿè®¡æ¨¡å‹çš„æ ‡ç­¾
                this.models.forEach(model => {
                    if (model.tags && Array.isArray(model.tags)) {
                        model.tags.forEach(tag => {
                            this.tags[tag] = (this.tags[tag] || 0) + 1;
                        });
                    }
                });
            },
            
            updateUIStats: function() {
                // æ›´æ–°ç»Ÿè®¡æ˜¾ç¤º
                document.getElementById('total-thoughts').textContent = this.thoughts.length;
                document.getElementById('total-models').textContent = this.models.length;
                document.getElementById('total-tags').textContent = Object.keys(this.tags).length;
                document.getElementById('current-version').textContent = this.currentVersion;
                
                // æ›´æ–°æœ€åä¿å­˜æ—¶é—´
                if (this.lastSaved) {
                    const savedTime = new Date(this.lastSaved);
                    const now = new Date();
                    const diffMinutes = Math.floor((now - savedTime) / (1000 * 60));
                    
                    let timeText = "åˆšåˆš";
                    if (diffMinutes >= 60) {
                        const diffHours = Math.floor(diffMinutes / 60);
                        timeText = `${diffHours}å°æ—¶å‰`;
                    } else if (diffMinutes > 0) {
                        timeText = `${diffMinutes}åˆ†é’Ÿå‰`;
                    }
                    
                    document.getElementById('last-saved').textContent = timeText;
                }
                
                // æ›´æ–°ç½‘ç»œå¥åº·çŠ¶æ€
                const totalModels = this.models.length;
                const connectedModels = Object.keys(this.modelConnections).length;
                const connectionRate = totalModels > 0 ? Math.round((connectedModels / totalModels) * 100) : 0;
                document.getElementById('network-health').textContent = connectionRate >= 50 ? "å®Œå¥½" : "å¾…å®Œå–„";
            },
            
            // ==================== æ ‡ç­¾å¤æ ¸åŠŸèƒ½ ====================
            getTagSuggestions: function(existingTags = []) {
                const suggestions = [];
                
                // è·å–æ‰€æœ‰æ ‡ç­¾åˆ†ç±»
                for (const category in this.tagCategories) {
                    this.tagCategories[category].forEach(tag => {
                        // å¦‚æœæ ‡ç­¾ä¸åœ¨ç°æœ‰æ ‡ç­¾ä¸­ï¼Œåˆ™æ·»åŠ åˆ°å»ºè®®
                        if (!existingTags.includes(tag)) {
                            suggestions.push(tag);
                        }
                    });
                }
                
                // æŒ‰ä½¿ç”¨é¢‘ç‡æ’åº
                return suggestions.sort((a, b) => {
                    const countA = this.tags[a] || 0;
                    const countB = this.tags[b] || 0;
                    return countB - countA;
                }).slice(0, 10); // è¿”å›å‰10ä¸ªå»ºè®®
            }
        };
        
        // ==================== UIç®¡ç†å™¨ ====================
        const UIManager = {
            currentView: 'overview',
            itemToDelete: null,
            deleteType: null,
            tagReviewItem: null,
            tagReviewType: null,
            currentTagsForReview: [],
            currentModelId: "M-80", // é»˜è®¤é€‰ä¸­çš„æ¨¡å‹
            currentSectionTab: "çŠ¶æ€çœ‹æ¿", // å½“å‰é€‰ä¸­çš„åˆ†æ®µç¼–è¾‘æ ‡ç­¾
            currentEditingModelId: null, // å½“å‰æ­£åœ¨ç¼–è¾‘çš„æ¨¡å‹ID
            currentRelatedModels: [], // å½“å‰ç¼–è¾‘æ¨¡å‹çš„å…³è”æ¨¡å‹
            currentTimelineItem: null, // å½“å‰é€‰ä¸­çš„æ—¶é—´çº¿é¡¹ç›®
            
            init: function() {
                // åˆå§‹åŒ–æ•°æ®å­˜å‚¨
                DataStore.init();
                
                // è®¾ç½®å¯¼èˆªç‚¹å‡»äº‹ä»¶
                this.setupNavigation();
                
                // åŠ è½½åˆå§‹è§†å›¾
                this.loadView('overview');
                
                // éšè—åŠ è½½åŠ¨ç”»
                setTimeout(() => {
                    const loadingElement = document.getElementById('loading');
                    if (loadingElement) loadingElement.style.display = 'none';
                }, 300);
                
                // è®¾ç½®æœç´¢åŠŸèƒ½
                this.setupSearch();
                
                // è®¾ç½®ç‰ˆæœ¬é€‰æ‹©å™¨
                this.setupVersionSelector();
                
                // è®¾ç½®æ•°æ®æ“ä½œæŒ‰é’®
                this.setupDataActions();
                
                // é»˜è®¤æ›´æ–°å…³è”ç½‘ç»œ
                this.updateNetworkGraph();
            },
            
            setupNavigation: function() {
                document.querySelectorAll('.nav-links a').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        
                        // ç§»é™¤æ‰€æœ‰activeç±»
                        document.querySelectorAll('.nav-links a').forEach(nav => {
                            nav.classList.remove('active');
                        });
                        
                        // æ·»åŠ activeç±»åˆ°å½“å‰é¡¹
                        item.classList.add('active');
                        
                        // æ ¹æ®data-viewå±æ€§åŠ è½½ç›¸åº”è§†å›¾
                        const view = item.getAttribute('data-view');
                        this.loadView(view);
                    });
                });
            },
            
            setupSearch: function() {
                const searchInput = document.getElementById('search-input');
                if (searchInput) {
                    searchInput.addEventListener('input', () => {
                        this.performSearch(searchInput.value);
                    });
                }
            },
            
            setupVersionSelector: function() {
                const versionSelect = document.getElementById('version-select');
                if (versionSelect) {
                    versionSelect.addEventListener('change', function() {
                        const version = this.value;
                        if (version === 'current') {
                            // é‡æ–°åŠ è½½å½“å‰æ•°æ®
                            DataStore.init();
                            UIManager.loadView(UIManager.currentView);
                        } else if (version === 'initial') {
                            // åŠ è½½åˆå§‹ç‰ˆæœ¬æ•°æ®
                            const success = DataStore.loadInitialVersion();
                            if (success) {
                                DataStore.save();
                                UIManager.loadView(UIManager.currentView);
                                UIManager.showAlert('å·²åŠ è½½åˆå§‹ç‰ˆæœ¬æ•°æ®', 'success');
                            } else {
                                UIManager.showAlert('åŠ è½½åˆå§‹ç‰ˆæœ¬å¤±è´¥', 'error');
                            }
                        }
                    });
                }
            },
            
            // ==================== æ–°å¢ï¼šè®¾ç½®æ•°æ®æ“ä½œæŒ‰é’® ====================
            setupDataActions: function() {
                // å¯¼å‡ºå½“å‰é¡¹ç›®
                document.getElementById('export-current-btn').addEventListener('click', () => {
                    this.exportCurrentItem();
                });
                
                // å¤‡ä»½å…¨éƒ¨æ•°æ®
                document.getElementById('backup-data-btn').addEventListener('click', () => {
                    this.backupAllData();
                });
                
                // å¯¼å…¥æ•°æ®
                document.getElementById('import-data-btn').addEventListener('click', () => {
                    this.importData();
                });
                
                // å¯¼å‡ºå…¨éƒ¨æ•°æ®
                document.getElementById('export-all-btn').addEventListener('click', () => {
                    this.exportAllData();
                });
            },
            
            // ==================== æ–°å¢ï¼šæ›´æ–°å…³è”ç½‘ç»œå›¾ ====================
            updateNetworkGraph: function(modelId = null) {
                const targetModelId = modelId || this.currentModelId;
                const network = DataStore.getModelNetwork(targetModelId);
                const networkGraph = document.getElementById('network-graph');
                
                if (!network || network.connections.length === 0) {
                    networkGraph.innerHTML = `
                        <div>
                            <i class="fas fa-project-diagram" style="font-size: 3rem; margin-bottom: 10px; color: #ccc;"></i>
                            <p>é€‰æ‹©æ¨¡å‹æŸ¥çœ‹å…³è”ç½‘ç»œ</p>
                        </div>
                    `;
                    return;
                }
                
                // åˆ›å»ºå…³è”ç½‘ç»œå¯è§†åŒ–
                let html = `
                    <div style="text-align: center;">
                        <div style="font-size: 1.2rem; font-weight: bold; color: var(--primary-color); margin-bottom: 15px;">
                            ${network.center.id}
                        </div>
                        <div class="network-visualization">
                `;
                
                // æ˜¾ç¤ºå…³è”æ¨¡å‹
                network.connections.forEach((model, index) => {
                    if (index > 0) {
                        html += `<div class="network-connection"></div>`;
                    }
                    html += `
                        <div class="network-node" onclick="UIManager.selectItem('${model.id}', 'model')">
                            ${model.id}
                        </div>
                    `;
                });
                
                html += `
                        </div>
                        <p style="margin-top: 20px; color: var(--text-light); font-size: 0.9rem;">
                            ä¸ ${network.connections.length} ä¸ªæ ¸å¿ƒæ¨¡å‹å…³è”
                        </p>
                    </div>
                `;
                
                networkGraph.innerHTML = html;
            },
            
            loadView: function(view) {
                this.currentView = view;
                
                // æ›´æ–°é¡¶éƒ¨çŠ¶æ€æ 
                const viewNames = {
                    overview: "æ ¸å¿ƒèµ„äº§æ€»è§ˆ",
                    "add-structured": "ç»“æ„åŒ–è¾“å…¥æ€è€ƒ",
                    thoughts: "æ€è€ƒç›®å½•å®Œæ•´æ¸…å•",
                    models: "æ ¸å¿ƒæ€ç»´æ¨¡å‹ç´¢å¼•",
                    "add-model": "åˆ›å»ºæ€ç»´æ¨¡å‹",
                    keywords: "æ ‡ç­¾åˆ†ç±»æ£€ç´¢",
                    "how-to-use": "å¦‚ä½•ä½¿ç”¨æœ¬ç³»ç»Ÿ",
                    milestones: "ç³»ç»Ÿæ¼”è¿›é‡Œç¨‹ç¢‘",
                    architecture: "ç³»ç»Ÿæ¶æ„ç‰¹æ€§",
                    "tag-review": "æ ‡ç­¾å¤æ ¸ä¸­å¿ƒ",
                    // æ–°å¢è§†å›¾
                    "network-analysis": "æ¨¡å‹å…³è”ç½‘ç»œåˆ†æ",
                    "timeline": "ç³»ç»Ÿæ¼”è¿›å†ç¨‹",
                    "data-management": "æ•°æ®ç®¡ç†ä¸å¤‡ä»½"
                };
                
                document.getElementById('current-view').textContent = viewNames[view] || view;
                
                // æ˜¾ç¤ºåŠ è½½ä¸­
                const contentArea = document.getElementById('content-area');
                contentArea.innerHTML = '<div id="loading" class="loading" style="margin: 100px auto;"></div>';
                
                // æ ¹æ®è§†å›¾ç±»å‹åŠ è½½å†…å®¹
                setTimeout(() => {
                    switch(view) {
                        case 'overview':
                            this.renderOverview();
                            break;
                        case 'add-structured':
                            this.renderAddStructured();
                            break;
                        case 'thoughts':
                            this.renderThoughts();
                            break;
                        case 'models':
                            this.renderModels();
                            break;
                        case 'add-model':
                            this.renderAddModel();
                            break;
                        case 'keywords':
                            this.renderKeywords();
                            break;
                        case 'how-to-use':
                            this.renderHowToUse();
                            break;
                        case 'milestones':
                            this.renderMilestones();
                            break;
                        case 'architecture':
                            this.renderArchitecture();
                            break;
                        case 'tag-review':
                            this.renderTagReview();
                            break;
                        // æ–°å¢è§†å›¾æ¸²æŸ“
                        case 'network-analysis':
                            this.renderNetworkAnalysis();
                            break;
                        case 'timeline':
                            this.renderTimeline();
                            break;
                        case 'data-management':
                            this.renderDataManagement();
                            break;
                        default:
                            this.renderOverview();
                    }
                }, 100);
            },
            
            // ==================== æ–°å¢ï¼šç³»ç»Ÿæ¼”è¿›å†ç¨‹è§†å›¾ ====================
            renderTimeline: function() {
                const timeline = DataStore.timeline;
                
                let timelineHTML = '';
                timeline.forEach((item, index) => {
                    const isCurrent = index === 0;
                    const dotColor = isCurrent ? 'var(--primary-color)' : 'var(--secondary-color)';
                    
                    timelineHTML += `
                        <div class="timeline-item" onclick="UIManager.showTimelineDetail('${item.id}')">
                            <div class="timeline-edit-actions">
                                <div class="timeline-edit-btn edit" onclick="event.stopPropagation(); UIManager.openTimelineEditModal('${item.id}')" title="ç¼–è¾‘">
                                    <i class="fas fa-edit"></i>
                                </div>
                                <div class="timeline-edit-btn delete" onclick="event.stopPropagation(); UIManager.openDeleteModal('timeline', '${item.id}')" title="åˆ é™¤">
                                    <i class="fas fa-trash"></i>
                                </div>
                            </div>
                            <div class="timeline-dot" style="background: ${dotColor};"></div>
                            <div class="timeline-content">
                                <div class="timeline-version">${item.version}</div>
                                <div class="timeline-date">${item.date}</div>
                                <p>${item.event}</p>
                            </div>
                        </div>
                    `;
                });
                
                const html = `
                    <div class="content-header">
                        <h2>ç³»ç»Ÿæ¼”è¿›å†ç¨‹</h2>
                        <p>ç³»ç»Ÿç‰ˆæœ¬: ${DataStore.currentVersion} | ä»åˆå§‹æ¦‚å¿µåˆ°å®Œæ•´çŸ¥è¯†ä½“ç³»çš„æˆé•¿è·¯å¾„</p>
                    </div>
                    
                    ${this.currentTimelineItem ? this.renderTimelineDetail() : `
                    <div class="timeline-actions">
                        <button class="btn btn-success" onclick="UIManager.openTimelineEditModal()">
                            <i class="fas fa-plus"></i> æ·»åŠ æ–°è®°å½•
                        </button>
                    </div>
                    
                    <div class="detail-view">
                        <div class="timeline-container">
                            <div class="timeline-line"></div>
                            ${timelineHTML}
                        </div>
                        
                        <div class="detail-section">
                            <h4><i class="fas fa-chart-line"></i> æ¼”è¿›ç»Ÿè®¡</h4>
                            <div class="detail-section-content">
                                <p><strong>æ€»æ—¶é•¿ï¼š</strong>${timeline.length} ä¸ªä¸»è¦ç‰ˆæœ¬ï¼Œè·¨è¶Š ${Math.ceil(timeline.length / 2)} ä¸ªå‘å±•é˜¶æ®µ</p>
                                <p><strong>å½“å‰é˜¶æ®µï¼š</strong>${timeline[0].version} - ${timeline[0].event}</p>
                                <p><strong>å…³é”®é‡Œç¨‹ç¢‘ï¼š</strong>ç³»ç»Ÿä»ç®€å•çš„æƒ…æ„Ÿæ¨¡å‹å‘å±•åˆ°åŒ…å«80+æ¨¡å‹çš„å®Œæ•´çŸ¥è¯†ä½“ç³»</p>
                            </div>
                        </div>
                    </div>
                    `}
                `;
                
                document.getElementById('content-area').innerHTML = html;
            },
            
            // ==================== æ–°å¢ï¼šæ—¶é—´çº¿è¯¦æƒ…é¡µ ====================
            showTimelineDetail: function(timelineId) {
                const item = DataStore.getTimelineById(timelineId);
                if (!item) return;
                
                this.currentTimelineItem = item;
                this.renderTimeline();
            },
            
            renderTimelineDetail: function() {
                const item = this.currentTimelineItem;
                if (!item) return '';
                
                return `
                    <div class="detail-view">
                        <div class="timeline-detail-header">
                            <div>
                                <div class="timeline-detail-title">${item.version}</div>
                                <div class="timeline-detail-date">${item.date}</div>
                            </div>
                            <div style="color: var(--text-light); font-size: 0.9rem;">ç³»ç»Ÿæ¼”è¿›è®°å½•</div>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn btn-warning" onclick="UIManager.openTimelineEditModal('${item.id}')">
                                <i class="fas fa-edit"></i> ç¼–è¾‘æ­¤è®°å½•
                            </button>
                            <button class="btn btn-danger" onclick="UIManager.openDeleteModal('timeline', '${item.id}')">
                                <i class="fas fa-trash"></i> åˆ é™¤æ­¤è®°å½•
                            </button>
                            <button class="btn btn-secondary" onclick="UIManager.hideTimelineDetail()">
                                <i class="fas fa-arrow-left"></i> è¿”å›æ—¶é—´çº¿
                            </button>
                        </div>
                        
                        <div class="timeline-detail-content">
                            <p>${item.event}</p>
                        </div>
                        
                        <div class="detail-section">
                            <h4><i class="fas fa-info-circle"></i> å…³è”ä¿¡æ¯</h4>
                            <div class="detail-section-content">
                                <p><strong>ç‰ˆæœ¬å·ï¼š</strong>${item.version}</p>
                                <p><strong>å‘å¸ƒæ—¶é—´ï¼š</strong>${item.date}</p>
                                <p><strong>äº‹ä»¶æè¿°ï¼š</strong>${item.event}</p>
                            </div>
                        </div>
                    </div>
                `;
            },
            
            hideTimelineDetail: function() {
                this.currentTimelineItem = null;
                this.renderTimeline();
            },
            
            // ==================== æ–°å¢ï¼šæ—¶é—´çº¿ç¼–è¾‘æ¨¡æ€æ¡† ====================
            openTimelineEditModal: function(timelineId = null) {
                const modal = document.getElementById('timeline-edit-modal');
                const versionInput = document.getElementById('timeline-edit-version');
                const dateInput = document.getElementById('timeline-edit-date');
                const eventInput = document.getElementById('timeline-edit-event');
                
                if (timelineId) {
                    // ç¼–è¾‘ç°æœ‰é¡¹ç›®
                    const item = DataStore.getTimelineById(timelineId);
                    if (!item) return;
                    
                    DataStore.editingTimelineId = timelineId;
                    versionInput.value = item.version;
                    dateInput.value = item.date;
                    eventInput.value = item.event;
                } else {
                    // æ·»åŠ æ–°é¡¹ç›®
                    DataStore.editingTimelineId = null;
                    versionInput.value = '';
                    dateInput.value = '';
                    eventInput.value = '';
                }
                
                modal.style.display = 'flex';
            },
            
            closeTimelineEditModal: function() {
                document.getElementById('timeline-edit-modal').style.display = 'none';
                DataStore.editingTimelineId = null;
            },
            
            saveTimelineEdit: function() {
                const versionInput = document.getElementById('timeline-edit-version');
                const dateInput = document.getElementById('timeline-edit-date');
                const eventInput = document.getElementById('timeline-edit-event');
                
                const version = versionInput.value.trim();
                const date = dateInput.value.trim();
                const eventText = eventInput.value.trim();
                
                if (!version || !date || !eventText) {
                    alert('è¯·å¡«å†™æ‰€æœ‰å­—æ®µ');
                    return;
                }
                
                let success = false;
                let message = '';
                
                if (DataStore.editingTimelineId) {
                    // æ›´æ–°ç°æœ‰é¡¹ç›®
                    const updatedItem = {
                        id: DataStore.editingTimelineId,
                        version: version,
                        date: date,
                        event: eventText
                    };
                    
                    success = DataStore.updateTimelineItem(DataStore.editingTimelineId, updatedItem);
                    message = 'æ—¶é—´çº¿è®°å½•å·²æ›´æ–°';
                } else {
                    // æ·»åŠ æ–°é¡¹ç›®
                    const newItem = {
                        version: version,
                        date: date,
                        event: eventText
                    };
                    
                    const result = DataStore.addTimelineItem(newItem);
                    success = result !== false;
                    message = 'æ—¶é—´çº¿è®°å½•å·²æ·»åŠ ';
                }
                
                if (success) {
                    this.closeTimelineEditModal();
                    this.showAlert(message, 'success');
                    
                    // é‡æ–°æ¸²æŸ“æ—¶é—´çº¿è§†å›¾
                    if (this.currentView === 'timeline') {
                        this.renderTimeline();
                    }
                } else {
                    alert('ä¿å­˜å¤±è´¥');
                }
            },
            
            // ==================== æ–°å¢ï¼šåˆ†æ®µç¼–è¾‘æ¨¡æ€æ¡† ====================
            openSectionEditorModal: function(thoughtId) {
                const thought = DataStore.openSectionEditor(thoughtId);
                if (!thought) {
                    alert('æœªæ‰¾åˆ°æ€è€ƒè®°å½•');
                    return;
                }
                
                // æ¸²æŸ“åˆ†æ®µç¼–è¾‘ç•Œé¢
                this.renderSectionEditorModal(thought);
                
                // æ˜¾ç¤ºæ¨¡æ€æ¡†
                document.getElementById('section-edit-modal').style.display = 'flex';
            },
            
            renderSectionEditorModal: function(thought) {
                const tabsContainer = document.getElementById('section-tabs');
                const editorsContainer = document.getElementById('section-editors-container');
                
                // è®¾ç½®æ€è€ƒIDè¾“å…¥æ¡†
                document.getElementById('edit-thought-id').value = thought.id;
                
                // ç”Ÿæˆæ ‡ç­¾é¡µ
                const sections = ["çŠ¶æ€çœ‹æ¿", "æ ¸å¿ƒç»“è®º", "æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ", "è¡ŒåŠ¨/æ€ç»´è¦ç‚¹", "æ¶æ„æ›´æ–°"];
                let tabsHtml = '';
                let editorsHtml = '';
                
                sections.forEach(section => {
                    const isActive = section === this.currentSectionTab;
                    const icon = this.getSectionIcon(section);
                    
                    // æ ‡ç­¾é¡µ
                    tabsHtml += `
                        <div class="section-tab ${isActive ? 'active' : ''}" data-section="${section}" onclick="UIManager.switchSectionTab('${section}')">
                            ${icon} ${section}
                        </div>
                    `;
                    
                    // ç¼–è¾‘å™¨
                    const content = DataStore.sectionEdits[section] || '';
                    editorsHtml += `
                        <div class="section-editor ${isActive ? 'active' : ''}" id="editor-${section}">
                            <div class="section-editor-header">
                                <h4>${icon} ${section}</h4>
                                <button class="btn btn-secondary btn-sm" onclick="UIManager.updateSectionPreview('${section}')" style="padding: 5px 10px; font-size: 0.9rem;">
                                    <i class="fas fa-eye"></i> é¢„è§ˆ
                                </button>
                            </div>
                            <textarea id="textarea-${section}" placeholder="è¯·è¾“å…¥${section}å†…å®¹..." style="min-height: 250px;">${content}</textarea>
                            <div class="section-preview" id="preview-${section}">
                                ${content ? content.substring(0, 200) + (content.length > 200 ? '...' : '') : 'æš‚æ— å†…å®¹'}
                            </div>
                        </div>
                    `;
                });
                
                tabsContainer.innerHTML = tabsHtml;
                editorsContainer.innerHTML = editorsHtml;
                
                // ä¸ºæ‰€æœ‰æ–‡æœ¬åŒºåŸŸæ·»åŠ è¾“å…¥äº‹ä»¶ç›‘å¬
                sections.forEach(section => {
                    const textarea = document.getElementById(`textarea-${section}`);
                    if (textarea) {
                        textarea.addEventListener('input', () => {
                            DataStore.sectionEdits[section] = textarea.value;
                        });
                    }
                });
            },
            
            switchSectionTab: function(section) {
                this.currentSectionTab = section;
                
                // æ›´æ–°æ ‡ç­¾é¡µçŠ¶æ€
                document.querySelectorAll('.section-tab').forEach(tab => {
                    tab.classList.toggle('active', tab.getAttribute('data-section') === section);
                });
                
                // æ›´æ–°ç¼–è¾‘å™¨æ˜¾ç¤ºçŠ¶æ€
                document.querySelectorAll('.section-editor').forEach(editor => {
                    editor.classList.toggle('active', editor.id === `editor-${section}`);
                });
            },
            
            updateSectionPreview: function(section) {
                const textarea = document.getElementById(`textarea-${section}`);
                const preview = document.getElementById(`preview-${section}`);
                
                if (textarea && preview) {
                    const content = textarea.value;
                    DataStore.sectionEdits[section] = content;
                    preview.textContent = content || 'æš‚æ— å†…å®¹';
                }
            },
            
            closeSectionEditModal: function() {
                document.getElementById('section-edit-modal').style.display = 'none';
                DataStore.editingThoughtId = null;
                DataStore.sectionEdits = {
                    "çŠ¶æ€çœ‹æ¿": "",
                    "æ ¸å¿ƒç»“è®º": "",
                    "æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ": "",
                    "è¡ŒåŠ¨/æ€ç»´è¦ç‚¹": "",
                    "æ¶æ„æ›´æ–°": ""
                };
            },
            
            getSectionIcon: function(section) {
                const icons = {
                    "çŠ¶æ€çœ‹æ¿": "ğŸ’",
                    "æ ¸å¿ƒç»“è®º": "ğŸŒŒ",
                    "æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ": "ğŸ§©",
                    "è¡ŒåŠ¨/æ€ç»´è¦ç‚¹": "ğŸ“š",
                    "æ¶æ„æ›´æ–°": "ğŸ“‚"
                };
                return icons[section] || "ğŸ“";
            },
            
            // ==================== è§†å›¾æ¸²æŸ“ ====================
            renderOverview: function() {
                const html = `
                    <div class="content-header">
                        <h2>æ ¸å¿ƒèµ„äº§æ€»è§ˆ</h2>
                        <p>ç³»ç»Ÿç‰ˆæœ¬: ${DataStore.currentVersion} | æœ¬åœ°å­˜å‚¨æ•°æ®çŠ¶æ€</p>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3><i class="fas fa-brain"></i> æ€è€ƒè®°å½•æ€»æ•°</h3>
                            <div class="stat-value">${DataStore.thoughts.length}</div>
                            <div class="stat-desc">å®Œæ•´ç»“æ„åŒ–æ€è€ƒæ¡ç›®</div>
                        </div>
                        
                        <div class="stat-card">
                            <h3><i class="fas fa-cubes"></i> æ ¸å¿ƒæ€ç»´æ¨¡å‹</h3>
                            <div class="stat-value">${DataStore.models.length}</div>
                            <div class="stat-desc">å¯è¿ç§»çš„åˆ†ææ¡†æ¶</div>
                        </div>
                        
                        <div class="stat-card">
                            <h3><i class="fas fa-tags"></i> æ ‡ç­¾å…³é”®è¯</h3>
                            <div class="stat-value">${Object.keys(DataStore.tags).length}</div>
                            <div class="stat-desc">è·¨ä¸»é¢˜åˆ†ç±»æ ‡ç­¾</div>
                        </div>
                        
                        <div class="stat-card">
                            <h3><i class="fas fa-heartbeat"></i> ç³»ç»Ÿå¥åº·åº¦</h3>
                            <div class="stat-value">100%</div>
                            <div class="stat-desc">æ¶æ„é«˜åº¦è‡ªæ´½ï¼ŒåŠŸèƒ½å®Œæ•´</div>
                        </div>
                    </div>
                    
                    <div class="detail-view">
                        <div class="detail-header">
                            <div>
                                <div class="detail-title">ç³»ç»Ÿæ¶æ„ç‰¹æ€§</div>
                            </div>
                        </div>
                        <div class="detail-content">
                            <p><strong>å¼€æ”¾ç½‘ç»œï¼š</strong>æ¨¡å‹å¯æ— é™æ‹“å±•ï¼Œä¸»é¢˜ä¸å—é™</p>
                            <p><strong>å¤šå±‚ç»“æ„ï¼š</strong>"æ ¸å¿ƒæ¨¡å‹å±‚"ã€"ç°è±¡åˆ†æå±‚"ã€"å®è·µå·¥å…·ç®±"ä¸‰å±‚ååŒè¿ä½œ</p>
                            <p><strong>æ™ºèƒ½è§£æï¼š</strong>æ”¯æŒçµæ´»æ ¼å¼çš„ç»“æ„åŒ–å†…å®¹è§£æï¼Œè‡ªåŠ¨æå–å…³é”®ä¿¡æ¯</p>
                            <p><strong>æœ¬åœ°å­˜å‚¨ï¼š</strong>æ‰€æœ‰æ•°æ®ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œç¡®ä¿éšç§å®‰å…¨</p>
                            <p><strong>å®Œæ•´åŠŸèƒ½ï¼š</strong>å…·å¤‡å¢åˆ æ”¹æŸ¥ã€æ ‡ç­¾å¤æ ¸ã€æœç´¢è¿‡æ»¤ç­‰å®Œæ•´ç®¡ç†åŠŸèƒ½</p>
                            <p><strong>æ•°æ®ç®¡ç†ï¼š</strong>æ–°å¢æ•°æ®å¯¼å‡º/å¯¼å…¥ã€å¤‡ä»½æ¢å¤ã€å…³è”ç½‘ç»œåˆ†æåŠŸèƒ½</p>
                            <p><strong>åˆ†æ®µç¼–è¾‘ï¼š</strong>æ”¯æŒå•ç‹¬ç¼–è¾‘æ€è€ƒè®°å½•çš„å„ä¸ªæ¿å—å†…å®¹</p>
                            <p><strong>æ—¶é—´çº¿ç¼–è¾‘ï¼š</strong>æ”¯æŒç¼–è¾‘ç³»ç»Ÿæ¼”è¿›å†ç¨‹è®°å½•</p>
                            <p><strong>å…³è”æ¨¡å‹è‡ªåŠ¨æå–ï¼š</strong>ä»"æ¥æºæ€è€ƒ"çš„"æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"ä¸­è‡ªåŠ¨æå–å…³è”æ¨¡å‹ID</p>
                            <p><strong>æ¨¡å‹æè¿°è‡ªåŠ¨æå–ï¼š</strong>åœ¨ç¼–è¾‘æ¨¡å‹æ—¶ï¼Œå¯ä»¥ä»æ¥æºæ€è€ƒä¸­è‡ªåŠ¨æå–"æ–°å»ºæ ¸å¿ƒæ¨¡å‹"æ ‡é¢˜ä¸‹çš„å†…å®¹ä½œä¸ºæ¨¡å‹æè¿°</p>
                        </div>
                    </div>
                `;
                
                document.getElementById('content-area').innerHTML = html;
            },
            
            // ==================== æ–°å¢ï¼šæ¨¡å‹å…³è”ç½‘ç»œåˆ†æè§†å›¾ ====================
            renderNetworkAnalysis: function() {
                const models = DataStore.models;
                
                // è·å–æ‰€æœ‰æœ‰å…³è”çš„æ¨¡å‹
                const connectedModels = models.filter(model => {
                    return DataStore.modelConnections[model.id] && DataStore.modelConnections[model.id].length > 0;
                });
                
                // æŒ‰è¿æ¥æ•°æ’åº
                connectedModels.sort((a, b) => {
                    const connectionsA = DataStore.modelConnections[a.id] ? DataStore.modelConnections[a.id].length : 0;
                    const connectionsB = DataStore.modelConnections[b.id] ? DataStore.modelConnections[b.id].length : 0;
                    return connectionsB - connectionsA;
                });
                
                let modelsHTML = '';
                connectedModels.forEach(model => {
                    const connections = DataStore.modelConnections[model.id] || [];
                    
                    modelsHTML += `
                        <div class="model-card" onclick="showModelDetail('${model.id}')">
                            <div class="model-id">${model.id}</div>
                            <div class="model-name">${model.name}</div>
                            <div class="model-desc">å…³è” ${connections.length} ä¸ªæ¨¡å‹</div>
                            <div class="model-tags">
                                ${connections.slice(0, 3).map(id => `<span class="tag">${id}</span>`).join('')}
                                ${connections.length > 3 ? `<span class="tag">+${connections.length - 3}æ›´å¤š</span>` : ''}
                            </div>
                        </div>
                    `;
                });
                
                const html = `
                    <div class="content-header">
                        <h2>æ¨¡å‹å…³è”ç½‘ç»œåˆ†æ</h2>
                        <p>ç³»ç»Ÿç‰ˆæœ¬: ${DataStore.currentVersion} | å¯è§†åŒ–å±•ç¤ºæ¨¡å‹é—´çš„å…³è”å…³ç³»</p>
                    </div>
                    
                    <div class="detail-view">
                        <div class="detail-section">
                            <h4><i class="fas fa-project-diagram"></i> ç½‘ç»œæ¦‚è§ˆ</h4>
                            <div class="detail-section-content">
                                <p>ç³»ç»Ÿä¸­å…±æœ‰ <strong>${connectedModels.length}</strong> ä¸ªæ¨¡å‹å»ºç«‹äº†å…³è”ç½‘ç»œï¼Œå½¢æˆäº†å¤æ‚çš„æ¦‚å¿µå…³è”ä½“ç³»ã€‚</p>
                                <p>å…³è”ç½‘ç»œæœ‰åŠ©äºç†è§£æ¨¡å‹é—´çš„é€»è¾‘å…³ç³»ï¼Œå‘ç°çŸ¥è¯†ä½“ç³»ä¸­çš„å…³é”®èŠ‚ç‚¹å’Œè–„å¼±ç¯èŠ‚ã€‚</p>
                            </div>
                        </div>
                        
                        <div class="detail-section">
                            <h4><i class="fas fa-cube"></i> é«˜åº¦å…³è”æ¨¡å‹</h4>
                            <div class="detail-section-content">
                                <p>ä»¥ä¸‹æ¨¡å‹æ‹¥æœ‰æœ€å¤šçš„å…³è”è¿æ¥ï¼Œæ˜¯ç³»ç»ŸçŸ¥è¯†ç½‘ç»œçš„æ ¸å¿ƒèŠ‚ç‚¹ï¼š</p>
                            </div>
                        </div>
                        
                        <div class="models-list">
                            ${modelsHTML || '<div class="empty-state"><i class="fas fa-project-diagram"></i><p>æš‚æ— æ¨¡å‹å…³è”æ•°æ®</p></div>'}
                        </div>
                        
                        <div class="detail-section">
                            <h4><i class="fas fa-lightbulb"></i> ç½‘ç»œåˆ†æå»ºè®®</h4>
                            <div class="detail-section-content">
                                <ol>
                                    <li><strong>è¯†åˆ«æ ¸å¿ƒèŠ‚ç‚¹ï¼š</strong>å…³æ³¨å…³è”æ•°æœ€å¤šçš„æ¨¡å‹ï¼Œå®ƒä»¬æ˜¯çŸ¥è¯†ä½“ç³»çš„æ ¸å¿ƒ</li>
                                    <li><strong>å‘ç°çŸ¥è¯†å­¤å²›ï¼š</strong>æ£€æŸ¥æ²¡æœ‰å…³è”çš„æ¨¡å‹ï¼Œè€ƒè™‘æ˜¯å¦éœ€è¦å»ºç«‹è¿æ¥</li>
                                    <li><strong>ä¼˜åŒ–ç½‘ç»œç»“æ„ï¼š</strong>ç¡®ä¿é‡è¦æ¦‚å¿µä¹‹é—´æœ‰è¶³å¤Ÿçš„è¿æ¥è·¯å¾„</li>
                                    <li><strong>è¿½è¸ªæ¦‚å¿µæ¼”è¿›ï¼š</strong>é€šè¿‡å…³è”ç½‘ç»œç†è§£æ¦‚å¿µçš„å‘å±•å’Œæ¼”å˜</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('content-area').innerHTML = html;
            },
            
            // ==================== æ–°å¢ï¼šæ•°æ®ç®¡ç†ä¸å¤‡ä»½è§†å›¾ ====================
            renderDataManagement: function() {
                const backupKeys = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key.startsWith('structuredThoughtAssistant_backup_')) {
                        backupKeys.push(key);
                    }
                }
                
                let backupsHTML = '';
                if (backupKeys.length > 0) {
                    backupKeys.forEach(key => {
                        const date = key.replace('structuredThoughtAssistant_backup_', '');
                        backupsHTML += `
                            <div class="index-item">
                                <div class="index-item-id">å¤‡ä»½</div>
                                <div class="index-item-title">${date}</div>
                                <div class="index-item-actions">
                                    <span class="index-item-action" onclick="UIManager.restoreBackup('${key}')" title="æ¢å¤æ­¤å¤‡ä»½">
                                        <i class="fas fa-history" style="color: var(--warning-color);"></i>
                                    </span>
                                    <span class="index-item-action" onclick="UIManager.deleteBackup('${key}')" title="åˆ é™¤å¤‡ä»½">
                                        <i class="fas fa-trash" style="color: var(--danger-color);"></i>
                                    </span>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    backupsHTML = '<div class="empty-state" style="padding: 20px;"><i class="fas fa-history"></i><p>æš‚æ— å¤‡ä»½æ•°æ®</p></div>';
                }
                
                const html = `
                    <div class="content-header">
                        <h2>æ•°æ®ç®¡ç†ä¸å¤‡ä»½</h2>
                        <p>ç³»ç»Ÿç‰ˆæœ¬: ${DataStore.currentVersion} | ç¡®ä¿çŸ¥è¯†èµ„äº§çš„å®‰å…¨ä¸å¯è¿ç§»æ€§</p>
                    </div>
                    
                    <div class="detail-view">
                        <div class="detail-section">
                            <h4><i class="fas fa-database"></i> å½“å‰æ•°æ®çŠ¶æ€</h4>
                            <div class="detail-section-content">
                                <p><strong>æ€è€ƒè®°å½•ï¼š</strong>${DataStore.thoughts.length} æ¡</p>
                                <p><strong>æ€ç»´æ¨¡å‹ï¼š</strong>${DataStore.models.length} ä¸ª</p>
                                <p><strong>æ ‡ç­¾åˆ†ç±»ï¼š</strong>${Object.keys(DataStore.tags).length} ä¸ª</p>
                                <p><strong>æœ€åä¿å­˜ï¼š</strong>${DataStore.lastSaved ? new Date(DataStore.lastSaved).toLocaleString() : 'æœªçŸ¥'}</p>
                                <p><strong>æ•°æ®å¤§å°ï¼š</strong>çº¦ ${JSON.stringify(DataStore).length} å­—èŠ‚</p>
                            </div>
                        </div>
                        
                        <div class="detail-section">
                            <h4><i class="fas fa-download"></i> æ•°æ®å¯¼å‡º</h4>
                            <div class="detail-section-content">
                                <div class="action-buttons">
                                    <button class="btn btn-primary" onclick="UIManager.exportAllData()">
                                        <i class="fas fa-file-export"></i> å¯¼å‡ºå…¨éƒ¨æ•°æ®
                                    </button>
                                    <button class="btn btn-secondary" onclick="UIManager.exportCurrentItem()">
                                        <i class="fas fa-export"></i> å¯¼å‡ºå½“å‰é¡¹ç›®
                                    </button>
                                </div>
                                <p style="margin-top: 10px; color: var(--text-light); font-size: 0.9rem;">
                                    å¯¼å‡ºçš„æ•°æ®ä¸ºJSONæ ¼å¼ï¼Œå¯åœ¨å…¶ä»–è®¾å¤‡æˆ–æµè§ˆå™¨ä¸­å¯¼å…¥æ¢å¤ã€‚
                                </p>
                            </div>
                        </div>
                        
                        <div class="detail-section">
                            <h4><i class="fas fa-sync-alt"></i> æ•°æ®å¤‡ä»½ä¸æ¢å¤</h4>
                            <div class="detail-section-content">
                                <div class="action-buttons">
                                    <button class="btn btn-success" onclick="UIManager.backupAllData()">
                                        <i class="fas fa-save"></i> åˆ›å»ºå¤‡ä»½
                                    </button>
                                    <button class="btn btn-warning" onclick="UIManager.importData()">
                                        <i class="fas fa-file-import"></i> å¯¼å…¥æ•°æ®
                                    </button>
                                    <button class="btn btn-danger" onclick="UIManager.resetData()">
                                        <i class="fas fa-trash"></i> é‡ç½®æ•°æ®
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="detail-section">
                            <h4><i class="fas fa-history"></i> å¤‡ä»½è®°å½•</h4>
                            <div class="index-panel">
                                <div class="index-list">
                                    ${backupsHTML}
                                </div>
                            </div>
                        </div>
                        
                        <div class="detail-section">
                            <h4><i class="fas fa-lightbulb"></i> æ•°æ®å®‰å…¨æç¤º</h4>
                            <div class="detail-section-content">
                                <ol>
                                    <li><strong>å®šæœŸå¤‡ä»½ï¼š</strong>å»ºè®®æ¯å‘¨è‡³å°‘å¤‡ä»½ä¸€æ¬¡æ•°æ®</li>
                                    <li><strong>å¼‚åœ°å­˜å‚¨ï¼š</strong>å°†å¯¼å‡ºçš„æ•°æ®æ–‡ä»¶ä¿å­˜åœ¨äº‘ç›˜æˆ–å…¶ä»–å®‰å…¨ä½ç½®</li>
                                    <li><strong>ç‰ˆæœ¬ç®¡ç†ï¼š</strong>é‡è¦æ›´æ–°å‰åˆ›å»ºå¤‡ä»½ï¼Œä¾¿äºå›æ»š</li>
                                    <li><strong>æ•°æ®éªŒè¯ï¼š</strong>å®šæœŸæ£€æŸ¥æ•°æ®å®Œæ•´æ€§ï¼Œç¡®ä¿æ— æŸå</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('content-area').innerHTML = html;
            },
            
            renderAddStructured: function() {
                const html = `
                    <div class="content-header">
                        <h2>ç»“æ„åŒ–è¾“å…¥æ€è€ƒå†…å®¹</h2>
                        <p>æŒ‰ç…§çµæ´»æ ¼å¼è¾“å…¥ï¼Œç³»ç»Ÿå°†æ™ºèƒ½è§£æå¹¶å½’ç±»</p>
                    </div>
                    
                    <div class="format-hint">
                        <i class="fas fa-lightbulb"></i> <strong>æ ¼å¼è¯´æ˜ï¼š</strong> ç³»ç»Ÿä¼šæ™ºèƒ½è¯†åˆ«ä»¥ä¸‹å…³é”®éƒ¨åˆ†ï¼Œä¸è¦æ±‚æ ¼å¼å®Œå…¨ä¸€è‡´ï¼š
                        <div style="margin-top: 10px; font-size: 0.9rem;">
                            <div><strong>çŠ¶æ€çœ‹æ¿</strong> - æè¿°æ€è€ƒçš„åŸºæœ¬ä¿¡æ¯</div>
                            <div><strong>æ ¸å¿ƒç»“è®º</strong> - ä¸»è¦è§‚ç‚¹å’Œå‘ç°</div>
                            <div><strong>æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ</strong> - æ¨¡å‹æ‰©å±•å’Œå…³è”</div>
                            <div><strong>è¡ŒåŠ¨/æ€ç»´è¦ç‚¹</strong> - è¡ŒåŠ¨å»ºè®®å’Œæ€è€ƒè¦ç‚¹</div>
                            <div><strong>æ¶æ„æ›´æ–°</strong> - ç³»ç»Ÿæˆ–æ¨¡å‹çš„æ›´æ–°</div>
                        </div>
                    </div>
                    
                    <div class="input-section">
                        <h3>è¾“å…¥æ€è€ƒå†…å®¹</h3>
                        <textarea id="structured-input" placeholder="è¯·è¾“å…¥æ‚¨çš„æ€è€ƒå†…å®¹ï¼Œç³»ç»Ÿä¼šæ™ºèƒ½è¯†åˆ«å„ä¸ªéƒ¨åˆ†..."></textarea>
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="parseAndPreview()">
                                <i class="fas fa-search"></i> è§£æé¢„è§ˆ
                            </button>
                            <button class="btn btn-success" onclick="saveStructuredThought()">
                                <i class="fas fa-save"></i> ä¿å­˜æ€è€ƒ
                            </button>
                        </div>
                        <div id="parse-preview" class="parse-preview">
                            <!-- è§£æé¢„è§ˆå°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                    
                    <div class="index-panel">
                        <h4><i class="fas fa-history"></i> æœ€è¿‘æ·»åŠ çš„æ€è€ƒè®°å½•</h4>
                        <div id="recent-thoughts-list">
                            ${this.renderThoughtList(DataStore.getRecentThoughts(3), true)}
                        </div>
                    </div>
                `;
                
                document.getElementById('content-area').innerHTML = html;
            },
            
            renderThoughts: function() {
                const thoughts = DataStore.thoughts;
                
                let thoughtsHTML = '';
                thoughts.forEach(thought => {
                    const summary = thought.sections && thought.sections["æ ¸å¿ƒç»“è®º"] ? 
                        thought.sections["æ ¸å¿ƒç»“è®º"].substring(0, 80) + '...' : 
                        (thought.content ? thought.content.substring(0, 80) + '...' : '');
                    
                    thoughtsHTML += `
                        <div class="record-card" onclick="showThoughtDetail('${thought.id}')">
                            <div class="card-actions">
                                <div class="action-icon edit" onclick="event.stopPropagation(); editThought('${thought.id}')" title="ç¼–è¾‘">
                                    <i class="fas fa-edit"></i>
                                </div>
                                <div class="action-icon delete" onclick="event.stopPropagation(); openDeleteModal('thought', '${thought.id}')" title="åˆ é™¤">
                                    <i class="fas fa-trash"></i>
                                </div>
                            </div>
                            <div class="record-id">${thought.id}</div>
                            <div class="record-title">${thought.title || 'æ— æ ‡é¢˜'}</div>
                            <div class="record-desc">${summary}</div>
                            <div class="record-tags">
                                ${thought.tags ? thought.tags.map(tag => `<span class="tag">${tag}</span>`).join('') : ''}
                            </div>
                        </div>
                    `;
                });
                
                const html = `
                    <div class="content-header">
                        <h2>æ€è€ƒç›®å½•å®Œæ•´æ¸…å•</h2>
                        <p>ç³»ç»Ÿç‰ˆæœ¬: ${DataStore.currentVersion} | å…± ${DataStore.thoughts.length} æ¡æ€è€ƒè®°å½•</p>
                    </div>
                    
                    <div class="records-list">
                        ${thoughtsHTML || '<div class="empty-state"><i class="fas fa-inbox"></i><p>æš‚æ— æ€è€ƒè®°å½•</p></div>'}
                    </div>
                `;
                
                document.getElementById('content-area').innerHTML = html;
            },
            
            renderModels: function() {
                const models = DataStore.models;
                
                let modelsHTML = '';
                models.forEach(model => {
                    modelsHTML += `
                        <div class="model-card" onclick="showModelDetail('${model.id}')">
                            <div class="card-actions">
                                <div class="action-icon edit" onclick="event.stopPropagation(); editModel('${model.id}')" title="ç¼–è¾‘">
                                    <i class="fas fa-edit"></i>
                                </div>
                                <div class="action-icon delete" onclick="event.stopPropagation(); openDeleteModal('model', '${model.id}')" title="åˆ é™¤">
                                    <i class="fas fa-trash"></i>
                                </div>
                            </div>
                            <div class="model-id">${model.id}</div>
                            <div class="model-name">${model.name}</div>
                            <div class="model-desc">${model.description.substring(0, 100)}...</div>
                            <div class="model-tags">
                                ${model.tags ? model.tags.map(tag => `<span class="tag">${tag}</span>`).join('') : ''}
                            </div>
                        </div>
                    `;
                });
                
                const html = `
                    <div class="content-header">
                        <h2>æ ¸å¿ƒæ€ç»´æ¨¡å‹ç´¢å¼•</h2>
                        <p>ç³»ç»Ÿç‰ˆæœ¬: ${DataStore.currentVersion} | å…± ${DataStore.models.length} ä¸ªæ€ç»´æ¨¡å‹</p>
                    </div>
                    
                    <div class="models-list">
                        ${modelsHTML || '<div class="empty-state"><i class="fas fa-cubes"></i><p>æš‚æ— æ€ç»´æ¨¡å‹</p></div>'}
                    </div>
                `;
                
                document.getElementById('content-area').innerHTML = html;
            },
            
            renderAddModel: function() {
                const html = `
                    <div class="content-header">
                        <h2>åˆ›å»ºæ€ç»´æ¨¡å‹</h2>
                        <p>å®šä¹‰æ–°çš„æ€ç»´æ¡†æ¶å’Œåˆ†ææ¨¡å‹</p>
                    </div>
                    
                    <div class="input-section">
                        <h3>æ–°çš„æ¨¡å‹</h3>
                        <input type="text" id="model-id" placeholder="æ¨¡å‹ID (ä¾‹å¦‚: M-80)">
                        <input type="text" id="model-name" placeholder="æ¨¡å‹åç§°ï¼ˆä¾‹å¦‚ï¼šå…³ç³»å­˜åœ¨è®ºæ¨¡å‹ï¼‰">
                        <input type="text" id="model-from-thought" placeholder="æ¥æºæ€è€ƒID (ä¾‹å¦‚: #123)">
                        <textarea id="model-description" placeholder="è¯·è¯¦ç»†æè¿°è¿™ä¸ªæ¨¡å‹çš„å®šä¹‰ã€åº”ç”¨åœºæ™¯ã€å…³è”æ¨¡å‹ç­‰..." style="min-height: 200px;"></textarea>
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="saveModel()">
                                <i class="fas fa-save"></i> ä¿å­˜æ¨¡å‹
                            </button>
                        </div>
                    </div>
                    
                    <div class="index-panel">
                        <h4><i class="fas fa-history"></i> æœ€è¿‘æ·»åŠ çš„æ€ç»´æ¨¡å‹</h4>
                        <div id="recent-models-list">
                            ${this.renderModelList(DataStore.getRecentModels(3), true)}
                        </div>
                    </div>
                `;
                
                document.getElementById('content-area').innerHTML = html;
            },
            
            renderKeywords: function() {
                const topTags = DataStore.getTopTags(20);
                
                let tagsHTML = '';
                topTags.forEach(({ tag, count }) => {
                    tagsHTML += `<span class="tag" style="cursor:pointer; font-size: ${14 + Math.min(count, 10)}px;" onclick="filterByTag('${tag}')">${tag} (${count})</span>`;
                });
                
                const html = `
                    <div class="content-header">
                        <h2>æ ‡ç­¾åˆ†ç±»æ£€ç´¢</h2>
                        <p>ç³»ç»Ÿç‰ˆæœ¬: ${DataStore.currentVersion} | å…± ${Object.keys(DataStore.tags).length} ä¸ªæ ‡ç­¾</p>
                    </div>
                    
                    <div class="detail-view">
                        <div class="detail-content">
                            <h4>çƒ­é—¨æ ‡ç­¾</h4>
                            <div class="tag-cloud" style="margin-top: 15px; margin-bottom: 25px;">
                                ${tagsHTML}
                            </div>
                            
                            <h4>æ ‡ç­¾åˆ†ç±»ä½“ç³»</h4>
                            ${Object.keys(DataStore.tagCategories).map(category => `
                                <div class="detail-section">
                                    <h4>${category}</h4>
                                    <div class="detail-section-content">
                                        ${DataStore.tagCategories[category].map(tag => {
                                            const count = DataStore.tags[tag] || 0;
                                            return `<span class="tag" style="cursor:pointer; margin-right: 8px; margin-bottom: 8px;" onclick="filterByTag('${tag}')">${tag} ${count > 0 ? `(${count})` : ''}</span>`;
                                        }).join('')}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                
                document.getElementById('content-area').innerHTML = html;
            },
            
            renderHowToUse: function() {
                const html = `
                    <div class="content-header">
                        <h2>å¦‚ä½•ä½¿ç”¨æœ¬ç³»ç»Ÿ</h2>
                        <p>å°†æ·±åˆ»åˆ†æä»"å…³äºä»–äººçš„çŸ¥è¯†"è½¬åŒ–ä¸º"å…³äºè‡ªæˆ‘çš„æ™ºæ…§"</p>
                    </div>
                    
                    <div class="detail-view">
                        <div class="detail-content">
                            <div class="detail-section">
                                <h4><i class="fas fa-compass"></i> ä½¿ç”¨æµç¨‹</h4>
                                <div class="detail-section-content">
                                    <p>1. <strong>æ ¹æ®æƒ…ç»ª/é—®é¢˜å®šä½æƒ…å¢ƒ</strong>ï¼šå…ˆæ„Ÿå—è‡ªå·±æœ€æ ¸å¿ƒçš„æƒ…ç»ªï¼ˆæ˜¯ä¸å®‰ã€é—æ†¾ã€çª’æ¯æ„Ÿï¼Œè¿˜æ˜¯éœ€è¦æŠ‰æ‹©ï¼‰ï¼Œæ‰¾åˆ°å¯¹åº”çš„æƒ…å¢ƒæ¿å—ã€‚</p>
                                    <p>2. <strong>å¿«é€Ÿæµè§ˆæ ¸å¿ƒæ¨¡å‹</strong>ï¼šç†è§£ä½ æ­£ç»å†çš„å¯èƒ½æ˜¯å“ªç§å¿ƒç†æ¨¡å¼ã€‚</p>
                                    <p>3. <strong>è°ƒç”¨å…·ä½“çš„æ€ç»´/è¡ŒåŠ¨è¦ç‚¹</strong>ï¼šé€‰æ‹©1-2æ¡æœ€è§¦åŠ¨ä½ çš„è¦ç‚¹ï¼Œç«‹åˆ»åœ¨è„‘æµ·ä¸­æ¼”ç»ƒæˆ–å†™åœ¨çº¸ä¸Šã€‚å®ƒä¸æ˜¯æ ‡å‡†ç­”æ¡ˆï¼Œè€Œæ˜¯æ€ç»´çš„å¯åŠ¨å™¨ã€‚</p>
                                    <p>4. <strong>å°†çŸ¥è¯†è½¬åŒ–ä¸ºè‡ªæˆ‘æ™ºæ…§</strong>ï¼šè¿™ä¸ªå·¥å…·åŒ…ä¼šéšç€æ€è€ƒåº“çš„æ‰©å……è€ŒæŒç»­æ›´æ–°ã€‚å®ƒçš„æœ€ç»ˆç›®çš„ï¼Œæ˜¯è®©é‚£äº›æ·±åˆ»çš„åˆ†æï¼Œä»å…³äºä»–äººçš„çŸ¥è¯†ï¼Œè½¬åŒ–ä¸ºå…³äºè‡ªæˆ‘çš„æ™ºæ…§ã€‚</p>
                                </div>
                            </div>
                            
                            <div class="detail-section">
                                <h4><i class="fas fa-lightbulb"></i> æ ¸å¿ƒåŠŸèƒ½è¯´æ˜</h4>
                                <div class="detail-section-content">
                                    <p><strong>ç»“æ„åŒ–è¾“å…¥</strong>ï¼šæ”¯æŒçµæ´»æ ¼å¼çš„å†…å®¹è¾“å…¥ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è§£æçŠ¶æ€çœ‹æ¿ã€æ ¸å¿ƒç»“è®ºã€æ¨¡å‹å»¶ä¼¸ç­‰éƒ¨åˆ†ã€‚</p>
                                    <p><strong>åˆ†æ®µç¼–è¾‘</strong>ï¼šå¯å•ç‹¬ç¼–è¾‘æ€è€ƒè®°å½•çš„å„ä¸ªæ¿å—ï¼ˆçŠ¶æ€çœ‹æ¿ã€æ ¸å¿ƒç»“è®ºã€æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆã€è¡ŒåŠ¨/æ€ç»´è¦ç‚¹ã€æ¶æ„æ›´æ–°ï¼‰ã€‚</p>
                                    <p><strong>å¯ç¼–è¾‘ID</strong>ï¼šæ€è€ƒè®°å½•çš„IDç¼–ç å¯ä»¥ç¼–è¾‘å’Œä¿®æ”¹ã€‚</p>
                                    <p><strong>æ—¶é—´çº¿ç¼–è¾‘</strong>ï¼šç³»ç»Ÿæ¼”è¿›å†ç¨‹æ”¯æŒæ‰‹åŠ¨ç¼–è¾‘ï¼Œå¯æ·»åŠ ã€ä¿®æ”¹å’Œåˆ é™¤æ—¶é—´çº¿è®°å½•ã€‚</p>
                                    <p><strong>æ€ç»´æ¨¡å‹ç®¡ç†</strong>ï¼šåˆ›å»ºå’Œç®¡ç†å¯å¤ç”¨çš„æ€ç»´æ¡†æ¶ï¼Œå»ºç«‹æ¨¡å‹é—´çš„å…³è”ç½‘ç»œã€‚</p>
                                    <p><strong>æ ‡ç­¾ç³»ç»Ÿ</strong>ï¼šè‡ªåŠ¨æå–å’Œåˆ†ç±»æ ‡ç­¾ï¼Œæ”¯æŒæ ‡ç­¾å¤æ ¸å’Œæ™ºèƒ½å»ºè®®ã€‚</p>
                                    <p><strong>æœ¬åœ°å­˜å‚¨</strong>ï¼šæ‰€æœ‰æ•°æ®ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œç¡®ä¿éšç§å®‰å…¨ã€‚</p>
                                    <p><strong>æ™ºèƒ½æœç´¢</strong>ï¼šæ”¯æŒæŒ‰å…³é”®è¯ã€æ ‡ç­¾ã€ä¸»é¢˜è¿›è¡Œå…¨æ–‡æ£€ç´¢ã€‚</p>
                                    <p><strong>æ•°æ®ç®¡ç†</strong>ï¼šæ–°å¢æ•°æ®å¯¼å‡º/å¯¼å…¥ã€å¤‡ä»½æ¢å¤ã€å…³è”ç½‘ç»œåˆ†æåŠŸèƒ½ã€‚</p>
                                    <p><strong>å…³è”æ¨¡å‹è‡ªåŠ¨æå–</strong>ï¼šä»"æ¥æºæ€è€ƒ"çš„"æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"ä¸­è‡ªåŠ¨æå–å…³è”æ¨¡å‹IDã€‚</p>
                                    <p><strong>æ¨¡å‹æè¿°è‡ªåŠ¨æå–</strong>ï¼šåœ¨ç¼–è¾‘æ¨¡å‹æ—¶ï¼Œå¯ä»¥ä»æ¥æºæ€è€ƒä¸­è‡ªåŠ¨æå–"æ–°å»ºæ ¸å¿ƒæ¨¡å‹"æ ‡é¢˜ä¸‹çš„å†…å®¹ä½œä¸ºæ¨¡å‹æè¿°ã€‚</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('content-area').innerHTML = html;
            },
            
            renderMilestones: function() {
                const milestones = [
                    {version: "v1.0-v5.0", date: "2023-01", desc: "åŸºç¡€æƒ…æ„Ÿæ¨¡å‹å»ºç«‹ï¼ˆå·¥å…·åŒ–ã€é”™ä½ã€é—æ†¾ï¼‰"},
                    {version: "v6.0-v10.0", date: "2023-03", desc: "å…³ç³»æ¨¡å‹æ·±åŒ–ï¼ˆæˆç†Ÿé¦ˆèµ ã€æ— é™åšå¼ˆï¼‰"},
                    {version: "v11.0-v15.0", date: "2023-05", desc: "å­˜åœ¨å“²å­¦æ‹“å±•ï¼ˆå­˜åœ¨å‹˜æ¢ã€æ°´æ€§æ™ºæ…§ï¼‰"},
                    {version: "v16.0-v18.0", date: "2023-07", desc: "é˜²å¾¡æœºåˆ¶ä¸ç—…ç†å­¦å®Œå–„ï¼ˆæ¢¦å¢ƒå¯„ç”Ÿã€æƒ…æ„Ÿéº»ç—¹ï¼‰"},
                    {version: "v18.0-v20.2", date: "2023-09", desc: "å…³ç³»åŠ¨åŠ›å­¦ã€å¥åº·å…±å»ºã€æ„ä¹‰æ•´åˆ"},
                    {version: "v20.3-v21.3", date: "2023-11", desc: "å®è§‚ç¤¾ä¼šæ‰¹åˆ¤ã€ä¸ªä½“ç”Ÿå­˜ç­–ç•¥ã€å“²å­¦æ¡†æ¶æ™®é€‚åŒ–"},
                    {version: "v21.4-v22.0", date: "2024-01", desc: "äº²å¯†å…³ç³»å…‰è°±ã€å­˜åœ¨æ€§å¯„ç”Ÿã€ç†µå¢æŸè€—ã€ç¥›é­…æ‚¬ç½®ã€å¶åƒå¹»ç­ã€åˆ›ä¼¤åé‡å»ºã€è™šæ— ç¾å­¦æ•´åˆ"},
                    {version: "v22.1-v22.2", date: "2024-03", desc: "åŒè½¨åˆ¶æ¶æ„å»ºç«‹ï¼Œæ–°å¢ M-45 è‡³ M-53 æ¨¡å‹"},
                    {version: "v22.33", date: "2024-05", desc: "ã€Šæˆ‘ä»¬å¾ˆå¥½ã€‹Ã—ã€Šå¿«ä¹æ˜ŸçŒ«ã€‹å…³ç³»è¯Šç–—æ•´åˆç‰ˆ"},
                    {version: "v22.48", date: "2024-07", desc: "ã€Šå¯„å±…ã€‹Ã—ã€ŠèŠ±ã€‹æ•´åˆç‰ˆï¼Œæ¨¡å‹æ€»æ•°è¾¾80ä¸ª"}
                ];
                
                let milestonesHTML = '';
                milestones.forEach(milestone => {
                    milestonesHTML += `
                        <div class="record-card">
                            <div class="record-id">${milestone.version}</div>
                            <div class="record-desc">${milestone.desc}</div>
                        </div>
                    `;
                });
                
                const html = `
                    <div class="content-header">
                        <h2>ç³»ç»Ÿæ¼”è¿›é‡Œç¨‹ç¢‘</h2>
                        <p>ç³»ç»Ÿç‰ˆæœ¬: ${DataStore.currentVersion} | å¯¹è¯è„‰ç»œä¸æ—¶é—´çº¿</p>
                    </div>
                    
                    <div class="records-list">
                        ${milestonesHTML || '<div class="empty-state"><i class="fas fa-road"></i><p>æš‚æ— é‡Œç¨‹ç¢‘æ•°æ®</p></div>'}
                    </div>
                `;
                
                document.getElementById('content-area').innerHTML = html;
            },
            
            renderArchitecture: function() {
                const architecture = {
                    openNetwork: "æ¨¡å‹å¯æ— é™æ‹“å±•ï¼Œä¸»é¢˜ä¸å—é™",
                    multiLayer: "æ ¸å¿ƒæ¨¡å‹å±‚/ç°è±¡åˆ†æå±‚/å®è·µå·¥å…·ç®±ååŒè¿ä½œ",
                    dualTrack: "æ ‡å‡†æ¨¡å‹åº“ä¿è¯å¤„ç†æ•ˆç‡ï¼Œæ€æƒ³åŸå…¸åº“ä¿è¯å®Œæ•´æ€§",
                    goal: "æˆä¸ºäººç”Ÿå„è¯¾é¢˜ï¼ˆæƒ…æ„Ÿã€å­˜åœ¨ã€æ„ä¹‰ã€æˆé•¿ã€å…³ç³»ï¼‰çš„åˆ†æä¸è¡ŒåŠ¨å¼•æ“",
                    currentHeight: "å·²å»ºç«‹ä»å…³ç³»å­˜åœ¨è®º(M-80)åˆ°ä¸´åºŠå¹²é¢„(M-66)çš„å®Œæ•´åˆ†æ-å®è·µæ¡†æ¶"
                };
                
                const html = `
                    <div class="content-header">
                        <h2>ç³»ç»Ÿæ¶æ„ç‰¹æ€§ç¡®è®¤</h2>
                        <p>ç³»ç»Ÿç‰ˆæœ¬: ${DataStore.currentVersion} | æ¶æ„å®Œæ•´æ€§éªŒè¯</p>
                    </div>
                    
                    <div class="detail-view">
                        <div class="detail-content">
                            <p><strong>å¼€æ”¾ç½‘ç»œï¼š</strong>${architecture.openNetwork}</p>
                            <p><strong>å¤šå±‚ç»“æ„ï¼š</strong>${architecture.multiLayer}</p>
                            <p><strong>åŒè½¨æ•°æ®ï¼š</strong>${architecture.dualTrack}</p>
                            <p><strong>ç»ˆæç›®æ ‡ï¼š</strong>${architecture.goal}</p>
                            <p><strong>å½“å‰é«˜åº¦ï¼š</strong>${architecture.currentHeight}</p>
                        </div>
                    </div>
                `;
                
                document.getElementById('content-area').innerHTML = html;
            },
            
            renderTagReview: function() {
                const thoughts = DataStore.thoughts;
                const models = DataStore.models;
                
                // æ‰¾å‡ºéœ€è¦å¤æ ¸çš„é¡¹ç›®ï¼ˆæ ‡ç­¾è¾ƒå°‘æˆ–æ²¡æœ‰æ ‡ç­¾çš„ï¼‰
                const needsReview = [];
                
                thoughts.forEach(thought => {
                    if (!thought.tags || thought.tags.length === 0) {
                        needsReview.push({
                            type: 'thought',
                            id: thought.id,
                            title: thought.title,
                            tags: thought.tags || [],
                            date: thought.date
                        });
                    }
                });
                
                models.forEach(model => {
                    if (!model.tags || model.tags.length === 0) {
                        needsReview.push({
                            type: 'model',
                            id: model.id,
                            title: model.name,
                            tags: model.tags || [],
                            date: model.date
                        });
                    }
                });
                
                let reviewHTML = '';
                if (needsReview.length > 0) {
                    needsReview.forEach(item => {
                        reviewHTML += `
                            <div class="index-item">
                                <div class="index-item-id">${item.id}</div>
                                <div class="index-item-title">${item.title}</div>
                                <div class="index-item-actions">
                                    <span class="index-item-action" onclick="openTagReview('${item.type}', '${item.id}')" title="æ ‡ç­¾å¤æ ¸">
                                        <i class="fas fa-tags" style="color: var(--accent-color);"></i>
                                    </span>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    reviewHTML = '<div class="empty-state" style="padding: 20px;"><i class="fas fa-check-circle"></i><p>æ‰€æœ‰é¡¹ç›®éƒ½å·²æ ‡è®°æ ‡ç­¾ï¼Œæ— éœ€å¤æ ¸</p></div>';
                }
                
                const html = `
                    <div class="content-header">
                        <h2>æ ‡ç­¾å¤æ ¸ä¸­å¿ƒ</h2>
                        <p>ç³»ç»Ÿç‰ˆæœ¬: ${DataStore.currentVersion} | å…± ${needsReview.length} ä¸ªé¡¹ç›®éœ€è¦æ ‡ç­¾å¤æ ¸</p>
                    </div>
                    
                    <div class="detail-view">
                        <div class="detail-section">
                            <h4><i class="fas fa-exclamation-circle"></i> éœ€è¦æ ‡ç­¾å¤æ ¸çš„é¡¹ç›®</h4>
                            <div class="index-list">
                                ${reviewHTML}
                            </div>
                        </div>
                        
                        <div class="detail-section">
                            <h4><i class="fas fa-tags"></i> çƒ­é—¨æ ‡ç­¾å»ºè®®</h4>
                            <div class="detail-section-content">
                                ${Object.keys(DataStore.tagCategories).map(category => `
                                    <div style="margin-bottom: 15px;">
                                        <div style="font-weight: 500; margin-bottom: 5px; color: var(--primary-color);">${category}</div>
                                        <div>
                                            ${DataStore.tagCategories[category].map(tag => {
                                                const count = DataStore.tags[tag] || 0;
                                                return `<span class="tag" style="cursor:pointer; margin-right: 8px; margin-bottom: 8px;" onclick="addSuggestedTagToReview('${tag}')">${tag} ${count > 0 ? `(${count})` : ''}</span>`;
                                            }).join('')}
                                        </div>
                                    </div>
                                `).join('')}
                        </div>
                    </div>
                `;
                
                document.getElementById('content-area').innerHTML = html;
            },
            
            // ==================== åˆ—è¡¨æ¸²æŸ“è¾…åŠ©å‡½æ•° ====================
            renderThoughtList: function(thoughts, showActions = false) {
                if (!thoughts || thoughts.length === 0) {
                    return '<div class="empty-state" style="padding: 20px;"><i class="fas fa-inbox"></i><p>æš‚æ— æ€è€ƒè®°å½•</p></div>';
                }
                
                let html = '';
                thoughts.forEach(thought => {
                    const actions = showActions ? `
                        <div class="index-item-actions">
                            <span class="index-item-action" onclick="event.stopPropagation(); editThought('${thought.id}')" title="ç¼–è¾‘">
                                <i class="fas fa-edit" style="color: var(--warning-color);"></i>
                            </span>
                            <span class="index-item-action" onclick="event.stopPropagation(); openTagReview('thought', '${thought.id}')" title="æ ‡ç­¾å¤æ ¸">
                                <i class="fas fa-tags" style="color: var(--accent-color);"></i>
                            </span>
                            <span class="index-item-action" onclick="event.stopPropagation(); openDeleteModal('thought', '${thought.id}')" title="åˆ é™¤">
                                <i class="fas fa-trash" style="color: var(--danger-color);"></i>
                            </span>
                        </div>
                    ` : '<div class="index-item-jump">æŸ¥çœ‹</div>';
                    
                    html += `
                        <div class="index-item" onclick="showThoughtDetail('${thought.id}')">
                            <div class="index-item-id">${thought.id}</div>
                            <div class="index-item-title">${thought.title || 'æ— æ ‡é¢˜'}</div>
                            ${actions}
                        </div>
                    `;
                });
                
                return html;
            },
            
            renderModelList: function(models, showActions = false) {
                if (!models || models.length === 0) {
                    return '<div class="empty-state" style="padding: 20px;"><i class="fas fa-cubes"></i><p>æš‚æ— æ€ç»´æ¨¡å‹</p></div>';
                }
                
                let html = '';
                models.forEach(model => {
                    const actions = showActions ? `
                        <div class="index-item-actions">
                            <span class="index-item-action" onclick="event.stopPropagation(); editModel('${model.id}')" title="ç¼–è¾‘">
                                <i class="fas fa-edit" style="color: var(--warning-color);"></i>
                            </span>
                            <span class="index-item-action" onclick="event.stopPropagation(); openTagReview('model', '${model.id}')" title="æ ‡ç­¾å¤æ ¸">
                                <i class="fas fa-tags" style="color: var(--accent-color);"></i>
                            </span>
                            <span class="index-item-action" onclick="event.stopPropagation(); openDeleteModal('model', '${model.id}')" title="åˆ é™¤">
                                <i class="fas fa-trash" style="color: var(--danger-color);"></i>
                            </span>
                        </div>
                    ` : '<div class="index-item-jump">æŸ¥çœ‹</div>';
                    
                    html += `
                        <div class="index-item" onclick="showModelDetail('${model.id}')">
                            <div class="index-item-id">${model.id}</div>
                            <div class="index-item-title">${model.name}</div>
                            ${actions}
                        </div>
                    `;
                });
                
                return html;
            },
            
            // ==================== è¯¦æƒ…é¡µæ¸²æŸ“ ====================
            renderThoughtDetail: function(thought, isEditing = false) {
                if (!thought) {
                    return '<div class="empty-state"><i class="fas fa-search"></i><p>æœªæ‰¾åˆ°æ€è€ƒè®°å½•</p></div>';
                }
                
                if (isEditing) {
                    // ç¼–è¾‘æ¨¡å¼ - ç°åœ¨ä½¿ç”¨åˆ†æ®µç¼–è¾‘
                    let html = `
                        <div class="detail-view">
                            <div class="content-header">
                                <h2>ç¼–è¾‘æ€è€ƒè®°å½•</h2>
                                <p>ä¿®æ”¹æ€è€ƒå†…å®¹</p>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-warning" onclick="UIManager.openSectionEditorModal('${thought.id}')">
                                    <i class="fas fa-edit"></i> åˆ†æ®µç¼–è¾‘æ­¤æ€è€ƒ
                                </button>
                                <button class="btn btn-secondary" onclick="showThoughtDetail('${thought.id}')">
                                    <i class="fas fa-times"></i> å–æ¶ˆ
                                </button>
                            </div>
                            
                            <div class="detail-section">
                                <h4><i class="fas fa-info-circle"></i> åˆ†æ®µç¼–è¾‘åŠŸèƒ½è¯´æ˜</h4>
                                <div class="detail-section-content">
                                    <p>ä½¿ç”¨<strong>åˆ†æ®µç¼–è¾‘</strong>åŠŸèƒ½å¯ä»¥å•ç‹¬ç¼–è¾‘æ€è€ƒçš„å„ä¸ªéƒ¨åˆ†ï¼š</p>
                                    <ul>
                                        <li><strong>çŠ¶æ€çœ‹æ¿</strong>ï¼šåŒ…å«ç³»ç»Ÿç‰ˆæœ¬ã€æ€è€ƒIDã€ä¸»é¢˜ã€ç±»å‹ã€å…³é”®æ ‡è®°ç­‰å…ƒæ•°æ®</li>
                                        <li><strong>æ ¸å¿ƒç»“è®º</strong>ï¼šä¸»è¦è§‚ç‚¹å’Œå‘ç°</li>
                                        <li><strong>æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ</strong>ï¼šæ¨¡å‹æ‰©å±•å’Œå…³è”</li>
                                        <li><strong>è¡ŒåŠ¨/æ€ç»´è¦ç‚¹</strong>ï¼šè¡ŒåŠ¨å»ºè®®å’Œæ€è€ƒè¦ç‚¹</li>
                                        <li><strong>æ¶æ„æ›´æ–°</strong>ï¼šç³»ç»Ÿæˆ–æ¨¡å‹çš„æ›´æ–°</li>
                                    </ul>
                                    <p>ç‚¹å‡»ä¸Šæ–¹çš„<strong>"åˆ†æ®µç¼–è¾‘æ­¤æ€è€ƒ"</strong>æŒ‰é’®å¼€å§‹ç¼–è¾‘ã€‚</p>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    return html;
                } else {
                    // æŸ¥çœ‹æ¨¡å¼
                    let html = `
                        <div class="detail-view">
                            <div class="detail-header">
                                <div>
                                    <div class="detail-title">${thought.title || 'æ— æ ‡é¢˜'}</div>
                                    <div class="detail-id">${thought.id}</div>
                                    <div style="margin-top: 10px;">
                                        ${thought.tags ? thought.tags.map(tag => `<span class="tag">${tag}</span>`).join(' ') : ''}
                                    </div>
                                </div>
                                <div style="color: var(--text-light); font-size: 0.9rem;">${thought.date}</div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-warning" onclick="editThought('${thought.id}')">
                                    <i class="fas fa-edit"></i> ç¼–è¾‘æ­¤æ€è€ƒ
                                </button>
                                <button class="btn" onclick="openTagReview('thought', '${thought.id}')" style="background-color: var(--accent-color); color: white;">
                                    <i class="fas fa-tags"></i> æ ‡ç­¾å¤æ ¸
                                </button>
                                <button class="btn btn-danger" onclick="openDeleteModal('thought', '${thought.id}')">
                                    <i class="fas fa-trash"></i> åˆ é™¤æ­¤æ€è€ƒ
                                </button>
                                <button class="btn btn-secondary" onclick="UIManager.loadView('add-structured')">
                                    <i class="fas fa-arrow-left"></i> è¿”å›è¾“å…¥
                                </button>
                            </div>
                    `;
                    
                    // æ¸²æŸ“çŠ¶æ€çœ‹æ¿
                    if (thought.sections && thought.sections["çŠ¶æ€çœ‹æ¿"]) {
                        html += `
                            <div class="detail-section">
                                <h4><i class="fas fa-tachometer-alt"></i> çŠ¶æ€çœ‹æ¿</h4>
                                <div class="detail-section-content">
                                    <pre style="white-space: pre-wrap; font-family: inherit;">${thought.sections["çŠ¶æ€çœ‹æ¿"]}</pre>
                                </div>
                            </div>
                        `;
                    }
                    
                    // æ¸²æŸ“æ ¸å¿ƒç»“è®º
                    if (thought.sections && thought.sections["æ ¸å¿ƒç»“è®º"]) {
                        html += `
                            <div class="detail-section">
                                <h4><i class="fas fa-bullseye"></i> æ ¸å¿ƒç»“è®º</h4>
                                <div class="detail-section-content">
                                    <pre style="white-space: pre-wrap; font-family: inherit;">${thought.sections["æ ¸å¿ƒç»“è®º"]}</pre>
                                </div>
                            </div>
                        `;
                    }
                    
                    // æ¸²æŸ“æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ
                    if (thought.sections && thought.sections["æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"]) {
                        html += `
                            <div class="detail-section">
                                <h4><i class="fas fa-puzzle-piece"></i> æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ</h4>
                                <div class="detail-section-content">
                                    <pre style="white-space: pre-wrap; font-family: inherit;">${thought.sections["æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"]}</pre>
                                </div>
                            </div>
                        `;
                    }
                    
                    // æ¸²æŸ“è¡ŒåŠ¨/æ€ç»´è¦ç‚¹
                    if (thought.sections && thought.sections["è¡ŒåŠ¨/æ€ç»´è¦ç‚¹"]) {
                        html += `
                            <div class="detail-section">
                                <h4><i class="fas fa-lightbulb"></i> è¡ŒåŠ¨/æ€ç»´è¦ç‚¹</h4>
                                <div class="detail-section-content">
                                    <pre style="white-space: pre-wrap; font-family: inherit;">${thought.sections["è¡ŒåŠ¨/æ€ç»´è¦ç‚¹"]}</pre>
                                </div>
                            </div>
                        `;
                    }
                    
                    // æ¸²æŸ“æ¶æ„æ›´æ–°
                    if (thought.sections && thought.sections["æ¶æ„æ›´æ–°"]) {
                        html += `
                            <div class="detail-section">
                                <h4><i class="fas fa-code-branch"></i> æ¶æ„æ›´æ–°</h4>
                                <div class="detail-section-content">
                                    <pre style="white-space: pre-wrap; font-family: inherit;">${thought.sections["æ¶æ„æ›´æ–°"]}</pre>
                                </div>
                            </div>
                        `;
                    }
                    
                    // å¦‚æœæ˜¯ç®€å•æ€è€ƒï¼Œæ¸²æŸ“åŸå§‹å†…å®¹
                    if (!thought.sections && thought.content) {
                        html += `
                            <div class="detail-section">
                                <h4><i class="fas fa-align-left"></i> å†…å®¹</h4>
                                <div class="detail-section-content">
                                    <pre style="white-space: pre-wrap; font-family: inherit;">${thought.content}</pre>
                                </div>
                            </div>
                        `;
                    }
                    
                    html += `</div>`;
                    return html;
                }
            },
            
            thoughtToStructuredText: function(thought) {
                // å°†æ€è€ƒè®°å½•è½¬æ¢å›ç»“æ„åŒ–æ–‡æœ¬
                let text = '';
                
                // çŠ¶æ€çœ‹æ¿
                if (thought.sections && thought.sections["çŠ¶æ€çœ‹æ¿"]) {
                    text += `ğŸ’ **çŠ¶æ€çœ‹æ¿**\n${thought.sections["çŠ¶æ€çœ‹æ¿"]}\n\n`;
                }
                
                // æ ¸å¿ƒç»“è®º
                if (thought.sections && thought.sections["æ ¸å¿ƒç»“è®º"]) {
                    text += `ğŸŒŒ **æ ¸å¿ƒç»“è®º**\n${thought.sections["æ ¸å¿ƒç»“è®º"]}\n\n`;
                }
                
                // æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ
                if (thought.sections && thought.sections["æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"]) {
                    text += `ğŸ§© **æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ**\n${thought.sections["æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"]}\n\n`;
                }
                
                // è¡ŒåŠ¨/æ€ç»´è¦ç‚¹
                if (thought.sections && thought.sections["è¡ŒåŠ¨/æ€ç»´è¦ç‚¹"]) {
                    text += `ğŸ“š **è¡ŒåŠ¨/æ€ç»´è¦ç‚¹**\n${thought.sections["è¡ŒåŠ¨/æ€ç»´è¦ç‚¹"]}\n\n`;
                }
                
                // æ¶æ„æ›´æ–°
                if (thought.sections && thought.sections["æ¶æ„æ›´æ–°"]) {
                    text += `ğŸ“‚ **æ¶æ„æ›´æ–°**\n${thought.sections["æ¶æ„æ›´æ–°"]}\n\n`;
                }
                
                // å¦‚æœæ²¡æœ‰ç»“æ„åŒ–å†…å®¹ï¼Œè¿”å›åŸå§‹å†…å®¹
                if (text.trim() === '' && thought.content) {
                    text = thought.content;
                }
                
                return text.trim();
            },
            
            renderModelDetail: function(model, isEditing = false) {
                if (!model) {
                    return '<div class="empty-state"><i class="fas fa-search"></i><p>æœªæ‰¾åˆ°æ€ç»´æ¨¡å‹</p></div>';
                }
                
                // æ›´æ–°å½“å‰é€‰ä¸­çš„æ¨¡å‹IDï¼Œç”¨äºå…³è”ç½‘ç»œæ˜¾ç¤º
                this.currentModelId = model.id;
                this.updateNetworkGraph(model.id);
                
                if (isEditing) {
                    // ç¼–è¾‘æ¨¡å¼ - åŒ…å«å…³è”æ¨¡å‹ç¼–è¾‘
                    this.currentEditingModelId = model.id;
                    this.currentRelatedModels = [...(model.relatedModels || [])];
                    
                    let html = `
                        <div class="detail-view">
                            <div class="content-header">
                                <h2>ç¼–è¾‘æ€ç»´æ¨¡å‹</h2>
                                <p>ä¿®æ”¹æ¨¡å‹å†…å®¹</p>
                            </div>
                            
                            <div class="input-section">
                                <h3>ç¼–è¾‘æ¨¡å‹ä¿¡æ¯</h3>
                                
                                <!-- æ–°å¢ï¼šæ¨¡å‹æè¿°æå–æŒ‰é’® -->
                                ${model.fromThought ? `
                                <div style="margin-bottom: 15px;">
                                    <button class="model-description-extract-btn" onclick="extractModelDescriptionFromSource('${model.id}')" id="extract-model-desc-btn">
                                        <i class="fas fa-magic"></i> ä»æ¥æºæ€è€ƒè‡ªåŠ¨æå–æ¨¡å‹æè¿°
                                    </button>
                                    <div class="model-description-extract-info">
                                        <i class="fas fa-info-circle"></i> æ­¤åŠŸèƒ½å°†ä»æ¥æºæ€è€ƒ <strong>${model.fromThought}</strong> çš„"æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"éƒ¨åˆ†æå–"æ–°å»ºæ ¸å¿ƒæ¨¡å‹"æ ‡é¢˜ä¸‹çš„å†…å®¹ä½œä¸ºæ¨¡å‹æè¿°ã€‚
                                    </div>
                                </div>
                                ` : ''}
                                
                                <input type="text" id="edit-model-id" value="${model.id}" placeholder="æ¨¡å‹ID">
                                <input type="text" id="edit-model-name" value="${model.name}" placeholder="æ¨¡å‹åç§°">
                                <textarea id="edit-model-description" placeholder="è¯·è¯¦ç»†æè¿°è¿™ä¸ªæ¨¡å‹çš„å®šä¹‰ã€åº”ç”¨åœºæ™¯ã€å…³è”æ¨¡å‹ç­‰..." style="min-height: 250px;">${model.description}</textarea>
                                
                                <!-- æ–°å¢ï¼šå…³è”æ¨¡å‹ç¼–è¾‘ -->
                                <div class="related-models-section">
                                    <div class="related-models-header">
                                        <h4><i class="fas fa-project-diagram"></i> å…³è”æ¨¡å‹</h4>
                                        <button class="auto-extract-btn" onclick="UIManager.autoExtractRelatedModels()" ${model.fromThought ? '' : 'disabled'}>
                                            <i class="fas fa-magic"></i> ä»æ¥æºæ€è€ƒè‡ªåŠ¨æå–
                                        </button>
                                    </div>
                                    <p style="font-size: 0.9rem; color: var(--text-light); margin-bottom: 10px;">
                                        è¾“å…¥å…³è”çš„æ¨¡å‹IDï¼ˆä¾‹å¦‚ï¼šM-74 M-73 M-77 M-76ï¼‰
                                    </p>
                                    <div class="related-models-input">
                                        <input type="text" id="edit-related-models-input" placeholder="è¾“å…¥æ¨¡å‹IDï¼Œç”¨ç©ºæ ¼æˆ–é€—å·åˆ†éš”">
                                        <button class="btn btn-secondary btn-sm" onclick="UIManager.addRelatedModelFromInput()" style="padding: 5px 10px; font-size: 0.9rem;">
                                            <i class="fas fa-plus"></i> æ·»åŠ 
                                        </button>
                                    </div>
                                    <div class="related-models-list" id="related-models-list">
                                        ${this.renderRelatedModelsList(this.currentRelatedModels)}
                                    </div>
                                    <p style="font-size: 0.85rem; color: var(--text-light); margin-top: 10px;">
                                        æç¤ºï¼šå¦‚æœæ¨¡å‹æœ‰æ¥æºæ€è€ƒï¼Œå¯ä»¥ç‚¹å‡»"ä»æ¥æºæ€è€ƒè‡ªåŠ¨æå–"æŒ‰é’®ï¼Œç³»ç»Ÿä¼šä»"æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"éƒ¨åˆ†æå–å…³è”æ¨¡å‹IDã€‚
                                    </p>
                                </div>
                                
                                <div class="btn-group">
                                    <button class="btn btn-warning" onclick="updateModel('${model.id}')">
                                        <i class="fas fa-save"></i> æ›´æ–°æ¨¡å‹
                                    </button>
                                    <button class="btn btn-secondary" onclick="showModelDetail('${model.id}')">
                                        <i class="fas fa-times"></i> å–æ¶ˆ
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    return html;
                } else {
                    // æŸ¥çœ‹æ¨¡å¼
                    const relatedModels = model.relatedModels || [];
                    const usageCount = model.usageCount || 0;
                    const lastUsed = model.lastUsed || model.date;
                    
                    // è·å–å…³è”ç½‘ç»œ
                    const network = DataStore.getModelNetwork(model.id);
                    
                    let html = `
                        <div class="detail-view">
                            <div class="detail-header">
                                <div>
                                    <div class="detail-title">${model.name}</div>
                                    <div class="detail-id">${model.id}</div>
                                    <div style="margin-top: 10px;">
                                        ${model.tags ? model.tags.map(tag => `<span class="tag">${tag}</span>`).join(' ') : ''}
                                    </div>
                                </div>
                                <div style="color: var(--text-light); font-size: 0.9rem;">${model.date}</div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-warning" onclick="editModel('${model.id}')">
                                    <i class="fas fa-edit"></i> ç¼–è¾‘æ­¤æ¨¡å‹
                                </button>
                                <button class="btn" onclick="openTagReview('model', '${model.id}')" style="background-color: var(--accent-color); color: white;">
                                    <i class="fas fa-tags"></i> æ ‡ç­¾å¤æ ¸
                                </button>
                                <button class="btn btn-danger" onclick="openDeleteModal('model', '${model.id}')">
                                    <i class="fas fa-trash"></i> åˆ é™¤æ­¤æ¨¡å‹
                                </button>
                                <button class="btn btn-secondary" onclick="UIManager.loadView('add-model')">
                                    <i class="fas fa-arrow-left"></i> è¿”å›
                                </button>
                            </div>
                            
                            <div class="detail-section">
                                <h4><i class="fas fa-info-circle"></i> æ¨¡å‹æè¿°</h4>
                                <div class="detail-section-content">
                                    <pre style="white-space: pre-wrap; font-family: inherit;">${model.description}</pre>
                                </div>
                            </div>
                    `;
                    
                    if (model.fromThought) {
                        html += `
                            <div class="detail-section">
                                <h4><i class="fas fa-link"></i> æ¥æºæ€è€ƒ</h4>
                                <div class="detail-section-content">
                                    <p>æ­¤æ¨¡å‹æ¥æºäºæ€è€ƒè®°å½•: <span style="color: var(--accent-color); font-weight: 500; cursor: pointer;" onclick="showThoughtDetail('${model.fromThought}')">${model.fromThought}</span></p>
                                    <p style="font-size: 0.9rem; color: var(--text-light); margin-top: 5px;">
                                        <i class="fas fa-lightbulb"></i> ç¼–è¾‘æ­¤æ¨¡å‹æ—¶ï¼Œå¯ä»¥ç‚¹å‡»"ä»æ¥æºæ€è€ƒè‡ªåŠ¨æå–"æŒ‰é’®ï¼Œç³»ç»Ÿä¼šä»"æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"éƒ¨åˆ†æå–å…³è”æ¨¡å‹IDå’Œæ¨¡å‹æè¿°ã€‚
                                    </p>
                                </div>
                            </div>
                        `;
                    }
                    
                    // æ˜¾ç¤ºå…³è”æ¨¡å‹
                    if (relatedModels.length > 0) {
                        html += `
                            <div class="detail-section">
                                <h4><i class="fas fa-project-diagram"></i> å…³è”æ¨¡å‹ (${relatedModels.length}ä¸ª)</h4>
                                <div class="detail-section-content">
                                    <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px;">
                                        ${relatedModels.map(id => {
                                            const relatedModel = DataStore.getModelById(id);
                                            if (relatedModel) {
                                                return `<span class="network-node" onclick="showModelDetail('${id}')" style="cursor: pointer;">${id} - ${relatedModel.name.substring(0, 20)}${relatedModel.name.length > 20 ? '...' : ''}</span>`;
                                            } else {
                                                return `<span class="network-node" style="background-color: rgba(244, 67, 54, 0.1); color: var(--danger-color);">${id} (æœªæ‰¾åˆ°)</span>`;
                                            }
                                        }).join('')}
                                    </div>
                                </div>
                            </div>
                        `;
                    }
                    
                    // æ˜¾ç¤ºå…³è”ç½‘ç»œ
                    if (network && network.connections.length > 0) {
                        html += `
                            <div class="detail-section">
                                <h4><i class="fas fa-project-diagram"></i> å…³è”ç½‘ç»œ</h4>
                                <div class="detail-section-content">
                                    <p>æ­¤æ¨¡å‹ä¸ä»¥ä¸‹ ${network.connections.length} ä¸ªæ¨¡å‹ç›¸å…³è”ï¼š</p>
                                    <div class="network-visualization" style="margin-top: 10px;">
                                        <div class="network-node center">${model.id}</div>
                        `;
                        
                        network.connections.forEach(connectedModel => {
                            html += `
                                <div class="network-connection"></div>
                                <div class="network-node" onclick="showModelDetail('${connectedModel.id}')">${connectedModel.id}</div>
                            `;
                        });
                        
                        html += `
                                    </div>
                                </div>
                            </div>
                        `;
                    }
                    
                    html += `</div>`;
                    return html;
                }
            },
            
            // ==================== æ–°å¢ï¼šå…³è”æ¨¡å‹ç¼–è¾‘åŠŸèƒ½ ====================
            renderRelatedModelsList: function(relatedModels) {
                if (!relatedModels || relatedModels.length === 0) {
                    return '<div style="color: var(--text-light); text-align: center; padding: 10px;">æš‚æ— å…³è”æ¨¡å‹</div>';
                }
                
                let html = '';
                relatedModels.forEach((modelId, index) => {
                    const model = DataStore.getModelById(modelId);
                    const modelName = model ? model.name : 'æœªçŸ¥æ¨¡å‹';
                    
                    html += `
                        <div class="related-model-tag">
                            <span>${modelId}</span>
                            <span class="remove" onclick="UIManager.removeRelatedModel(${index})">Ã—</span>
                        </div>
                    `;
                });
                
                return html;
            },
            
            addRelatedModelFromInput: function() {
                const input = document.getElementById('edit-related-models-input');
                if (!input || !input.value.trim()) return;
                
                // è§£æè¾“å…¥çš„æ¨¡å‹IDï¼ˆæ”¯æŒç©ºæ ¼ã€é€—å·åˆ†éš”ï¼‰
                const inputText = input.value.trim();
                const modelIds = inputText.split(/[,\s]+/).filter(id => id.trim());
                
                // éªŒè¯å¹¶æ·»åŠ æ¨¡å‹ID
                modelIds.forEach(modelId => {
                    const cleanId = modelId.trim().toUpperCase();
                    if (cleanId.match(/^M-\d+$/) && !this.currentRelatedModels.includes(cleanId)) {
                        this.currentRelatedModels.push(cleanId);
                    }
                });
                
                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('related-models-list').innerHTML = this.renderRelatedModelsList(this.currentRelatedModels);
                
                // æ¸…ç©ºè¾“å…¥æ¡†
                input.value = '';
            },
            
            removeRelatedModel: function(index) {
                if (index >= 0 && index < this.currentRelatedModels.length) {
                    this.currentRelatedModels.splice(index, 1);
                    document.getElementById('related-models-list').innerHTML = this.renderRelatedModelsList(this.currentRelatedModels);
                }
            },
            
            autoExtractRelatedModels: function() {
                const model = DataStore.getModelById(this.currentEditingModelId);
                if (!model || !model.fromThought) {
                    alert('æ­¤æ¨¡å‹æ²¡æœ‰æŒ‡å®šæ¥æºæ€è€ƒï¼Œæ— æ³•è‡ªåŠ¨æå–å…³è”æ¨¡å‹');
                    return;
                }
                
                // ä»æ¥æºæ€è€ƒçš„"æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"ä¸­æå–æ¨¡å‹ID
                const thought = DataStore.getThoughtById(model.fromThought);
                if (!thought || !thought.sections || !thought.sections["æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"]) {
                    alert('åœ¨æ¥æºæ€è€ƒä¸­æœªæ‰¾åˆ°æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆéƒ¨åˆ†');
                    return;
                }
                
                const modelSection = thought.sections["æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"];
                const modelIds = modelSection.match(/M-\d+/g) || [];
                
                if (modelIds.length === 0) {
                    alert(`åœ¨æ€è€ƒè®°å½• ${model.fromThought} çš„"æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"éƒ¨åˆ†æœªæ‰¾åˆ°æ¨¡å‹ID`);
                    return;
                }
                
                // è¿‡æ»¤æ‰å½“å‰æ¨¡å‹è‡ªèº«
                const filteredIds = modelIds.filter(id => id !== model.id);
                
                // æ·»åŠ åˆ°å½“å‰å…³è”æ¨¡å‹åˆ—è¡¨ï¼ˆå»é‡ï¼‰
                filteredIds.forEach(id => {
                    if (!this.currentRelatedModels.includes(id)) {
                        this.currentRelatedModels.push(id);
                    }
                });
                
                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('related-models-list').innerHTML = this.renderRelatedModelsList(this.currentRelatedModels);
                
                // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                this.showAlert(`ä»æ€è€ƒè®°å½• ${model.fromThought} ä¸­æå–äº† ${filteredIds.length} ä¸ªå…³è”æ¨¡å‹`, 'success');
            },
            
            // ==================== æœç´¢åŠŸèƒ½ ====================
            performSearch: function(query) {
                if (!query.trim()) {
                    // å¦‚æœæœç´¢æ¡†ä¸ºç©ºï¼Œé‡æ–°åŠ è½½å½“å‰è§†å›¾
                    this.loadView(this.currentView);
                    return;
                }
                
                const searchTerm = query.toLowerCase();
                const categoryFilter = document.getElementById('category-filter').value;
                const themeFilter = document.getElementById('theme-filter').value;
                
                // æœç´¢æ€è€ƒè®°å½•
                const filteredThoughts = DataStore.thoughts.filter(thought => {
                    if (categoryFilter === 'model') return false;
                    
                    const matchesSearch = (
                        (thought.title && thought.title.toLowerCase().includes(searchTerm)) ||
                        (thought.id && thought.id.toLowerCase().includes(searchTerm)) ||
                        (thought.tags && thought.tags.some(tag => tag.toLowerCase().includes(searchTerm))) ||
                        (thought.sections && Object.values(thought.sections).some(section => 
                            section.toLowerCase().includes(searchTerm)
                        ))
                    );
                    
                    const matchesTheme = themeFilter === 'all' || 
                        (thought.tags && thought.tags.some(tag => this.tagMatchesTheme(tag, themeFilter)));
                    
                    return matchesSearch && matchesTheme;
                });
                
                // æœç´¢æ€ç»´æ¨¡å‹
                const filteredModels = DataStore.models.filter(model => {
                    if (categoryFilter === 'thought') return false;
                    
                    const matchesSearch = (
                        (model.name && model.name.toLowerCase().includes(searchTerm)) ||
                        (model.id && model.id.toLowerCase().includes(searchTerm)) ||
                        (model.tags && model.tags.some(tag => tag.toLowerCase().includes(searchTerm))) ||
                        (model.description && model.description.toLowerCase().includes(searchTerm))
                    );
                    
                    const matchesTheme = themeFilter === 'all' || 
                        (model.tags && model.tags.some(tag => this.tagMatchesTheme(tag, themeFilter)));
                    
                    return matchesSearch && matchesTheme;
                });
                
                // æ¸²æŸ“æœç´¢ç»“æœ
                this.renderSearchResults(query, filteredThoughts, filteredModels);
            },
            
            tagMatchesTheme: function(tag, theme) {
                const themeMapping = {
                    'emotion': ['äº²å¯†å…³ç³»', 'æƒ…æ„Ÿ', 'å¤±å»', 'å‘Šåˆ«', 'æœŸæœ›'],
                    'philosophy': ['å“²å­¦', 'å­˜åœ¨', 'æ™ºæ…§', 'æ—¶é—´', 'å®¿å‘½'],
                    'growth': ['æˆé•¿', 'å†ç¨‹', 'è§‰é†’', 'éŸ§æ€§'],
                    'society': ['ç¤¾ä¼š', 'ç³»ç»Ÿ', 'ç»“æ„', 'æƒåŠ›', 'ä¼¦ç†'],
                    'aesthetics': ['è‰ºæœ¯', 'è¡¨è¾¾', 'è±¡å¾', 'å™äº‹', 'ç¾å­¦']
                };
                
                const themeKeywords = themeMapping[theme] || [];
                return themeKeywords.some(keyword => tag.includes(keyword));
            },
            
            renderSearchResults: function(query, thoughts, models) {
                let resultsHTML = '';
                
                if (thoughts.length > 0) {
                    thoughts.forEach(thought => {
                        resultsHTML += `
                            <div class="record-card" onclick="showThoughtDetail('${thought.id}')">
                                <div class="record-id">${thought.id}</div>
                                <div class="record-title">${thought.title || 'æ— æ ‡é¢˜'}</div>
                                <div class="record-tags">
                                    ${thought.tags ? thought.tags.map(tag => `<span class="tag">${tag}</span>`).join('') : ''}
                                </div>
                            </div>
                        `;
                    });
                }
                
                if (models.length > 0) {
                    models.forEach(model => {
                        resultsHTML += `
                            <div class="model-card" onclick="showModelDetail('${model.id}')">
                                <div class="model-id">${model.id}</div>
                                <div class="model-name">${model.name}</div>
                                <div class="model-tags">
                                    ${model.tags ? model.tags.map(tag => `<span class="tag">${tag}</span>`).join('') : ''}
                                </div>
                            </div>
                        `;
                    });
                }
                
                const html = `
                    <div class="content-header">
                        <h2>æœç´¢ç»“æœ</h2>
                        <p>æœç´¢å…³é”®è¯: "${query}" | æ‰¾åˆ° ${thoughts.length + models.length} ä¸ªç»“æœ</p>
                    </div>
                    
                    <div class="records-list">
                        ${resultsHTML || '<div class="empty-state"><i class="fas fa-search"></i><p>æœªæ‰¾åˆ°ç›¸å…³ç»“æœ</p></div>'}
                    </div>
                `;
                
                document.getElementById('content-area').innerHTML = html;
            },
            
            // ==================== æ–°å¢ï¼šæ•°æ®æ“ä½œåŠŸèƒ½ ====================
            exportCurrentItem: function() {
                let item = null;
                let type = null;
                let name = '';
                
                // æ£€æŸ¥å½“å‰æ˜¯å¦æœ‰é€‰ä¸­çš„é¡¹ç›®
                if (UIManager.currentView === 'thoughts' || UIManager.currentView === 'add-structured') {
                    // å¦‚æœåœ¨æ€è€ƒç›¸å…³è§†å›¾ï¼Œå°è¯•è·å–å½“å‰æ€è€ƒ
                    const thought = DataStore.getThoughtById("#123"); // é»˜è®¤ç¤ºä¾‹
                    if (thought) {
                        item = thought;
                        type = 'thought';
                        name = thought.title;
                    }
                } else if (UIManager.currentView === 'models' || UIManager.currentView === 'add-model') {
                    // å¦‚æœåœ¨æ¨¡å‹ç›¸å…³è§†å›¾ï¼Œå°è¯•è·å–å½“å‰æ¨¡å‹
                    const model = DataStore.getModelById("M-80"); // é»˜è®¤ç¤ºä¾‹
                    if (model) {
                        item = model;
                        type = 'model';
                        name = model.name;
                    }
                }
                
                if (!item) {
                    alert('å½“å‰æ²¡æœ‰å¯å¯¼å‡ºçš„é¡¹ç›®');
                    return;
                }
                
                const data = DataStore.exportCurrentItem(type, item.id);
                if (!data) {
                    alert('å¯¼å‡ºå¤±è´¥ï¼šæ— æ³•è·å–é¡¹ç›®æ•°æ®');
                    return;
                }
                
                this.downloadFile(data, `${item.id}_${name.replace(/[^\w]/g, '_')}.json`);
                this.showAlert('å¯¼å‡ºæˆåŠŸ', 'success');
            },
            
            exportAllData: function() {
                const data = DataStore.exportAllData();
                const date = new Date().toISOString().split('T')[0];
                this.downloadFile(data, `æ€ç»´ååŒå¤„ç†å™¨_å¤‡ä»½_${date}.json`);
                this.showAlert('å…¨éƒ¨æ•°æ®å¯¼å‡ºæˆåŠŸ', 'success');
            },
            
            backupAllData: function() {
                const result = DataStore.backupData();
                if (result.success) {
                    this.showAlert('æ•°æ®å¤‡ä»½åˆ›å»ºæˆåŠŸ', 'success');
                    // åˆ·æ–°æ•°æ®ç®¡ç†è§†å›¾
                    if (this.currentView === 'data-management') {
                        this.renderDataManagement();
                    }
                } else {
                    this.showAlert('å¤‡ä»½å¤±è´¥ï¼š' + result.error, 'error');
                }
            },
            
            importData: function() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (!file) return;
                    
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const result = DataStore.importData(event.target.result);
                            if (result.success) {
                                this.showAlert(result.message, 'success');
                                // é‡æ–°åŠ è½½å½“å‰è§†å›¾
                                this.loadView(this.currentView);
                                // æ›´æ–°ç½‘ç»œå›¾
                                this.updateNetworkGraph();
                            } else {
                                this.showAlert('å¯¼å…¥å¤±è´¥ï¼š' + result.error, 'error');
                            }
                        } catch (error) {
                            this.showAlert('æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼š' + error.message, 'error');
                        }
                    };
                    reader.readAsText(file);
                };
                
                input.click();
            },
            
            restoreBackup: function(backupKey) {
                if (!confirm('ç¡®å®šè¦æ¢å¤æ­¤å¤‡ä»½å—ï¼Ÿå½“å‰æ•°æ®å°†è¢«è¦†ç›–ã€‚')) {
                    return;
                }
                
                try {
                    const backupData = localStorage.getItem(backupKey);
                    if (!backupData) {
                        alert('å¤‡ä»½æ•°æ®ä¸å­˜åœ¨æˆ–å·²æŸå');
                        return;
                    }
                    
                    const result = DataStore.importData(backupData);
                    if (result.success) {
                        this.showAlert('å¤‡ä»½æ¢å¤æˆåŠŸ', 'success');
                        // é‡æ–°åŠ è½½å½“å‰è§†å›¾
                        this.loadView(this.currentView);
                        // æ›´æ–°ç½‘ç»œå›¾
                        this.updateNetworkGraph();
                    } else {
                        this.showAlert('æ¢å¤å¤±è´¥ï¼š' + result.error, 'error');
                    }
                } catch (error) {
                    this.showAlert('æ¢å¤å¤±è´¥ï¼š' + error.message, 'error');
                }
            },
            
            deleteBackup: function(backupKey) {
                if (!confirm('ç¡®å®šè¦åˆ é™¤æ­¤å¤‡ä»½å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
                    return;
                }
                
                localStorage.removeItem(backupKey);
                this.showAlert('å¤‡ä»½å·²åˆ é™¤', 'success');
                
                // åˆ·æ–°æ•°æ®ç®¡ç†è§†å›¾
                if (this.currentView === 'data-management') {
                    this.renderDataManagement();
                }
            },
            
            resetData: function() {
                if (!confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ•°æ®å—ï¼Ÿè¿™å°†åˆ é™¤æ‰€æœ‰è‡ªå®šä¹‰å†…å®¹ï¼Œæ¢å¤ä¸ºé»˜è®¤æ•°æ®ã€‚æ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
                    return;
                }
                
                localStorage.removeItem('structuredThoughtAssistant');
                location.reload(); // é‡æ–°åŠ è½½é¡µé¢
            },
            
            downloadFile: function(data, filename) {
                const blob = new Blob([data], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            },
            
            showAlert: function(message, type = 'info') {
                const alertClass = type === 'success' ? 'alert-success' : 'alert-info';
                const icon = type === 'success' ? 'fa-check-circle' : 'fa-info-circle';
                
                const alertHtml = `
                    <div class="alert ${alertClass}">
                        <i class="fas ${icon}"></i> 
                        ${message}
                    </div>
                `;
                
                const contentArea = document.getElementById('content-area');
                contentArea.insertAdjacentHTML('afterbegin', alertHtml);
                
                setTimeout(() => {
                    const alertElement = contentArea.querySelector('.alert');
                    if (alertElement) {
                        alertElement.remove();
                    }
                }, 3000);
            },
            
            // ==================== åˆ é™¤æ¨¡æ€æ¡† ====================
            openDeleteModal: function(type, id) {
                this.itemToDelete = id;
                this.deleteType = type;
                
                let itemName = '';
                if (type === 'thought') {
                    const thought = DataStore.getThoughtById(id);
                    itemName = thought ? (thought.title || thought.id) : id;
                } else if (type === 'model') {
                    const model = DataStore.getModelById(id);
                    itemName = model ? (model.name || model.id) : id;
                } else if (type === 'timeline') {
                    const timelineItem = DataStore.getTimelineById(id);
                    itemName = timelineItem ? timelineItem.version : id;
                }
                
                const modal = document.getElementById('delete-modal');
                const message = document.getElementById('delete-message');
                
                if (type === 'thought') {
                    message.textContent = `ç¡®å®šè¦åˆ é™¤æ€è€ƒè®°å½• "${itemName}" å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚`;
                } else if (type === 'model') {
                    message.textContent = `ç¡®å®šè¦åˆ é™¤æ€ç»´æ¨¡å‹ "${itemName}" å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚`;
                } else if (type === 'timeline') {
                    message.textContent = `ç¡®å®šè¦åˆ é™¤ç³»ç»Ÿæ¼”è¿›è®°å½• "${itemName}" å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚`;
                }
                
                modal.style.display = 'flex';
            },
            
            closeDeleteModal: function() {
                const modal = document.getElementById('delete-modal');
                modal.style.display = 'none';
                this.itemToDelete = null;
                this.deleteType = null;
            },
            
            // ==================== æ ‡ç­¾å¤æ ¸åŠŸèƒ½ ====================
            openTagReview: function(type, id) {
                this.tagReviewItem = id;
                this.tagReviewType = type;
                
                let item;
                if (type === 'thought') {
                    item = DataStore.getThoughtById(id);
                } else if (type === 'model') {
                    item = DataStore.getModelById(id);
                }
                
                if (!item) return;
                
                // ä¿å­˜å½“å‰æ ‡ç­¾
                this.currentTagsForReview = [...(item.tags || [])];
                
                // è®¾ç½®æ ‡é¢˜
                const titleEl = document.getElementById('tag-review-title');
                if (titleEl) {
                    titleEl.textContent = `${type === 'model' ? 'æ¨¡å‹' : 'æ€è€ƒè®°å½•'}: ${item.title || item.name || item.id}`;
                }
                
                // æ¸²æŸ“å½“å‰æ ‡ç­¾
                this.renderTagReviewTags();
                
                // æ˜¾ç¤ºæ¨¡æ€æ¡†
                document.getElementById('tag-review-modal').style.display = 'flex';
            },
            
            renderTagReviewTags: function() {
                const container = document.getElementById('current-tags-container');
                if (!container) return;
                
                if (this.currentTagsForReview.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-light); text-align: center; padding: 20px;">æš‚æ— æ ‡ç­¾</p>';
                    return;
                }
                
                let html = '';
                this.currentTagsForReview.forEach((tag, index) => {
                    const count = DataStore.tags[tag] || 0;
                    html += `
                        <div class="tag-item" data-index="${index}" style="display: inline-flex; align-items: center; background-color: white; padding: 6px 12px; border-radius: 20px; margin-right: 10px; margin-bottom: 10px; border: 1px solid var(--border-color); transition: var(--transition);">
                            <span class="tag-text" style="margin-right: 8px;">${tag}</span>
                            <span class="tag-remove" onclick="removeTagFromReview(${index})" style="width: 18px; height: 18px; border-radius: 50%; background-color: var(--light-bg); display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 0.7rem; color: var(--text-light);">Ã—</span>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            },
            
            closeTagReviewModal: function() {
                document.getElementById('tag-review-modal').style.display = 'none';
                this.tagReviewItem = null;
                this.tagReviewType = null;
                this.currentTagsForReview = [];
                
                // æ¸…ç©ºè¾“å…¥æ¡†
                const input = document.getElementById('new-tag-input');
                if (input) input.value = '';
            },
            
            saveTagReview: function() {
                // è¿™é‡Œåªæ˜¯æ›´æ–°æœ¬åœ°æ•°ç»„ï¼Œå®é™…ä¿å­˜éœ€è¦è°ƒç”¨applyTagReview
                this.renderTagReviewTags();
            },
            
            applyTagReview: function() {
                if (!this.tagReviewItem || !this.tagReviewType) return;
                
                // æ›´æ–°æ•°æ®
                if (this.tagReviewType === 'thought') {
                    const thought = DataStore.getThoughtById(this.tagReviewItem);
                    if (thought) {
                        thought.tags = [...this.currentTagsForReview];
                        DataStore.updateThought(this.tagReviewItem, thought);
                    }
                } else if (this.tagReviewType === 'model') {
                    const model = DataStore.getModelById(this.tagReviewItem);
                    if (model) {
                        model.tags = [...this.currentTagsForReview];
                        DataStore.updateModel(this.tagReviewItem, model);
                    }
                }
                
                // æ›´æ–°UI
                this.updateTagCloud();
                
                // å…³é—­æ¨¡æ€æ¡†
                this.closeTagReviewModal();
                
                // é‡æ–°æ˜¾ç¤ºå½“å‰é¡¹ç›®
                if (this.tagReviewType === 'thought') {
                    showThoughtDetail(this.tagReviewItem);
                } else {
                    showModelDetail(this.tagReviewItem);
                }
                
                // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                this.showAlert('æ ‡ç­¾å·²æ›´æ–°', 'success');
            }
        };
        
        // ==================== å…¨å±€å‡½æ•° ====================
        function parseAndPreview() {
            const input = document.getElementById('structured-input');
            if (!input || !input.value.trim()) {
                alert('è¯·è¾“å…¥è¦è§£æçš„å†…å®¹');
                return;
            }
            
            const thought = DataStore.parseStructuredContent(input.value);
            const previewDiv = document.getElementById('parse-preview');
            
            if (previewDiv) {
                previewDiv.style.display = 'block';
                let sectionsHtml = '';
                
                // æ˜¾ç¤ºè§£æåˆ°çš„éƒ¨åˆ†
                Object.keys(thought.sections).forEach(sectionName => {
                    const content = thought.sections[sectionName];
                    sectionsHtml += `
                        <div style="margin-bottom: 15px; padding: 10px; background-color: #f8f9fa; border-radius: 4px;">
                            <div style="font-weight: bold; color: var(--accent-color); margin-bottom: 5px;">
                                ${sectionName}
                            </div>
                            <div style="font-size: 0.9rem; color: var(--text-light); max-height: 100px; overflow: auto;">
                                ${content.substring(0, 200)}${content.length > 200 ? '...' : ''}
                            </div>
                        </div>
                    `;
                });
                
                previewDiv.innerHTML = `
                    <h4><i class="fas fa-check-circle"></i> è§£ææˆåŠŸ</h4>
                    <p><strong>æ€è€ƒID:</strong> ${thought.id}</p>
                    <p><strong>æ€è€ƒä¸»é¢˜:</strong> ${thought.title}</p>
                    <p><strong>æ€è€ƒç±»å‹:</strong> ${thought.type || 'æœªè¯†åˆ«'}</p>
                    <p><strong>ç³»ç»Ÿç‰ˆæœ¬:</strong> ${thought.systemVersion}</p>
                    <p><strong>å…³é”®æ ‡è®°:</strong> ${thought.tags ? thought.tags.map(tag => `<span class="tag">${tag}</span>`).join(' ') : 'æ— '}</p>
                    <p><strong>è§£æåˆ°çš„éƒ¨åˆ† (${Object.keys(thought.sections).length}):</strong> ${Object.keys(thought.sections).map(s => `<span class="tag">${s}</span>`).join(' ')}</p>
                    ${sectionsHtml}
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--success-color);">
                        <i class="fas fa-check"></i> è§£æå®Œæˆï¼Œç‚¹å‡»"ä¿å­˜æ€è€ƒ"æŒ‰é’®ä¿å­˜åˆ°ç³»ç»Ÿ
                    </div>
                `;
            }
        }
        
        function saveStructuredThought() {
            const input = document.getElementById('structured-input');
            if (!input || !input.value.trim()) {
                alert('è¯·è¾“å…¥æ€è€ƒå†…å®¹');
                return;
            }
            
            const thought = DataStore.addStructuredThought(input.value);
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            UIManager.showAlert(`æ€è€ƒè®°å½•å·²ä¿å­˜: ${thought.id}ã€‚ç³»ç»Ÿå·²æ™ºèƒ½è§£æå¹¶å½’ç±»ï¼`, 'success');
            
            // åˆ·æ–°å½“å‰è§†å›¾
            UIManager.loadView(UIManager.currentView);
            
            // æ›´æ–°ç´¢å¼•å’Œæ ‡ç­¾äº‘
            DataStore.updateUIStats();
            
            console.log('ç»“æ„åŒ–æ€è€ƒè®°å½•å·²ä¿å­˜:', thought);
        }
        
        function saveModel() {
            const idInput = document.getElementById('model-id');
            const nameInput = document.getElementById('model-name');
            const fromThoughtInput = document.getElementById('model-from-thought');
            const descInput = document.getElementById('model-description');
            
            if (!nameInput || !nameInput.value.trim()) {
                alert('è¯·è¾“å…¥æ¨¡å‹åç§°');
                return;
            }
            
            if (!descInput || !descInput.value.trim()) {
                alert('è¯·è¾“å…¥æ¨¡å‹æè¿°');
                return;
            }
            
            const model = DataStore.addModel({
                id: idInput && idInput.value.trim() ? idInput.value.trim() : undefined,
                name: nameInput.value.trim(),
                description: descInput.value.trim(),
                date: new Date().toISOString().split('T')[0],
                tags: [],
                fromThought: fromThoughtInput && fromThoughtInput.value.trim() ? fromThoughtInput.value.trim() : null
            });
            
            // æ¸…ç©ºè¾“å…¥
            if (idInput) idInput.value = '';
            if (nameInput) nameInput.value = '';
            if (fromThoughtInput) fromThoughtInput.value = '';
            if (descInput) descInput.value = '';
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            UIManager.showAlert(`æ€ç»´æ¨¡å‹å·²ä¿å­˜: ${model.id}`, 'success');
            
            // åˆ·æ–°å½“å‰è§†å›¾
            UIManager.loadView(UIManager.currentView);
            
            // æ›´æ–°ç´¢å¼•
            DataStore.updateUIStats();
        }
        
        function showThoughtDetail(id, isEditing = false) {
            const thought = DataStore.getThoughtById(id);
            const contentArea = document.getElementById('content-area');
            
            if (!thought) {
                contentArea.innerHTML = '<div class="empty-state"><i class="fas fa-search"></i><p>æœªæ‰¾åˆ°æ€è€ƒè®°å½•</p></div>';
                return;
            }
            
            contentArea.innerHTML = UIManager.renderThoughtDetail(thought, isEditing);
        }
        
        function showModelDetail(id, isEditing = false) {
            const model = DataStore.getModelById(id);
            const contentArea = document.getElementById('content-area');
            
            if (!model) {
                contentArea.innerHTML = '<div class="empty-state"><i class="fas fa-search"></i><p>æœªæ‰¾åˆ°æ€ç»´æ¨¡å‹</p></div>';
                return;
            }
            
            contentArea.innerHTML = UIManager.renderModelDetail(model, isEditing);
        }
        
        function editThought(id) {
            showThoughtDetail(id, true);
        }
        
        function editModel(id) {
            showModelDetail(id, true);
        }
        
        function updateThought(id) {
            const input = document.getElementById('edit-structured-input');
            if (!input || !input.value.trim()) {
                alert('è¯·è¾“å…¥æ€è€ƒå†…å®¹');
                return;
            }
            
            const updatedThought = DataStore.parseStructuredContent(input.value);
            updatedThought.id = id; // ä¿æŒåŸID
            
            const success = DataStore.updateThought(id, updatedThought);
            
            if (success) {
                UIManager.showAlert(`æ€è€ƒè®°å½•å·²æ›´æ–°: ${updatedThought.id}`, 'success');
                
                // æ˜¾ç¤ºæ›´æ–°åçš„å†…å®¹
                showThoughtDetail(id);
                
                // æ›´æ–°ç´¢å¼•
                DataStore.updateUIStats();
            } else {
                alert('æ›´æ–°å¤±è´¥: æœªæ‰¾åˆ°è¯¥æ€è€ƒè®°å½•');
            }
        }
        
        function updateModel(id) {
            const idInput = document.getElementById('edit-model-id');
            const nameInput = document.getElementById('edit-model-name');
            const descInput = document.getElementById('edit-model-description');
            
            if (!nameInput || !nameInput.value.trim()) {
                alert('è¯·è¾“å…¥æ¨¡å‹åç§°');
                return;
            }
            
            if (!descInput || !descInput.value.trim()) {
                alert('è¯·è¾“å…¥æ¨¡å‹æè¿°');
                return;
            }
            
            // è·å–å…³è”æ¨¡å‹
            const relatedModels = UIManager.currentRelatedModels;
            
            const updatedModel = {
                id: idInput && idInput.value.trim() ? idInput.value.trim() : id,
                name: nameInput.value.trim(),
                description: descInput.value.trim(),
                date: new Date().toISOString().split('T')[0],
                tags: [],
                relatedModels: relatedModels
            };
            
            // è·å–åŸå§‹æ¨¡å‹ä»¥ä¿ç•™fromThoughtå­—æ®µ
            const originalModel = DataStore.getModelById(id);
            if (originalModel && originalModel.fromThought) {
                updatedModel.fromThought = originalModel.fromThought;
            }
            
            const success = DataStore.updateModel(id, updatedModel);
            
            if (success) {
                UIManager.showAlert(`æ€ç»´æ¨¡å‹å·²æ›´æ–°: ${updatedModel.id}`, 'success');
                
                // æ˜¾ç¤ºæ›´æ–°åçš„å†…å®¹
                showModelDetail(updatedModel.id);
                
                // æ›´æ–°ç´¢å¼•
                DataStore.updateUIStats();
                
                // é‡ç½®ç¼–è¾‘çŠ¶æ€
                UIManager.currentEditingModelId = null;
                UIManager.currentRelatedModels = [];
            } else {
                alert('æ›´æ–°å¤±è´¥: æœªæ‰¾åˆ°è¯¥æ¨¡å‹');
            }
        }
        
        function openDeleteModal(type, id) {
            UIManager.openDeleteModal(type, id);
        }
        
        function closeDeleteModal() {
            UIManager.closeDeleteModal();
        }
        
        function confirmDelete() {
            const id = UIManager.itemToDelete;
            const type = UIManager.deleteType;
            
            let success = false;
            let itemName = '';
            
            if (type === 'thought') {
                const thought = DataStore.getThoughtById(id);
                if (thought) {
                    itemName = thought.title || thought.id;
                }
                success = DataStore.deleteThought(id);
            } else if (type === 'model') {
                const model = DataStore.getModelById(id);
                if (model) {
                    itemName = model.name || model.id;
                }
                success = DataStore.deleteModel(id);
            } else if (type === 'timeline') {
                const timelineItem = DataStore.getTimelineById(id);
                if (timelineItem) {
                    itemName = timelineItem.version;
                }
                success = DataStore.deleteTimelineItem(id);
                // å¦‚æœåˆ é™¤çš„æ˜¯å½“å‰æ˜¾ç¤ºçš„æ—¶é—´çº¿é¡¹ç›®ï¼Œéšè—è¯¦æƒ…
                if (UIManager.currentTimelineItem && UIManager.currentTimelineItem.id === id) {
                    UIManager.currentTimelineItem = null;
                }
            }
            
            if (success) {
                // å…³é—­æ¨¡æ€æ¡†
                closeDeleteModal();
                
                // è¿”å›ä¸»è§†å›¾
                UIManager.loadView(UIManager.currentView);
                
                // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                UIManager.showAlert(`å·²æˆåŠŸåˆ é™¤: ${itemName}`, 'success');
                
                // æ›´æ–°ç´¢å¼•
                DataStore.updateUIStats();
            } else {
                alert('åˆ é™¤å¤±è´¥: æœªæ‰¾åˆ°è¯¥é¡¹ç›®');
                closeDeleteModal();
            }
        }
        
        function filterByTag(tag) {
            const thoughtsWithTag = DataStore.thoughts.filter(thought => 
                thought.tags && thought.tags.includes(tag)
            );
            
            const modelsWithTag = DataStore.models.filter(model => 
                model.tags && model.tags.includes(tag)
            );
            
            const contentArea = document.getElementById('content-area');
            
            let html = `
                <div class="content-header">
                    <h2>æ ‡ç­¾: ${tag}</h2>
                    <p>æ‰¾åˆ° ${thoughtsWithTag.length + modelsWithTag.length} æ¡ç›¸å…³å†…å®¹</p>
                    <button class="btn btn-secondary" onclick="UIManager.loadView('keywords')">
                        <i class="fas fa-arrow-left"></i> è¿”å›æ ‡ç­¾é¡µ
                    </button>
                </div>
            `;
            
            if (thoughtsWithTag.length > 0) {
                html += `
                    <div class="detail-section">
                        <h4><i class="fas fa-stream"></i> ç›¸å…³æ€è€ƒè®°å½• (${thoughtsWithTag.length})</h4>
                        <div class="records-list" style="margin-top: 10px;">
                `;
                
                thoughtsWithTag.forEach(thought => {
                    html += `
                        <div class="record-card" onclick="showThoughtDetail('${thought.id}')">
                            <div class="record-id">${thought.id}</div>
                            <div class="record-title">${thought.title || 'æ— æ ‡é¢˜'}</div>
                        </div>
                    `;
                });
                
                html += `</div></div>`;
            }
            
            if (modelsWithTag.length > 0) {
                html += `
                    <div class="detail-section">
                        <h4><i class="fas fa-cube"></i> ç›¸å…³æ€ç»´æ¨¡å‹ (${modelsWithTag.length})</h4>
                        <div class="models-list" style="margin-top: 10px;">
                `;
                
                modelsWithTag.forEach(model => {
                    html += `
                        <div class="model-card" onclick="showModelDetail('${model.id}')">
                            <div class="model-id">${model.id}</div>
                            <div class="model-name">${model.name}</div>
                        </div>
                    `;
                });
                
                html += `</div></div>`;
            }
            
            if (thoughtsWithTag.length === 0 && modelsWithTag.length === 0) {
                html += '<div class="empty-state"><i class="fas fa-search"></i><p>æš‚æ— ç›¸å…³å†…å®¹</p></div>';
            }
            
            contentArea.innerHTML = html;
        }
        
        // ==================== æ ‡ç­¾å¤æ ¸ç›¸å…³å‡½æ•° ====================
        function openTagReview(type, id) {
            UIManager.openTagReview(type, id);
        }
        
        function closeTagReviewModal() {
            UIManager.closeTagReviewModal();
        }
        
        function removeTagFromReview(index) {
            if (index >= 0 && index < UIManager.currentTagsForReview.length) {
                UIManager.currentTagsForReview.splice(index, 1);
                UIManager.renderTagReviewTags();
            }
        }
        
        function addNewTag() {
            const tag = prompt('è¯·è¾“å…¥æ–°æ ‡ç­¾:');
            if (tag && tag.trim()) {
                UIManager.currentTagsForReview.push(tag.trim());
                UIManager.renderTagReviewTags();
            }
        }
        
        function addTagFromInput() {
            const input = document.getElementById('new-tag-input');
            const tag = input.value.trim();
            if (tag) {
                if (!UIManager.currentTagsForReview.includes(tag)) {
                    UIManager.currentTagsForReview.push(tag);
                    UIManager.renderTagReviewTags();
                }
                input.value = '';
            }
        }
        
        function addSuggestedTag(tag) {
            if (!UIManager.currentTagsForReview.includes(tag)) {
                UIManager.currentTagsForReview.push(tag);
                UIManager.renderTagReviewTags();
            }
        }
        
        function addSuggestedTagToReview(tag) {
            // ç›´æ¥ä»æ ‡ç­¾å¤æ ¸é¡µé¢æ·»åŠ æ ‡ç­¾åˆ°å½“å‰å¤æ ¸é¡¹ç›®
            if (UIManager.tagReviewItem && UIManager.tagReviewType) {
                if (!UIManager.currentTagsForReview.includes(tag)) {
                    UIManager.currentTagsForReview.push(tag);
                    UIManager.renderTagReviewTags();
                }
            } else {
                // å¦‚æœæ²¡æœ‰æ‰“å¼€æ ‡ç­¾å¤æ ¸æ¨¡æ€æ¡†ï¼Œåˆ™æç¤ºç”¨æˆ·
                alert('è¯·å…ˆæ‰“å¼€æ ‡ç­¾å¤æ ¸åŠŸèƒ½');
            }
        }
        
        function saveTagReview() {
            UIManager.saveTagReview();
        }
        
        function applyTagReview() {
            UIManager.applyTagReview();
        }
        
        // ==================== æ–°å¢ï¼šåˆ†æ®µç¼–è¾‘ç›¸å…³å‡½æ•° ====================
        function validateThoughtId() {
            const idInput = document.getElementById('edit-thought-id');
            const id = idInput.value.trim();
            
            if (!id) {
                alert('æ€è€ƒIDä¸èƒ½ä¸ºç©º');
                return false;
            }
            
            if (!id.startsWith('#')) {
                alert('æ€è€ƒIDåº”ä»¥#å¼€å¤´ï¼Œä¾‹å¦‚ï¼š#123');
                return false;
            }
            
            // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ï¼ˆæ’é™¤å½“å‰æ­£åœ¨ç¼–è¾‘çš„æ€è€ƒï¼‰
            const existingThought = DataStore.getThoughtById(id);
            if (existingThought && existingThought.id !== DataStore.editingThoughtId) {
                alert(`æ€è€ƒID "${id}" å·²å­˜åœ¨ï¼Œè¯·ä½¿ç”¨å…¶ä»–ID`);
                return false;
            }
            
            return true;
        }
        
        function saveSectionEdits() {
            const idInput = document.getElementById('edit-thought-id');
            const newId = idInput.value.trim();
            
            // éªŒè¯ID
            if (!validateThoughtId()) {
                return;
            }
            
            // ä¿å­˜åˆ†æ®µç¼–è¾‘
            const result = DataStore.saveSectionEdits(newId);
            
            if (result.success) {
                UIManager.showAlert(`æ€è€ƒè®°å½•å·²æ›´æ–°: ${result.thought.id}`, 'success');
                
                // å…³é—­æ¨¡æ€æ¡†
                UIManager.closeSectionEditModal();
                
                // æ˜¾ç¤ºæ›´æ–°åçš„å†…å®¹
                showThoughtDetail(result.thought.id);
                
                // æ›´æ–°ç´¢å¼•
                DataStore.updateUIStats();
            } else {
                alert(`ä¿å­˜å¤±è´¥: ${result.message || 'æœªçŸ¥é”™è¯¯'}`);
            }
        }
        
        function closeSectionEditModal() {
            UIManager.closeSectionEditModal();
        }
        
        // ==================== æ–°å¢ï¼šä»æ¥æºæ€è€ƒæå–æ¨¡å‹æè¿° ====================
        function extractModelDescriptionFromSource(modelId) {
            const model = DataStore.getModelById(modelId);
            if (!model || !model.fromThought) {
                alert('æ­¤æ¨¡å‹æ²¡æœ‰æŒ‡å®šæ¥æºæ€è€ƒï¼Œæ— æ³•è‡ªåŠ¨æå–æè¿°');
                return;
            }
            
            const thought = DataStore.getThoughtById(model.fromThought);
            if (!thought || !thought.sections || !thought.sections["æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"]) {
                alert('åœ¨æ¥æºæ€è€ƒä¸­æœªæ‰¾åˆ°æ­¤æ¨¡å‹çš„æè¿°å†…å®¹');
                return;
            }
            
            const modelSection = thought.sections["æ¨¡å‹å»¶ä¼¸ä¸æ•´åˆ"];
            const lines = modelSection.split('\n');
            
            // æŸ¥æ‰¾åŒ…å«æ¨¡å‹IDçš„è¡Œ
            let descriptionLines = [];
            let foundModel = false;
            
            for (let i = 0; i < lines.length; i++) {
                if (lines[i].includes(modelId)) {
                    foundModel = true;
                    // è·³è¿‡æ ‡é¢˜è¡Œ
                    continue;
                }
                
                if (foundModel) {
                    // æ£€æŸ¥æ˜¯å¦æ˜¯å¦ä¸€ä¸ªæ¨¡å‹çš„å¼€å§‹
                    if (lines[i].match(/M-\d+/)) {
                        break;
                    }
                    
                    // æ£€æŸ¥æ˜¯å¦æ˜¯ä¸‹ä¸€ä¸ªæ ‡é¢˜çš„å¼€å§‹
                    if (lines[i].match(/^\d+\./)) {
                        break;
                    }
                    
                    descriptionLines.push(lines[i]);
                }
            }
            
            if (descriptionLines.length === 0) {
                alert('åœ¨æ¥æºæ€è€ƒä¸­æœªæ‰¾åˆ°æ­¤æ¨¡å‹çš„è¯¦ç»†æè¿°');
                return;
            }
            
            // æ¸…ç†æè¿°
            let description = descriptionLines.join('\n').trim();
            
            // è¯¢é—®ç”¨æˆ·æ˜¯å¦æ›¿æ¢ç°æœ‰æè¿°
            if (confirm('æ˜¯å¦ç”¨ä»æ¥æºæ€è€ƒä¸­æå–çš„æè¿°æ›¿æ¢å½“å‰æè¿°ï¼Ÿ')) {
                const textarea = document.getElementById('edit-model-description');
                if (textarea) {
                    textarea.value = description;
                    UIManager.showAlert('æ¨¡å‹æè¿°å·²ä»æ¥æºæ€è€ƒä¸­æå–', 'success');
                }
            }
        }
        
        // ==================== æ–°å¢ï¼šæ—¶é—´çº¿ç¼–è¾‘ç›¸å…³å‡½æ•° ====================
        function closeTimelineEditModal() {
            UIManager.closeTimelineEditModal();
        }
        
        function saveTimelineEdit() {
            UIManager.saveTimelineEdit();
        }
        
        // ==================== åˆå§‹åŒ– ====================
        document.addEventListener('DOMContentLoaded', function() {
            UIManager.init();
        });
        
        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        document.addEventListener('click', function(event) {
            const deleteModal = document.getElementById('delete-modal');
            const tagReviewModal = document.getElementById('tag-review-modal');
            const sectionEditModal = document.getElementById('section-edit-modal');
            const timelineEditModal = document.getElementById('timeline-edit-modal');
            
            if (event.target === deleteModal) {
                UIManager.closeDeleteModal();
            }
            
            if (event.target === tagReviewModal) {
                UIManager.closeTagReviewModal();
            }
            
            if (event.target === sectionEditModal) {
                UIManager.closeSectionEditModal();
            }
            
            if (event.target === timelineEditModal) {
                UIManager.closeTimelineEditModal();
            }
        });
        // ç§»åŠ¨ç«¯åŒæ­¥æ ‡è®°
        setTimeout(() => {
            // ç›‘å¬æ‰€æœ‰ä¿å­˜æ“ä½œ
            const originalSave = DataStore.save;
            DataStore.save = function() {
                const result = originalSave.call(this);
                if (result) {
                    // è®¾ç½®åŒæ­¥æ ‡è®°
                    localStorage.setItem('last_data_update', Date.now().toString());
                    console.log('âœ… æ•°æ®å·²ä¿å­˜ï¼Œç§»åŠ¨ç«¯åŒæ­¥æ ‡è®°å·²è®¾ç½®');
                }
                return result;
            };
            
            // åˆå§‹è®¾ç½®ä¸€æ¬¡æ ‡è®°
            localStorage.setItem('last_data_update', Date.now().toString());
        }, 1000);
    </script>
</body>
</html>
